/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"===typeof exports&&"object"===typeof module)module.exports=t(require("@sendo/app"),require("@sendo/hybrid"),require("@sendo/storage"),require("@sendo/tracing"),require("@sendo/ui"),require("@sendo/utils"),require("immutable"),require("react"));else if("function"===typeof define&&define.amd)define(["@sendo/app","@sendo/hybrid","@sendo/storage","@sendo/tracing","@sendo/ui","@sendo/utils","immutable","react"],t);else{var r="object"===typeof exports?t(require("@sendo/app"),require("@sendo/hybrid"),require("@sendo/storage"),require("@sendo/tracing"),require("@sendo/ui"),require("@sendo/utils"),require("immutable"),require("react")):t(e["@sendo/app"],e["@sendo/hybrid"],e["@sendo/storage"],e["@sendo/tracing"],e["@sendo/ui"],e["@sendo/utils"],e.immutable,e.react);for(var n in r)("object"===typeof exports?exports:e)[n]=r[n]}}(globalThis,((e,t,r,n,s,o,i,a)=>(()=>{var c={3177:function(e,t,r){e.exports=function(){var e=e||function(e,t){var n;if("undefined"!==typeof window&&window.crypto&&(n=window.crypto),"undefined"!==typeof self&&self.crypto&&(n=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!==typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!==typeof r.g&&r.g.crypto&&(n=r.g.crypto),!n)try{n=r(633)}catch(e){}var s=function(){if(n){if("function"===typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"===typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),i={},a=i.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,s=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<s;o++){var i=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=i<<24-(n+o)%4*8}else for(var a=0;a<s;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=s,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(s());return new l.init(t,e)}}),u=i.enc={},d=u.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],s=0;s<r;s++){var o=t[s>>>2]>>>24-s%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},h=u.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],s=0;s<r;s++){var o=t[s>>>2]>>>24-s%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},g=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,s=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,u=e.min(4*c,o);if(c){for(var d=0;d<c;d+=i)this._doProcessBlock(s,d);r=s.splice(0,c),n.sigBytes-=u}return new l.init(r,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(a.Hasher=g.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new f.HMAC.init(e,r).finalize(t)}}}),i.algo={});return i}(Math);return e}()},8817:function(e,t,r){!function(t,n){var s;e.exports=(s=r(3177),function(){var e=s,t=e.lib.WordArray;function r(e,r,n){for(var s=[],o=0,i=0;i<r;i++)if(i%4){var a=n[e.charCodeAt(i-1)]<<i%4*2|n[e.charCodeAt(i)]>>>6-i%4*2;s[o>>>2]|=a<<24-o%4*8,o++}return t.create(s,o)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var s=[],o=0;o<r;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)s.push(n.charAt(i>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(e){var t=e.length,n=this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var o=0;o<n.length;o++)s[n.charCodeAt(o)]=o}var i=n.charAt(64);if(i){var a=e.indexOf(i);-1!==a&&(t=a)}return r(e,t,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),s.enc.Base64)}()},4506:function(e,t,r){!function(t,n){var s;e.exports=(s=r(3177),s.enc.Utf8)}()},8354:function(e,t,r){!function(t,n){var s;e.exports=(s=r(3177),function(e){var t=s,r=t.lib,n=r.WordArray,o=r.Hasher,i=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,s=0;s<64;)t(n)&&(s<8&&(a[s]=r(e.pow(n,.5))),c[s]=r(e.pow(n,1/3)),s++),n++}();var l=[],u=i.SHA256=o.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],s=r[1],o=r[2],i=r[3],a=r[4],u=r[5],d=r[6],h=r[7],p=0;p<64;p++){if(p<16)l[p]=0|e[t+p];else{var g=l[p-15],f=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,v=l[p-2],m=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;l[p]=f+l[p-7]+m+l[p-16]}var y=n&s^n&o^s&o,_=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),w=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&d)+c[p]+l[p];h=d,d=u,u=a,a=i+w|0,i=o,o=s,s=n,n=w+(_+y)|0}r[0]=r[0]+n|0,r[1]=r[1]+s|0,r[2]=r[2]+o|0,r[3]=r[3]+i|0,r[4]=r[4]+a|0,r[5]=r[5]+u|0,r[6]=r[6]+d|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,s=8*t.sigBytes;return r[s>>>5]|=128<<24-s%32,r[14+(s+64>>>9<<4)]=e.floor(n/4294967296),r[15+(s+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(u),t.HmacSHA256=o._createHmacHelper(u)}(Math),s.SHA256)}()},8285:(e,t,r)=>{var n=r(3631)(r(8298),"DataView");e.exports=n},6174:(e,t,r)=>{var n=r(519),s=r(2238),o=r(367),i=r(1698),a=r(2698);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=o,c.prototype.has=i,c.prototype.set=a,e.exports=c},6283:(e,t,r)=>{var n=r(9682),s=r(2047),o=r(5606),i=r(7701),a=r(8953);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=o,c.prototype.has=i,c.prototype.set=a,e.exports=c},6402:(e,t,r)=>{var n=r(3631)(r(8298),"Map");e.exports=n},6506:(e,t,r)=>{var n=r(8604),s=r(7239),o=r(2668),i=r(7846),a=r(2008);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=o,c.prototype.has=i,c.prototype.set=a,e.exports=c},4122:(e,t,r)=>{var n=r(3631)(r(8298),"Promise");e.exports=n},3402:(e,t,r)=>{var n=r(3631)(r(8298),"Set");e.exports=n},5516:(e,t,r)=>{var n=r(6506),s=r(2709),o=r(5729);function i(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}i.prototype.add=i.prototype.push=s,i.prototype.has=o,e.exports=i},4512:(e,t,r)=>{var n=r(6283),s=r(6433),o=r(2359),i=r(4774),a=r(4589),c=r(4972);function l(e){var t=this.__data__=new n(e);this.size=t.size}l.prototype.clear=s,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=c,e.exports=l},2482:(e,t,r)=>{var n=r(8298).Symbol;e.exports=n},5277:(e,t,r)=>{var n=r(8298).Uint8Array;e.exports=n},3335:(e,t,r)=>{var n=r(3631)(r(8298),"WeakMap");e.exports=n},8959:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},5873:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},6893:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,s=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[s++]=i)}return o}},4863:(e,t,r)=>{var n=r(5405),s=r(2570),o=r(5877),i=r(1308),a=r(6645),c=r(2197),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),u=!r&&s(e),d=!r&&!u&&i(e),h=!r&&!u&&!d&&c(e),p=r||u||d||h,g=p?n(e.length,String):[],f=g.length;for(var v in e)!t&&!l.call(e,v)||p&&("length"==v||d&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,f))||g.push(v);return g}},1765:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}},6773:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}},70:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},3539:(e,t,r)=>{var n=r(4284),s=r(1046),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var i=e[t];o.call(e,t)&&s(i,r)&&(void 0!==r||t in e)||n(e,t,r)}},8083:(e,t,r)=>{var n=r(1046);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},1549:(e,t,r)=>{var n=r(6017),s=r(5482);e.exports=function(e,t){return e&&n(t,s(t),e)}},6686:(e,t,r)=>{var n=r(6017),s=r(9380);e.exports=function(e,t){return e&&n(t,s(t),e)}},4284:(e,t,r)=>{var n=r(4393);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},1393:(e,t,r)=>{var n=r(4512),s=r(5873),o=r(3539),i=r(1549),a=r(6686),c=r(1899),l=r(7564),u=r(5932),d=r(2957),h=r(8118),p=r(5358),g=r(116),f=r(6116),v=r(4353),m=r(4125),y=r(5877),_=r(1308),w=r(7639),b=r(2015),S=r(6515),x=r(5482),T=r(9380),k="[object Arguments]",E="[object Function]",O="[object Object]",C={};C[k]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[O]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[E]=C["[object WeakMap]"]=!1,e.exports=function e(t,r,P,j,A,I){var N,R=1&r,M=2&r,B=4&r;if(P&&(N=A?P(t,j,A,I):P(t)),void 0!==N)return N;if(!b(t))return t;var L=y(t);if(L){if(N=f(t),!R)return l(t,N)}else{var U=g(t),q=U==E||"[object GeneratorFunction]"==U;if(_(t))return c(t,R);if(U==O||U==k||q&&!A){if(N=M||q?{}:m(t),!R)return M?d(t,a(N,t)):u(t,i(N,t))}else{if(!C[U])return A?t:{};N=v(t,U,R)}}I||(I=new n);var D=I.get(t);if(D)return D;I.set(t,N),S(t)?t.forEach((function(n){N.add(e(n,r,P,n,t,I))})):w(t)&&t.forEach((function(n,s){N.set(s,e(n,r,P,s,t,I))}));var V=L?void 0:(B?M?p:h:M?T:x)(t);return s(V||t,(function(n,s){V&&(n=t[s=n]),o(N,s,e(n,r,P,s,t,I))})),N}},2903:(e,t,r)=>{var n=r(2015),s=Object.create,o=function(){function e(){}return function(t){if(!n(t))return{};if(s)return s(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},9527:(e,t,r)=>{var n=r(6773),s=r(6093);e.exports=function e(t,r,o,i,a){var c=-1,l=t.length;for(o||(o=s),a||(a=[]);++c<l;){var u=t[c];r>0&&o(u)?r>1?e(u,r-1,o,i,a):n(a,u):i||(a[a.length]=u)}return a}},8753:(e,t,r)=>{var n=r(3948),s=r(8722);e.exports=function(e,t){for(var r=0,o=(t=n(t,e)).length;null!=e&&r<o;)e=e[s(t[r++])];return r&&r==o?e:void 0}},1460:(e,t,r)=>{var n=r(6773),s=r(5877);e.exports=function(e,t,r){var o=t(e);return s(e)?o:n(o,r(e))}},8329:(e,t,r)=>{var n=r(2482),s=r(9961),o=r(3149),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?s(e):o(e)}},5344:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7230:(e,t,r)=>{var n=r(8329),s=r(5009);e.exports=function(e){return s(e)&&"[object Arguments]"==n(e)}},6408:(e,t,r)=>{var n=r(8865),s=r(5009);e.exports=function e(t,r,o,i,a){return t===r||(null==t||null==r||!s(t)&&!s(r)?t!==t&&r!==r:n(t,r,o,i,e,a))}},8865:(e,t,r)=>{var n=r(4512),s=r(6828),o=r(1982),i=r(9731),a=r(116),c=r(5877),l=r(1308),u=r(2197),d="[object Arguments]",h="[object Array]",p="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,f,v,m){var y=c(e),_=c(t),w=y?h:a(e),b=_?h:a(t),S=(w=w==d?p:w)==p,x=(b=b==d?p:b)==p,T=w==b;if(T&&l(e)){if(!l(t))return!1;y=!0,S=!1}if(T&&!S)return m||(m=new n),y||u(e)?s(e,t,r,f,v,m):o(e,t,w,r,f,v,m);if(!(1&r)){var k=S&&g.call(e,"__wrapped__"),E=x&&g.call(t,"__wrapped__");if(k||E){var O=k?e.value():e,C=E?t.value():t;return m||(m=new n),v(O,C,r,f,m)}}return!!T&&(m||(m=new n),i(e,t,r,f,v,m))}},1237:(e,t,r)=>{var n=r(116),s=r(5009);e.exports=function(e){return s(e)&&"[object Map]"==n(e)}},8094:(e,t,r)=>{var n=r(4512),s=r(6408);e.exports=function(e,t,r,o){var i=r.length,a=i,c=!o;if(null==e)return!a;for(e=Object(e);i--;){var l=r[i];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<a;){var u=(l=r[i])[0],d=e[u],h=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var p=new n;if(o)var g=o(d,h,u,e,t,p);if(!(void 0===g?s(h,d,3,o,p):g))return!1}}return!0}},865:(e,t,r)=>{var n=r(8842),s=r(2850),o=r(2015),i=r(6257),a=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||s(e))&&(n(e)?h:a).test(i(e))}},8301:(e,t,r)=>{var n=r(116),s=r(5009);e.exports=function(e){return s(e)&&"[object Set]"==n(e)}},5860:(e,t,r)=>{var n=r(8329),s=r(9294),o=r(5009),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&s(e.length)&&!!i[n(e)]}},4679:(e,t,r)=>{var n=r(1122),s=r(8674),o=r(9869),i=r(5877),a=r(3784);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?i(e)?s(e[0],e[1]):n(e):a(e)}},9213:(e,t,r)=>{var n=r(4123),s=r(5154),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return s(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},9015:(e,t,r)=>{var n=r(2015),s=r(4123),o=r(4052),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=s(e),r=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&r.push(a);return r}},1122:(e,t,r)=>{var n=r(8094),s=r(6472),o=r(6933);e.exports=function(e){var t=s(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},8674:(e,t,r)=>{var n=r(6408),s=r(3650),o=r(7086),i=r(4040),a=r(2325),c=r(6933),l=r(8722);e.exports=function(e,t){return i(e)&&a(t)?c(l(e),t):function(r){var i=s(r,e);return void 0===i&&i===t?o(r,e):n(t,i,3)}}},5680:(e,t,r)=>{var n=r(8753),s=r(9570),o=r(3948);e.exports=function(e,t,r){for(var i=-1,a=t.length,c={};++i<a;){var l=t[i],u=n(e,l);r(u,l)&&s(c,o(l,e),u)}return c}},1158:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},2807:(e,t,r)=>{var n=r(8753);e.exports=function(e){return function(t){return n(t,e)}}},9570:(e,t,r)=>{var n=r(3539),s=r(3948),o=r(6645),i=r(2015),a=r(8722);e.exports=function(e,t,r,c){if(!i(e))return e;for(var l=-1,u=(t=s(t,e)).length,d=u-1,h=e;null!=h&&++l<u;){var p=a(t[l]),g=r;if("__proto__"===p||"constructor"===p||"prototype"===p)return e;if(l!=d){var f=h[p];void 0===(g=c?c(f,p,h):void 0)&&(g=i(f)?f:o(t[l+1])?[]:{})}n(h,p,g),h=h[p]}return e}},3670:(e,t,r)=>{var n=r(4788),s=r(4393),o=r(9869),i=s?function(e,t){return s(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=i},7512:e=>{e.exports=function(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(r=r>s?s:r)<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(s);++n<s;)o[n]=e[n+t];return o}},5405:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},7761:(e,t,r)=>{var n=r(2482),s=r(1765),o=r(5877),i=r(3895),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return s(t,e)+"";if(i(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r}},925:(e,t,r)=>{var n=r(8108),s=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(s,""):e}},7520:e=>{e.exports=function(e){return function(t){return e(t)}}},5352:(e,t,r)=>{var n=r(3948),s=r(6393),o=r(6889),i=r(8722);e.exports=function(e,t){return t=n(t,e),null==(e=o(e,t))||delete e[i(s(t))]}},3630:e=>{e.exports=function(e,t){return e.has(t)}},3948:(e,t,r)=>{var n=r(5877),s=r(4040),o=r(2712),i=r(4633);e.exports=function(e,t){return n(e)?e:s(e,t)?[e]:o(i(e))}},7626:(e,t,r)=>{var n=r(5277);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},1899:(e,t,r)=>{e=r.nmd(e);var n=r(8298),s=t&&!t.nodeType&&t,o=s&&e&&!e.nodeType&&e,i=o&&o.exports===s?n.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}},9615:(e,t,r)=>{var n=r(7626);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},302:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},3947:(e,t,r)=>{var n=r(2482),s=n?n.prototype:void 0,o=s?s.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},7337:(e,t,r)=>{var n=r(7626);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},7564:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},6017:(e,t,r)=>{var n=r(3539),s=r(4284);e.exports=function(e,t,r,o){var i=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var l=t[a],u=o?o(r[l],e[l],l,r,e):void 0;void 0===u&&(u=e[l]),i?s(r,l,u):n(r,l,u)}return r}},5932:(e,t,r)=>{var n=r(6017),s=r(9939);e.exports=function(e,t){return n(e,s(e),t)}},2957:(e,t,r)=>{var n=r(6017),s=r(2434);e.exports=function(e,t){return n(e,s(e),t)}},9696:(e,t,r)=>{var n=r(8298)["__core-js_shared__"];e.exports=n},6131:(e,t,r)=>{var n=r(6807);e.exports=function(e){return n(e)?void 0:e}},4393:(e,t,r)=>{var n=r(3631),s=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=s},6828:(e,t,r)=>{var n=r(5516),s=r(70),o=r(3630);e.exports=function(e,t,r,i,a,c){var l=1&r,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var h=c.get(e),p=c.get(t);if(h&&p)return h==t&&p==e;var g=-1,f=!0,v=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++g<u;){var m=e[g],y=t[g];if(i)var _=l?i(y,m,g,t,e,c):i(m,y,g,e,t,c);if(void 0!==_){if(_)continue;f=!1;break}if(v){if(!s(t,(function(e,t){if(!o(v,t)&&(m===e||a(m,e,r,i,c)))return v.push(t)}))){f=!1;break}}else if(m!==y&&!a(m,y,r,i,c)){f=!1;break}}return c.delete(e),c.delete(t),f}},1982:(e,t,r)=>{var n=r(2482),s=r(5277),o=r(1046),i=r(6828),a=r(4515),c=r(4969),l=n?n.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,r,n,l,d,h){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new s(e),new s(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=a;case"[object Set]":var g=1&n;if(p||(p=c),e.size!=t.size&&!g)return!1;var f=h.get(e);if(f)return f==t;n|=2,h.set(e,t);var v=i(p(e),p(t),n,l,d,h);return h.delete(e),v;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},9731:(e,t,r)=>{var n=r(8118),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,o,i,a){var c=1&r,l=n(e),u=l.length;if(u!=n(t).length&&!c)return!1;for(var d=u;d--;){var h=l[d];if(!(c?h in t:s.call(t,h)))return!1}var p=a.get(e),g=a.get(t);if(p&&g)return p==t&&g==e;var f=!0;a.set(e,t),a.set(t,e);for(var v=c;++d<u;){var m=e[h=l[d]],y=t[h];if(o)var _=c?o(y,m,h,t,e,a):o(m,y,h,e,t,a);if(!(void 0===_?m===y||i(m,y,r,o,a):_)){f=!1;break}v||(v="constructor"==h)}if(f&&!v){var w=e.constructor,b=t.constructor;w==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(f=!1)}return a.delete(e),a.delete(t),f}},2494:(e,t,r)=>{var n=r(1806),s=r(1280),o=r(2919);e.exports=function(e){return o(s(e,void 0,n),e+"")}},3476:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},8118:(e,t,r)=>{var n=r(1460),s=r(9939),o=r(5482);e.exports=function(e){return n(e,o,s)}},5358:(e,t,r)=>{var n=r(1460),s=r(2434),o=r(9380);e.exports=function(e){return n(e,o,s)}},2541:(e,t,r)=>{var n=r(4248);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},6472:(e,t,r)=>{var n=r(2325),s=r(5482);e.exports=function(e){for(var t=s(e),r=t.length;r--;){var o=t[r],i=e[o];t[r]=[o,i,n(i)]}return t}},3631:(e,t,r)=>{var n=r(865),s=r(9958);e.exports=function(e,t){var r=s(e,t);return n(r)?r:void 0}},34:(e,t,r)=>{var n=r(4801)(Object.getPrototypeOf,Object);e.exports=n},9961:(e,t,r)=>{var n=r(2482),s=Object.prototype,o=s.hasOwnProperty,i=s.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var s=i.call(e);return n&&(t?e[a]=r:delete e[a]),s}},9939:(e,t,r)=>{var n=r(6893),s=r(4157),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(e){return null==e?[]:(e=Object(e),n(i(e),(function(t){return o.call(e,t)})))}:s;e.exports=a},2434:(e,t,r)=>{var n=r(6773),s=r(34),o=r(9939),i=r(4157),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,o(e)),e=s(e);return t}:i;e.exports=a},116:(e,t,r)=>{var n=r(8285),s=r(6402),o=r(4122),i=r(3402),a=r(3335),c=r(8329),l=r(6257),u="[object Map]",d="[object Promise]",h="[object Set]",p="[object WeakMap]",g="[object DataView]",f=l(n),v=l(s),m=l(o),y=l(i),_=l(a),w=c;(n&&w(new n(new ArrayBuffer(1)))!=g||s&&w(new s)!=u||o&&w(o.resolve())!=d||i&&w(new i)!=h||a&&w(new a)!=p)&&(w=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?l(r):"";if(n)switch(n){case f:return g;case v:return u;case m:return d;case y:return h;case _:return p}return t}),e.exports=w},9958:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},5244:(e,t,r)=>{var n=r(3948),s=r(2570),o=r(5877),i=r(6645),a=r(9294),c=r(8722);e.exports=function(e,t,r){for(var l=-1,u=(t=n(t,e)).length,d=!1;++l<u;){var h=c(t[l]);if(!(d=null!=e&&r(e,h)))break;e=e[h]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&a(u)&&i(h,u)&&(o(e)||s(e))}},519:(e,t,r)=>{var n=r(3141);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},2238:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},367:(e,t,r)=>{var n=r(3141),s=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return s.call(t,e)?t[e]:void 0}},1698:(e,t,r)=>{var n=r(3141),s=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:s.call(t,e)}},2698:(e,t,r)=>{var n=r(3141);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},6116:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},4353:(e,t,r)=>{var n=r(7626),s=r(9615),o=r(302),i=r(3947),a=r(7337);e.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return s(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return o(e);case"[object Symbol]":return i(e)}}},4125:(e,t,r)=>{var n=r(2903),s=r(34),o=r(4123);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:n(s(e))}},6093:(e,t,r)=>{var n=r(2482),s=r(2570),o=r(5877),i=n?n.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||s(e)||!!(i&&e&&e[i])}},6645:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},4040:(e,t,r)=>{var n=r(5877),s=r(3895),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!s(e))||(i.test(e)||!o.test(e)||null!=t&&e in Object(t))}},4248:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},2850:(e,t,r)=>{var n=r(9696),s=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!s&&s in e}},4123:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},2325:(e,t,r)=>{var n=r(2015);e.exports=function(e){return e===e&&!n(e)}},9682:e=>{e.exports=function(){this.__data__=[],this.size=0}},2047:(e,t,r)=>{var n=r(8083),s=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():s.call(t,r,1),--this.size,!0)}},5606:(e,t,r)=>{var n=r(8083);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},7701:(e,t,r)=>{var n=r(8083);e.exports=function(e){return n(this.__data__,e)>-1}},8953:(e,t,r)=>{var n=r(8083);e.exports=function(e,t){var r=this.__data__,s=n(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}},8604:(e,t,r)=>{var n=r(6174),s=r(6283),o=r(6402);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||s),string:new n}}},7239:(e,t,r)=>{var n=r(2541);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},2668:(e,t,r)=>{var n=r(2541);e.exports=function(e){return n(this,e).get(e)}},7846:(e,t,r)=>{var n=r(2541);e.exports=function(e){return n(this,e).has(e)}},2008:(e,t,r)=>{var n=r(2541);e.exports=function(e,t){var r=n(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}},4515:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},6933:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},4672:(e,t,r)=>{var n=r(6858);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},3141:(e,t,r)=>{var n=r(3631)(Object,"create");e.exports=n},5154:(e,t,r)=>{var n=r(4801)(Object.keys,Object);e.exports=n},4052:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},3377:(e,t,r)=>{e=r.nmd(e);var n=r(3476),s=t&&!t.nodeType&&t,o=s&&e&&!e.nodeType&&e,i=o&&o.exports===s&&n.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a},3149:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4801:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},1280:(e,t,r)=>{var n=r(8959),s=Math.max;e.exports=function(e,t,r){return t=s(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,a=s(o.length-t,0),c=Array(a);++i<a;)c[i]=o[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=o[i];return l[t]=r(c),n(e,this,l)}}},6889:(e,t,r)=>{var n=r(8753),s=r(7512);e.exports=function(e,t){return t.length<2?e:n(e,s(t,0,-1))}},8298:(e,t,r)=>{var n=r(3476),s="object"==typeof self&&self&&self.Object===Object&&self,o=n||s||Function("return this")();e.exports=o},2709:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},5729:e=>{e.exports=function(e){return this.__data__.has(e)}},4969:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},2919:(e,t,r)=>{var n=r(3670),s=r(4046)(n);e.exports=s},4046:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var s=t(),o=16-(s-n);if(n=s,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},6433:(e,t,r)=>{var n=r(6283);e.exports=function(){this.__data__=new n,this.size=0}},2359:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},4774:e=>{e.exports=function(e){return this.__data__.get(e)}},4589:e=>{e.exports=function(e){return this.__data__.has(e)}},4972:(e,t,r)=>{var n=r(6283),s=r(6402),o=r(6506);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var i=r.__data__;if(!s||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new o(i)}return r.set(e,t),this.size=r.size,this}},2712:(e,t,r)=>{var n=r(4672),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,i=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(s,(function(e,r,n,s){t.push(n?s.replace(o,"$1"):r||e)})),t}));e.exports=i},8722:(e,t,r)=>{var n=r(3895);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},6257:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},8108:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},4788:e=>{e.exports=function(e){return function(){return e}}},6505:(e,t,r)=>{var n=r(7512),s=r(9041);e.exports=function(e,t,r){var o=null==e?0:e.length;return o?(t=r||void 0===t?1:s(t),n(e,0,(t=o-t)<0?0:t)):[]}},1046:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},1806:(e,t,r)=>{var n=r(9527);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},3650:(e,t,r)=>{var n=r(8753);e.exports=function(e,t,r){var s=null==e?void 0:n(e,t);return void 0===s?r:s}},7086:(e,t,r)=>{var n=r(5344),s=r(5244);e.exports=function(e,t){return null!=e&&s(e,t,n)}},9869:e=>{e.exports=function(e){return e}},2570:(e,t,r)=>{var n=r(7230),s=r(5009),o=Object.prototype,i=o.hasOwnProperty,a=o.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return s(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},5877:e=>{var t=Array.isArray;e.exports=t},9477:(e,t,r)=>{var n=r(8842),s=r(9294);e.exports=function(e){return null!=e&&s(e.length)&&!n(e)}},1308:(e,t,r)=>{e=r.nmd(e);var n=r(8298),s=r(458),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||s;e.exports=c},9399:(e,t,r)=>{var n=r(9213),s=r(116),o=r(2570),i=r(5877),a=r(9477),c=r(1308),l=r(4123),u=r(2197),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||u(e)||o(e)))return!e.length;var t=s(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!n(e).length;for(var r in e)if(d.call(e,r))return!1;return!0}},8842:(e,t,r)=>{var n=r(8329),s=r(2015);e.exports=function(e){if(!s(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},9294:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},7639:(e,t,r)=>{var n=r(1237),s=r(7520),o=r(3377),i=o&&o.isMap,a=i?s(i):n;e.exports=a},2015:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},5009:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},6807:(e,t,r)=>{var n=r(8329),s=r(34),o=r(5009),i=Function.prototype,a=Object.prototype,c=i.toString,l=a.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=n(e))return!1;var t=s(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==u}},6515:(e,t,r)=>{var n=r(8301),s=r(7520),o=r(3377),i=o&&o.isSet,a=i?s(i):n;e.exports=a},3895:(e,t,r)=>{var n=r(8329),s=r(5009);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==n(e)}},2197:(e,t,r)=>{var n=r(5860),s=r(7520),o=r(3377),i=o&&o.isTypedArray,a=i?s(i):n;e.exports=a},5482:(e,t,r)=>{var n=r(4863),s=r(9213),o=r(9477);e.exports=function(e){return o(e)?n(e):s(e)}},9380:(e,t,r)=>{var n=r(4863),s=r(9015),o=r(9477);e.exports=function(e){return o(e)?n(e,!0):s(e)}},6393:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},6858:(e,t,r)=>{var n=r(6506);function s(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],o=r.cache;if(o.has(s))return o.get(s);var i=e.apply(this,n);return r.cache=o.set(s,i)||o,i};return r.cache=new(s.Cache||n),r}s.Cache=n,e.exports=s},360:(e,t,r)=>{var n=r(1765),s=r(1393),o=r(5352),i=r(3948),a=r(6017),c=r(6131),l=r(2494),u=r(5358),d=l((function(e,t){var r={};if(null==e)return r;var l=!1;t=n(t,(function(t){return t=i(t,e),l||(l=t.length>1),t})),a(e,u(e),r),l&&(r=s(r,7,c));for(var d=t.length;d--;)o(r,t[d]);return r}));e.exports=d},6427:(e,t,r)=>{var n=r(1765),s=r(4679),o=r(5680),i=r(5358);e.exports=function(e,t){if(null==e)return{};var r=n(i(e),(function(e){return[e]}));return t=s(t),o(e,r,(function(e,r){return t(e,r[0])}))}},3784:(e,t,r)=>{var n=r(1158),s=r(2807),o=r(4040),i=r(8722);e.exports=function(e){return o(e)?n(i(e)):s(e)}},4157:e=>{e.exports=function(){return[]}},458:e=>{e.exports=function(){return!1}},6888:(e,t,r)=>{var n=r(992),s=1/0;e.exports=function(e){return e?(e=n(e))===s||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},9041:(e,t,r)=>{var n=r(6888);e.exports=function(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}},992:(e,t,r)=>{var n=r(925),s=r(2015),o=r(3895),i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?l(e.slice(2),r?2:8):i.test(e)?NaN:+e}},4633:(e,t,r)=>{var n=r(7761);e.exports=function(e){return null==e?"":n(e)}},1859:(e,t,r)=>{"use strict";var n=r(8156),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,o={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:s,type:e,key:l,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},8024:(e,t,r)=>{"use strict";e.exports=r(1859)},5963:(e,t)=>{"use strict";t.Q=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var n={},s=t||{},i=e.split(";"),a=s.decode||r,c=0;c<i.length;c++){var l=i[c],u=l.indexOf("=");if(!(u<0)){var d=l.substring(0,u).trim();if(void 0==n[d]){var h=l.substring(u+1,l.length).trim();'"'===h[0]&&(h=h.slice(1,-1)),n[d]=o(h,a)}}}return n},t.q=function(e,t,r){var o=r||{},i=o.encode||n;if("function"!==typeof i)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");var a=i(t);if(a&&!s.test(a))throw new TypeError("argument val is invalid");var c=e+"="+a;if(null!=o.maxAge){var l=o.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(l)}if(o.domain){if(!s.test(o.domain))throw new TypeError("option domain is invalid");c+="; Domain="+o.domain}if(o.path){if(!s.test(o.path))throw new TypeError("option path is invalid");c+="; Path="+o.path}if(o.expires){if("function"!==typeof o.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+o.expires.toUTCString()}o.httpOnly&&(c+="; HttpOnly");o.secure&&(c+="; Secure");if(o.sameSite){switch("string"===typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;case"none":c+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return c};var r=decodeURIComponent,n=encodeURIComponent,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function o(e,t){try{return t(e)}catch(t){return e}}},229:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(8024),s=(r(8156),r(1285)),o=r(9330),i=r(9070);const a="_9fe3-BBy9fH",c="_9fe3-ofSxe0",l="_9fe3-oPeMzZ",u=e=>{let{isNewSocialUser:t,onLoginByOTP:r,onVerifyLater:u,phoneNumber:d}=e;return(0,n.jsxs)(s.Grid,{item:!0,xs:!0,container:!0,direction:"column",nowrap:!0,children:[(0,n.jsx)(s.Grid,{item:!0,className:a,xs:"auto",children:(0,n.jsx)(s.Image,{src:o.ZB,alt:"phone registered warning hero image",className:c})}),(0,n.jsx)(s.Grid,{item:!0,xs:!0,container:!0,children:(0,n.jsx)(s.Box,{pt:3,children:(0,n.jsxs)(s.Grid,{container:!0,justifyContent:"space-between",direction:"column",className:l,children:[(0,n.jsxs)(s.Grid,{item:!0,children:[t&&(0,n.jsx)(s.Box,{px:4,children:(0,n.jsx)(s.Typography,{variant:s.TypoVariants.body2,children:i.UD.MESSAGE})}),!t&&(0,n.jsxs)(s.Box,{px:4,children:[(0,n.jsx)(s.Typography,{variant:s.TypoVariants.body2,children:i.UD.MESSAGE_1}),(0,n.jsx)(s.Typography,{variant:s.TypoVariants.body2,weight:s.TypoWeights.bold,children:d}),(0,n.jsx)(s.Typography,{variant:s.TypoVariants.body2,children:i.UD.MESSAGE_2})]})]}),(0,n.jsxs)(s.Grid,{item:!0,container:!0,spacing:2,children:[(0,n.jsx)(s.Grid,{item:!0,xs:!0,children:(0,n.jsx)(s.Button,{size:s.ButtonSizes.lg,variant:s.ButtonVariants.secondary,onClick:u,children:t?i.UD.USE_OTHER_PHONE_BUTTON_LABEL:i.UD.VERIFY_LATER_BUTTON_LABEL})}),(0,n.jsx)(s.Grid,{item:!0,xs:!0,children:(0,n.jsx)(s.Button,{size:s.ButtonSizes.lg,variant:s.ButtonVariants.primary,onClick:r,children:i.UD.LOGIN_BY_PHONE_BUTTON_LABEL})})]})]})})})]})}},8303:(e,t,r)=>{"use strict";r.d(t,{Z:()=>z});var n,s,o,i,a=r(8024),c=r(8156),l=r(7888),u=r.n(l),d=r(3719),h=r.n(d),p=r(1285),g=r(9330),f=r(9070),v=r(4728),m=r.n(v),y=r(4139),_=r.n(y),w=r(3939),b=r(6047),S=r(2131),x=r(3212),T=r(4089),k=r(5433),E=["title","titleId"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O.apply(this,arguments)}function C(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var P=function(e,t){var r=e.title,a=e.titleId,l=C(e,E);return c.createElement("svg",O({id:"Graphic",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 195.53 191.49",ref:t,"aria-labelledby":a},l),r?c.createElement("title",{id:a},r):null,n||(n=c.createElement("defs",null,c.createElement("linearGradient",{id:"linear-gradient",x1:97.77,y1:174.87,x2:97.77,y2:23.55,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:0,stopColor:"#f04e23"}),c.createElement("stop",{offset:1,stopColor:"#f7941e"})),c.createElement("linearGradient",{id:"linear-gradient-2",x1:68.17,y1:58.99,x2:68.17,y2:17.45,gradientTransform:"rotate(-180 68.17 38.22)",gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:0,stopColor:"#58595b"}),c.createElement("stop",{offset:1,stopColor:"#808285"})),c.createElement("style",null,".cls-2{fill:#fff}"))),s||(s=c.createElement("path",{className:"cls-2",d:"M0 0h195.53v191.49H0z"})),c.createElement("circle",{cx:97.77,cy:99.05,r:75,style:{fill:"url(#linear-gradient)"}}),o||(o=c.createElement("path",{className:"cls-2",d:"M133.76 60.86v41.27c-5.52-6.6-13.81-10.8-23.07-10.8-16.59 0-30.09 13.5-30.09 30.09s13.5 30.09 30.09 30.09 30.09-13.5 30.09-30.09V60.87h-7.01Zm-23.07 83.62c-12.72 0-23.07-10.35-23.07-23.07s10.35-23.07 23.07-23.07 23.07 10.35 23.07 23.07-10.35 23.07-23.07 23.07ZM61.16 99.93h7.01v48.05h-7.01zM71.01 93.66a2.896 2.896 0 0 1-1.69-2.79l.32-4.19 7.26 2.28c.67-.9 1.24-1.88 1.7-2.93l-11.93-3.74-.64 8.35c-.09 1.53.38 2.98 1.27 4.14 1.32-.21 2.57-.59 3.75-1.12 0 0-.02 0-.03-.01ZM63.47 82.39l-8.15 1.95c-1.5.38-2.76 1.3-3.59 2.53.6 1.18 1.36 2.27 2.24 3.24v-.1a2.92 2.92 0 0 1 2.14-2.47l4.08-.98.06 7.63c1.05.35 2.16.59 3.31.7l-.09-12.51ZM75.29 82.52c.76.31 1.55.46 2.33.46.68 0 1.36-.12 2.01-.34.14-.82.22-1.67.22-2.54 0-.47-.02-.93-.07-1.39-.02.02-.03.04-.04.05-.55.58-1.32.92-2.12.92-.37 0-.72-.07-1.07-.21l-3.86-1.64 4.51-6.2c-.65-.93-1.39-1.79-2.23-2.55l-7.39 10.16 7.71 3.27ZM71.86 66.92c-1.16-.61-2.42-1.07-3.74-1.35.03.05.06.1.08.13.57 1.04.46 2.34-.3 3.25l-2.75 3.18-4.55-6.24c-1.09.33-2.13.79-3.09 1.36l7.43 10.18 5.48-6.34c1-1.19 1.48-2.68 1.44-4.16ZM58.04 72.21a6.158 6.158 0 0 0-3.55-2.66c-.94.94-1.76 2-2.42 3.16.06-.02.13-.03.17-.04.19-.04.38-.06.56-.06.99 0 1.9.5 2.44 1.33l2.18 3.59-7.31 2.41v.15c0 1.1.12 2.18.35 3.21l11.94-3.94-4.35-7.16Z"})),c.createElement("path",{d:"M23.4 17.45h72.41c9.46 0 17.13 7.68 17.13 17.13v24.41H40.53c-9.46 0-17.13-7.68-17.13-17.13V17.45Z",transform:"rotate(180 68.17 38.22)",style:{fill:"url(#linear-gradient-2)"}}),i||(i=c.createElement("path",{className:"cls-2",d:"M39.04 53.12V24.66h17.93v3.13H42.25v9.51h12.81v3.13H42.25v12.68h-3.21ZM60.12 53.12V24.66h11.26c1.49 0 2.83.37 4.03 1.12 1.19.75 2.14 1.76 2.85 3.03.7 1.27 1.06 2.71 1.06 4.31 0 1.68-.35 3.19-1.06 4.51-.71 1.33-1.65 2.37-2.85 3.13-1.19.76-2.53 1.14-4.03 1.14h-8.05v11.22h-3.21Zm3.21-14.35h8.21c.84 0 1.59-.24 2.26-.73.66-.49 1.2-1.16 1.61-2.03.41-.87.61-1.84.61-2.93 0-1.49-.43-2.74-1.3-3.76-.87-1.02-1.92-1.52-3.17-1.52h-8.21v10.98ZM88.52 53.12V27.79h-8.17v-3.13h19.8v3.13h-8.42v25.33h-3.21Z"})))},j=(0,c.forwardRef)(P);r.p;const A="_9fe3-B1RuFU",I="_9fe3-PWzkqX",N=e=>{let{className:t,icon:r,isLoaded:n,onClick:s}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(p.Icon,{width:40,height:40,component:r,className:(0,p.classnames)(A,t,{[I]:!n}),onClick:s})})},R="_9fe3-IVD0bM",M=e=>{let{onChangeForm:t,onSetIsNewSocialUser:r,onSetSocialAuthCode:n,onSetSocialProvider:s}=e;const o=(0,w.useActions)(S.Z.actions),i=(0,w.useActions)(T.Z.actions),l=(0,w.useActions)(x.Z.actions),u=(0,w.useDispatch)(),d=(0,w.useSelector)("ScriptLoaded"),h=d.get("google"),v=d.get("facebook"),y=(0,c.useCallback)((async()=>{await o.request(),i.request()}),[o,i]),E=(0,c.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.cl;u("Toast","show",{messageType:p.MessageTypes.error,content:e})}),[u]),O=(0,c.useCallback)((async(e,o)=>{var i;n(e);const a=(await l.request({payload:{auth_code:e,source:g.Yp,provider:o}})).value;var c;const d=null!==(c=null===a||void 0===a?void 0:a.result.data)&&void 0!==c?c:{};var h,p;(null===a||void 0===a||null===(i=a.status)||void 0===i?void 0:i.code)!==g.qP?E(null!==(p=null===(h=a.status)||void 0===h?void 0:h.message)&&void 0!==p?p:f.cl):d.is_new_account?(r(!!d.is_new_account),s(o),d.phone_verified?(u("User","set",{value:{details:{data:d},logged:!0}}),t(b.N8.UpdateUserInfo,b.WT.SingUpWithSocial)):t(b.N8.RequestOTP,b.WT.SingUpWithSocial)):(await y(),d.phone_verified||t(b.N8.RequestOTP,b.WT.VerifyPhone))}),[n,l,E,r,s,t,u,y]),C=(0,c.useCallback)((async()=>{try{const e=await new Promise((e=>{window.FB.login((t=>{e(t)}),{scope:"public_profile,email"})}));(null===e||void 0===e?void 0:e.authResponse)?await O(e.authResponse.accessToken,b.md.Facebook):E()}catch(e){E()}}),[O,E]),P=(0,c.useCallback)((async()=>{try{await window.gAuthInstance.requestAccessToken(),window.gAuthInstance.callback=async e=>{e?await O(e.access_token,b.md.Google):E()}}catch(e){E()}}),[O,E]),A=(0,c.useCallback)((async()=>{try{const e=await k.Z.login();e.access_token?await O(e.access_token,b.md.FPTId):E()}catch(e){E()}}),[E,O]);return(0,a.jsxs)(p.Grid,{item:!0,container:!0,spacing:4,direction:"row",children:[(0,a.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,a.jsx)(N,{isLoaded:v,icon:m(),onClick:C})}),(0,a.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,a.jsx)(N,{isLoaded:h,icon:_(),className:R,onClick:P})}),(0,a.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,a.jsx)(N,{isLoaded:!0,icon:j,className:R,onClick:A})})]})},B="_9fe3-ETyvst",L="_9fe3-A3x8LE",U="_9fe3-cb2yJn",q="_9fe3-kyT7Oa",D="_9fe3-Yg_vMg",V="_9fe3-lb24D2",F="_9fe3-Ms4Hju",W="_9fe3-uxgolD",G="_9fe3-BI64wy",H="_9fe3-nbps6T",z=e=>{let{inputErrorMessage:t,isShowCaptcha:r,isSubmitting:n,onChangeForm:s,onChangeUsername:o,onClearUsername:i,onClose:l,onSetIsNewSocialUser:d,onSetSocialAuthCode:v,onSetSocialProvider:m,onSubmit:y,username:_}=e;return(0,a.jsxs)(p.Grid,{item:!0,container:!0,direction:"column",nowrap:!0,className:B,children:[(0,a.jsx)(p.Grid,{item:!0,xs:"auto",container:!0,justifyContent:"flex-end",className:H,children:(0,a.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,a.jsx)(p.Button,{fullWidth:!1,variant:p.ButtonVariants.ghost,size:p.ButtonSizes.sm,onClick:l,children:f.bh})})}),(0,a.jsx)(p.Grid,{item:!0,xs:!0,children:(0,a.jsx)(p.Box,{px:6,pt:6,pb:6,className:U,children:(0,a.jsxs)(p.Grid,{container:!0,justifyContent:"space-between",direction:"column",className:q,children:[(0,a.jsxs)(p.Grid,{item:!0,children:[(0,a.jsx)(p.Typography,{variant:p.TypoVariants.subtitle1,weight:p.TypoWeights.bold,type:p.TypoTypes.default,component:"h2",className:D,children:f.ev.TITLE}),(0,a.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,className:V,component:"h3",children:f.ev.SUB_TITLE}),(0,a.jsx)(p.Box,{mt:6,children:(0,a.jsx)("form",{onSubmit:y,noValidate:!0,children:(0,a.jsxs)(p.Grid,{container:!0,spacing:4,children:[(0,a.jsxs)(p.Grid,{item:!0,children:[(0,a.jsx)(p.TextField,{name:"username",label:"",status:t?p.InputStatuses.error:p.InputStatuses.primary,placeholder:f.ev.INPUT_PLACEHOLDER,readOnly:n,value:_,afterInput:!!_&&(0,a.jsx)(p.InputAdornment,{children:(0,a.jsx)(p.Icon,{component:h(),className:L,onClick:i})}),note:t,type:"email",autocomplete:"username",autoFocus:!0,onChange:o}),r&&(0,a.jsx)(p.Box,{mt:4,className:G,children:(0,a.jsx)("div",{id:g.u$.WELCOME})})]}),(0,a.jsx)(p.Grid,{item:!0,children:(0,a.jsxs)(p.Button,{size:p.ButtonSizes.lg,disabled:!_,loading:n,icon:c.Fragment,children:[f.ev.SUBMIT_BUTTON_LABEL,(0,a.jsx)(p.Icon,{component:u(),className:(0,p.classnames)(F,{[W]:n})})]})})]})})})]}),(0,a.jsx)(p.Grid,{item:!0,children:(0,a.jsxs)(p.Grid,{container:!0,spacing:4,children:[(0,a.jsx)(p.Grid,{item:!0,children:(0,a.jsx)(p.Typography,{variant:p.TypoVariants.caption,type:p.TypoTypes.sub,children:f.ev.OTHER_LOGIN_METHOD})}),(0,a.jsx)(M,{onChangeForm:s,onSetSocialAuthCode:v,onSetIsNewSocialUser:d,onSetSocialProvider:m})]})})]})})})]})}},9330:(e,t,r)=>{"use strict";r.d(t,{$n:()=>E,Ck:()=>C,D3:()=>O,D8:()=>g,Gi:()=>c,LW:()=>h,Lo:()=>v,QD:()=>_,YF:()=>b,Yp:()=>l,ZB:()=>o,cq:()=>p,ct:()=>f,e2:()=>m,ee:()=>y,g5:()=>u,m2:()=>k,oq:()=>w,qP:()=>a,rT:()=>d,sE:()=>T,u$:()=>i,uv:()=>x,ve:()=>S,wk:()=>P});var n=r(3435),s=r(6047);const o="https://media3.scdn.vn/img4/2021/08_03/VhpLX5c27wtUlebIIGss.png",i={WELCOME:"welcome-recaptcha",SIGN_IN:"sign-in-recaptcha",VERIFY_OTP:"verify-otp",FORGOT_PASSWORD:"forgot-password",REQUEST_OTP:"request-otp",VERIFY_OTP_TRUST_DEVICE:"verify-otp-trust-device"},a=0,c={WRONG_CAPTCHA:5},l=n.Environment.is.web?2:9,u={[s.X8.PWA]:s.Wm.PWA,[s.X8.PWAC2C]:s.Wm.PWAC2C,[s.X8.VNE]:s.Wm.PWA,[s.X8.MBB]:s.Wm.PWA,[s.X8.MBBC2C]:s.Wm.PWA,[s.X8.ZMA]:s.Wm.PWA},d={SHOW_CAPTCHA:7,NOT_TRUST_DEVICE:1001005},h=60,p=6,g=6,f=8,v=25,m=25,y={LOGIN:"LoginModal",EMBED_LOGIN:"EmbedLoginModal",UPDATE_PASSWORD:"UpdatePasswordModal",VERIFY_PHONE:"VerifyPhoneModal"},_={[s.X8.ZMA]:s.Wm.ZMA,[s.X8.MBB]:s.Wm.MBB,[s.X8.MBBC2C]:s.Wm.MBBC2C,[s.X8.VNE]:s.Wm.VNE,[s.X8.PWA]:null,[s.X8.PWAC2C]:null,[s.X8.VTM]:s.Wm.VTM},w={[s.X8.ZMA]:s.md.Zalo,[s.X8.MBB]:s.md.MBBank,[s.X8.MBBC2C]:s.md.MBBank,[s.X8.VNE]:s.md.VNE,[s.X8.PWA]:null,[s.X8.PWAC2C]:null,[s.X8.VTM]:s.md.VTM},b=[s.vm.InternalError,s.vm.AccountDeleted,s.vm.MBBankTokenInvalid,s.vm.MBBankPhoneEmpty],S=[s.vm.VNEEmailNotVerified,s.vm.VNEMustVerifyPhone,s.vm.PhoneAndEmailNotMatch],x="2000-01-01",T={SUCCEED:1,FAILED:0},k="https://profile.scdn.vn/images/ecom//logo/logo-sendo-new.svg",E={LOGIN_CALLBACK:"SendoLoginCallback"},O=1e3,C=/(^(.+?\.)?sendo\.vn(\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\(\)\*\+,;\=]*)?$)/,P="_autoemail@sendo.vn"},6047:(e,t,r)=>{"use strict";r.d(t,{A6:()=>h,N1:()=>o,N8:()=>s,Qw:()=>g,WT:()=>i,Wm:()=>a,X8:()=>n,Y0:()=>u,gJ:()=>p,md:()=>c,pH:()=>d,vm:()=>l});var n,s,o,i,a,c,l,u,d,h,p,g,f=r(3435);!function(e){e.PWA="pwa",e.PWAC2C="pwac2c",e.ZMA="zma",e.MBB="mbb",e.MBBC2C="mbbc2c",e.VNE="vne",e.VTM="vtm"}(n||(n={})),function(e){e.Welcome="welcome",e.SignIn="sign-in",e.UpdateUserInfo="update-user-info",e.VerifyOTP="verify-otp",e.RequestOTP="request-otp",e.PhoneRegisteredWaning="phone-registered-warning",e.ForgotPassword="forgot-password",e.LoginBySMS="login-by-sms",e.SignUp="sign-up",e.VerifyOTPTrustDevice="verify-otp-trust-device",e.RequestTrustDeviceOTP="request-trust-device-otp",e.UpdatePassword="update-password"}(s||(s={})),function(e){e.Phone="phone",e.Email="email"}(o||(o={})),function(e){e.SignInWithSMS="sign-in-with-sms",e.SignUpWithPhoneNumber="sign-up-with-phone-number",e.SingUpWithSocial="sing-up-with-social",e.ForgotPassword="forgot-password",e.VerifyPhone="verify-phone",e.VerifyTrustDevice="verify-trust-device",e.VerifyOTPUpdatePassword="verify-otp-update-password"}(i||(i={})),function(e){e[e.ZMA=12]="ZMA",e[e.MBB=13]="MBB",e[e.MBBC2C=13]="MBBC2C",e[e.VNE=14]="VNE",e[e.PWA=f.Environment.is.web?2:9]="PWA",e[e.PWAC2C=f.Environment.is.web?22:99]="PWAC2C",e[e.VTM=15]="VTM"}(a||(a={})),function(e){e.Zalo="zalo",e.MBBank="mbb",e.VNE="vne",e.Google="google",e.Facebook="facebook",e.FPTId="fpt",e.VTM="vtm"}(c||(c={})),function(e){e[e.InternalError=10]="InternalError",e[e.MBBankTokenInvalid=1000018]="MBBankTokenInvalid",e[e.MBBankPhoneEmpty=1000020]="MBBankPhoneEmpty",e[e.AccountDeleted=1001004]="AccountDeleted",e[e.VNEEmailNotVerified=1000021]="VNEEmailNotVerified",e[e.VNEMustVerifyPhone=1000022]="VNEMustVerifyPhone",e[e.PhoneAndEmailNotMatch=1000023]="PhoneAndEmailNotMatch"}(l||(l={})),function(e){e[e.Male=1]="Male",e[e.Female=2]="Female"}(u||(u={})),function(e){e.Page="page"}(d||(d={})),function(e){e.Notification="notification",e.Phone="phone",e.Email="email"}(h||(h={})),function(e){e.Page="page",e.Modal="modal"}(p||(p={})),function(e){e[e.UserRejected=-1401]="UserRejected"}(g||(g={}))},9070:(e,t,r)=>{"use strict";r.d(t,{A5:()=>o,J$:()=>_,LT:()=>i,Lv:()=>u,Md:()=>a,UD:()=>l,Yt:()=>y,aC:()=>m,bh:()=>h,cl:()=>d,ev:()=>s,fI:()=>g,h6:()=>f,lQ:()=>v,oO:()=>c,wK:()=>p});var n=r(6047);const s={TITLE:"Xin ch\xe0o,",SUB_TITLE:"\u0110\u0103ng nh\u1eadp ho\u1eb7c \u0111\u0103ng k\xfd t\xe0i kho\u1ea3n",SUBMIT_BUTTON_LABEL:"Ti\u1ebfp t\u1ee5c",INPUT_PLACEHOLDER:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",FACEBOOK_BUTTON_LABEL:"Facebook",GOOGLE_BUTTON_LABEL:"Google",OTHER_LOGIN_METHOD:"Ho\u1eb7c th\xf4ng qua:",USERNAME_INVALID_MESSAGE:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i ho\u1eb7c email kh\xf4ng h\u1ee3p l\u1ec7.",EMAIL_NOT_EXIST_MESSAGE:"Sendo kh\xf4ng h\u1ed7 tr\u1ee3 \u0111\u0103ng k\xfd m\u1edbi b\u1eb1ng email. D\xf9ng s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 ti\u1ebfp t\u1ee5c b\u1ea1n nh\xe9.",POLICY_TEXT_1:"Khi d\xf9ng t\xe0i kho\u1ea3n Sendo, b\u1ea1n \u0111\xe3 \u0111\u1ed3ng \xfd v\u1ec1 ",POLICY_TEXT_2:"\u0111i\u1ec1u kho\u1ea3n d\u1ecbch v\u1ee5."},o={TITLE:"\u0110\u0103ng nh\u1eadp",INPUT_PLACEHOLDER:"Nh\u1eadp m\u1eadt kh\u1ea9u",REQUEST_OTP_LABEL:"Nh\u1eadn m\xe3 x\xe1c th\u1ef1c (OTP)",FORGOT_PASSWORD_LABEL:"Qu\xean m\u1eadt kh\u1ea9u",CANCEL_BUTTON_LABEL:"Tho\xe1t",SUBMIT_BUTTON_LABEL:"\u0110\u0103ng nh\u1eadp",INFO_MESSAGE:"Nh\u1eadp m\u1eadt kh\u1ea9u \u0111\u1ec3 \u0111\u0103ng nh\u1eadp v\xe0 mua s\u1eafm c\xf9ng Sendo nh\xe9.",PASSWORD_INVALID_MESSAGE:"M\u1eadt kh\u1ea9u ph\u1ea3i nhi\u1ec1u h\u01a1n 6 k\xfd t\u1ef1."},i={TITLE:"B\u1ed5 sung th\xf4ng tin t\xe0i kho\u1ea3n",PHONE_INPUT_LABEL:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",PASSWORD_INPUT_LABEL:"M\u1eadt kh\u1ea9u",FULL_NAME_INPUT_LABEL:"H\u1ecd v\xe0 t\xean",FULL_NAME_INPUT_PLACEHOLDER:"Nh\u1eadp h\u1ecd v\xe0 t\xean c\u1ee7a b\u1ea1n",PASSWORD_INPUT_PLACEHOLDER:"T\u1ea1o m\u1eadt kh\u1ea9u (8 k\xfd t\u1ef1 tr\u1edf l\xean)",TERM_LABEL_1:"B\u1eb1ng vi\u1ec7c \u0111\u0103ng k\xfd t\xe0i kho\u1ea3n, b\u1ea1n \u0111\u1ed3ng \xfd v\u1edbi Sendo v\u1ec1 c\xe1c",TERM_LABEL_2:"\u0110i\u1ec1u kho\u1ea3n d\u1ecbch v\u1ee5",CANCEL_BUTTON_LABEL:"Tho\xe1t",SUBMIT_BUTTON_LABEL:"Ho\xe0n t\u1ea5t",CREATE_SENPAY_WALLET_LABEL:"T\u1ea1o V\xed SenPay \u0111\u1ec3 thanh to\xe1n thu\u1eadn ti\u1ec7n, nh\u1eadn nhi\u1ec1u \u01b0u \u0111\xe3i ho\xe0n ti\u1ec1n.",PASSWORD_INVALID_MESSAGE:"M\u1eadt kh\u1ea9u ph\u1ea3i t\u1eeb 8 k\xfd t\u1ef1 tr\u1edf l\xean.",PASSWORD_MAX_LENGTH_MESSAGE:"M\u1eadt kh\u1ea9u kh\xf4ng d\xe0i qu\xe1 25 k\xfd t\u1ef1.",FULL_NAME_INVALID_MESSAGE:"Vui l\xf2ng nh\u1eadp \u0111\u1ea9y \u0111\u1ee7 h\u1ecd t\xean.",FULL_NAME_MAX_LENGTH_MESSAGE:"H\u1ecd v\xe0 t\xean kh\xf4ng d\xe0i qu\xe1 25 k\xfd t\u1ef1.",GENDER_LABEL:"Danh x\u01b0ng",GENDER_REQUIRED_MESSAGE:"Vui l\xf2ng nh\u1eadp \u0111\u1ee7 th\xf4ng tin b\u1ea1n nh\xe9",DOB_INPUT_LABEL:"Ng\xe0y sinh",DOB_INPUT_PLACEHOLDER:"Ch\u1ecdn ng\xe0y sinh"},a={TITLE:"X\xe1c th\u1ef1c t\xe0i kho\u1ea3n",INPUT_PLACEHOLDER:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",SUBMIT_BUTTON_LABEL:"Ti\u1ebfp t\u1ee5c",CREATE_SENPAY_WALLET_LABEL:"T\u1ea1o V\xed SenPay \u0111\u1ec3 thanh to\xe1n thu\u1eadn ti\u1ec7n, nh\u1eadn nhi\u1ec1u \u01b0u \u0111\xe3i ho\xe0n ti\u1ec1n.",PHONE_INVALID_MESSAGE:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i kh\xf4ng h\u1ee3p l\u1ec7."},c={TITLE:{[n.WT.SignInWithSMS]:"\u0110\u0103ng nh\u1eadp qua SMS",[n.WT.ForgotPassword]:"X\xe1c th\u1ef1c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",[n.WT.VerifyPhone]:"X\xe1c th\u1ef1c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",[n.WT.SignUpWithPhoneNumber]:"X\xe1c th\u1ef1c \u0111\u1ec3 \u0111\u0103ng k\xfd",[n.WT.SingUpWithSocial]:"X\xe1c th\u1ef1c \u0111\u1ec3 \u0111\u0103ng k\xfd",[n.WT.VerifyTrustDevice]:"Nh\u1eadp m\xe3 x\xe1c th\u1ef1c (OTP)",[n.WT.VerifyOTPUpdatePassword]:"X\xe1c th\u1ef1c t\xe0i kho\u1ea3n"},SUB_TITLE:{PHONE:"M\xe3 \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn S\u0110T",EMAIL:"M\xe3 \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn email"},INPUT_PLACEHOLDER:"Nh\u1eadp m\xe3 g\u1ed3m 6 ch\u1eef s\u1ed1",RESEND_OTP_LATER_LABEL:"G\u1eedi l\u1ea1i m\xe3 sau {number} gi\xe2y",RESEND_OTP_BUTTON_LABEL:"G\u1eedi l\u1ea1i m\xe3 x\xe1c nh\u1eadn",WRONG_RECEIVER_OTP:{PHONE_NUMBER:"Sai s\u1ed1 \u0111i\u1ec7n tho\u1ea1i?",EMAIL:"Sai email",TRUST_DEVICE:"Kh\xf4ng nh\u1eadn \u0111\u01b0\u1ee3c m\xe3?"},EDIT_PHONE_NUMBER:"S\u1eeda l\u1ea1i.",RECEIVE_EMAIL_OTP:"Nh\u1eadn qua email.",CANCEL_BUTTON_LABEL:"Tho\xe1t",SUBMIT_BUTTON_LABEL:"Ho\xe0n t\u1ea5t",ANOTHER_RECEIVE_OTP:"Th\u1eed l\u1ea1i v\u1edbi c\xe1ch kh\xe1c"},l={MESSAGE:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i n\xe0y \u0111\xe3 \u0111\u0103ng k\xfd t\xe0i kho\u1ea3n Sendo r\u1ed3i. \u0110\u0103ng nh\u1eadp qua tin nh\u1eafn (SMS) v\u1edbi m\xe3 x\xe1c th\u1ef1c \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn s\u1ed1 n\xe0y ho\u1eb7c d\xf9ng s\u1ed1 kh\xe1c b\u1ea1n nh\xe9.",USE_OTHER_PHONE_BUTTON_LABEL:"D\xf9ng s\u1ed1 kh\xe1c",LOGIN_BY_PHONE_BUTTON_LABEL:"\u0110\u0103ng nh\u1eadp qua SMS",VERIFY_LATER_BUTTON_LABEL:"X\xe1c th\u1ef1c sau",MESSAGE_1:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i ",MESSAGE_2:" \u0111\xe3 c\xf3 t\xe0i kho\u1ea3n Sendo n\xean kh\xf4ng th\u1ec3 x\xe1c th\u1ef1c cho t\xe0i kho\u1ea3n kh\xe1c. B\u1ea1n c\xf3 th\u1ec3 x\xe1c th\u1ef1c sau ho\u1eb7c \u0111\u0103ng nh\u1eadp qua tin nh\u1eafn SMS c\u1ee7a s\u1ed1 n\xe0y."},u={TITLE:"X\xe1c th\u1ef1c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"},d="C\xf3 l\u1ed7i x\u1ea3y ra. Vui l\xf2ng th\u1eed l\u1ea1i sau.",h="Tho\xe1t",p="B\u1ecf qua",g="Vui l\xf2ng cho ph\xe9p truy c\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 ti\u1ebfp t\u1ee5c",f="Kh\xf4ng l\u1ea5y \u0111\u01b0\u1ee3c th\xf4ng tin \u0111\u0103ng nh\u1eadp. Vui l\xf2ng th\u1eed l\u1ea1i sau.",v=[{label:"Anh",value:n.Y0.Male},{label:"Ch\u1ecb",value:n.Y0.Female}],m={TITLE:"Cho ph\xe9p truy c\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",DESCRIPTION:"Cho ph\xe9p truy c\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 li\xean h\u1ec7 giao h\xe0ng v\xe0 \u0111\u1ecbnh danh t\xe0i kho\u1ea3n.",IMAGE:"https://media3.scdn.vn/img4/2023/06_02/DtKBG255LGNEECRyhBiC.png",ACTION_BUTTON_LABEL:"V\xe0o trang Qu\u1ea3n l\xfd quy\u1ec1n"},y={TITLE:"Anh/Ch\u1ecb \u0111ang b\u1ecf l\u1ee1 nh\u1eefng s\u1ea3n ph\u1ea9m Sendo Farm t\u01b0\u01a1i ngon c\xf9ng nhi\u1ec1u \u01b0u \u0111\xe3i h\u1ea5p d\u1eabn. Cho ph\xe9p truy c\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 mua ngay.",ACTION_BUTTON_LABEL:"Cho ph\xe9p truy c\u1eadp S\u0110T"},_={IMAGE:"https://media3.scdn.vn/img4/2023/06_05/3ns3rj5aTIEMCk3n9yb0.png",DESCRIPTION:"Cho ph\xe9p truy c\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 li\xean h\u1ec7 giao h\xe0ng v\xe0 \u0111\u1ecbnh danh t\xe0i kho\u1ea3n anh/ch\u1ecb nh\xe9.",CANCEL_BUTTON_LABEL:"\u0110\u1ec3 sau",OK_BUTTON_LABEL:"\u0110\u1ed3ng \xfd"}},2131:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c,y:()=>a});var n=r(3939),s=r(3700);class o extends s.Z{async query(e){var t;return{url:new URL("/v3/status-pwa",this.domain).href,options:{method:"POST",credentials:"include",headers:e.accessToken?{Authorization:e.accessToken}:{},body:JSON.stringify({app_id:"pwa_v3",platform:null!==(t=e.platform)&&void 0!==t?t:void 0})}}}}const i=new n.Fetcher({id:"CheckStatus",service:new o},{success:async function(e,t,r){var n;const{dispatch:s}=t,o=null===(n=r.getState())||void 0===n?void 0:n.User,i=!!(null===e||void 0===e?void 0:e.customer_id);return s("User","set",{value:{fetched:!0,logged:i,loginVerified:null===o||void 0===o?void 0:o.get("loginVerified"),details:i?{data:e,metadata:{...null===o||void 0===o?void 0:o.getIn(["details","metadata"])}}:void 0}}),{data:e}},error:async function(e,t){const{dispatch:r}=t;return r("User","set",{value:{fetched:!0,logged:!1,loginVerified:!0}}),{error:e}}}),a=i.createHook(),c=i.export()},3212:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,Z:()=>u});var n=r(3939),s=r(9763),o=r(6106),i=r(3700);class a extends i.Z{async query(e){return{url:new URL("/login/social",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload),timeout:5e3}}}}const c=new n.Fetcher({id:"LoginSocial",service:new a},{success:async function(e){return e},error:async function(e,t){if("RequestTimedout"===e.name)s.Sentry.withScope((function(e){e.setTag("auth","login-social-fetch-timeout"),e.setExtra("message",`Payload: ${JSON.stringify(t)}`),s.Sentry.captureException("[Auth] Login social fetch timeout.")}));else{const r=(0,o.T7)(e);s.Sentry.withScope((function(e){e.setTag("auth","login-social-error"),e.setExtra("message",` Body: ${JSON.stringify(t).replace("auth_code","dummy_sentry")}}`),e.setExtra("error",r),s.Sentry.captureException("[Auth] Login social error.")}))}return{error:e}}}),l=c.createGetterHook(),u=c.export()},4089:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(5963);function s(e,t){void 0===t&&(t={});var r=function(e){if(e&&"j"===e[0]&&":"===e[1])return e.substr(2);return e}(e);if(function(e,t){return"undefined"===typeof t&&(t=!e||"{"!==e[0]&&"["!==e[0]&&'"'!==e[0]),!t}(r,t.doNotParse))try{return JSON.parse(r)}catch(e){}return e}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},o.apply(this,arguments)};const i=function(){function e(e,t){var r=this;this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.cookies=function(e,t){return"string"===typeof e?n.Q(e,t):"object"===typeof e&&null!==e?e:{}}(e,t),new Promise((function(){r.HAS_DOCUMENT_COOKIE="object"===typeof document&&"string"===typeof document.cookie})).catch((function(){}))}return e.prototype._updateBrowserValues=function(e){this.HAS_DOCUMENT_COOKIE&&(this.cookies=n.Q(document.cookie,e))},e.prototype._emitChange=function(e){for(var t=0;t<this.changeListeners.length;++t)this.changeListeners[t](e)},e.prototype.get=function(e,t,r){return void 0===t&&(t={}),this._updateBrowserValues(r),s(this.cookies[e],t)},e.prototype.getAll=function(e,t){void 0===e&&(e={}),this._updateBrowserValues(t);var r={};for(var n in this.cookies)r[n]=s(this.cookies[n],e);return r},e.prototype.set=function(e,t,r){var s;"object"===typeof t&&(t=JSON.stringify(t)),this.cookies=o(o({},this.cookies),((s={})[e]=t,s)),this.HAS_DOCUMENT_COOKIE&&(document.cookie=n.q(e,t,r)),this._emitChange({name:e,value:t,options:r})},e.prototype.remove=function(e,t){var r=t=o(o({},t),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=o({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=n.q(e,"",r)),this._emitChange({name:e,value:void 0,options:t})},e.prototype.addChangeListener=function(e){this.changeListeners.push(e)},e.prototype.removeChangeListener=function(e){var t=this.changeListeners.indexOf(e);t>=0&&this.changeListeners.splice(t,1)},e}();var a=r(3435),c=r(3939);class l extends c.Service{async parse(e,t){try{return await e.json()}catch(e){return{message:e}}}constructor(...e){var t,r,n;super(...e),n="https://cart-service.sendo.vn",(r="domain")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}const u=l;const d=new c.Fetcher({id:"MergeCarts",service:new class extends u{async query(){const e=new i;return{url:new URL(`/v1/carts/${e.get("client_id")}/mergers`,this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify({platform:a.Environment.is.web?"web":"wap"})}}}}},{success:async function(e){return{data:e}},error:async function(e){return{error:e}}}).export()},3700:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(3939),s=r(9763),o=r(6106);class i extends n.Service{async parse(e,t){try{return await e.json()}catch(t){const r=(0,o.T7)(t);return s.Sentry.withScope((function(t){t.setTag("auth","oauth-service-catch-error"),t.setExtra("error",r),t.setExtra("httpStatus",e.status),t.setExtra("response",JSON.stringify(e)),s.Sentry.captureException("[Auth] OauthService catch error.")})),{message:t}}}constructor(...e){var t,r,n;super(...e),n="https://oauth.sendo.vn",(r="domain")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}const a=i},5433:(e,t,r)=>{"use strict";r.d(t,{Z:()=>he});var n=r(3177),s=r(8354),o=r(8817),i=r(4506);function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidCharacterError";var c="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,s=0,o=0,i="";n=t.charAt(o++);~n&&(r=s%4?64*r+n:n,s++%4)?i+=String.fromCharCode(255&r>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function l(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(c(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return c(t)}}function u(e){this.message=e}u.prototype=new Error,u.prototype.name="InvalidTokenError";const d=function(e,t){if("string"!=typeof e)throw new u("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(l(e.split(".")[r]))}catch(e){throw new u("Invalid token specified: "+e.message)}};var h,p,g,f={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},v=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(v||{});(g=v||(v={})).reset=function(){h=3,p=f},g.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");h=e},g.setLogger=function(e){p=e};var m=class{debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h>=4&&p.debug(m._format(this._name,this._method),...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h>=3&&p.info(m._format(this._name,this._method),...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h>=2&&p.warn(m._format(this._name,this._method),...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h>=1&&p.error(m._format(this._name,this._method),...t)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const r=new m(`${e}.${t}`);return r.debug("begin"),r}static _format(e,t){const r=`[${e}]`;return t?`${r} ${t}:`:r}static debug(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];h>=4&&p.debug(m._format(e),...r)}static info(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];h>=3&&p.info(m._format(e),...r)}static warn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];h>=2&&p.warn(m._format(e),...r)}static error(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];h>=1&&p.error(m._format(e),...r)}constructor(e){this._name=e}};v.reset();var y=class{static _randomWord(){return n.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^y._randomWord()&15>>+e/4).toString(16))).replace(/-/g,"")}static generateCodeVerifier(){return y.generateUUIDv4()+y.generateUUIDv4()+y.generateUUIDv4()}static generateCodeChallenge(e){try{const t=s(e);return o.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(e){throw m.error("CryptoUtils.generateCodeChallenge",e),e}}static generateBasicAuth(e,t){const r=i.parse([e,t].join(":"));return o.stringify(r)}},_=class{addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._logger.debug("raise:",...t);for(const e of this._callbacks)e(...t)}constructor(e){this._name=e,this._logger=new m(`Event('${this._name}')`),this._callbacks=[]}},w=class{static decode(e){try{return d(e)}catch(e){throw m.error("JwtUtils.decode",e),e}}},b=class{static center(e){let{...t}=e;var r;return null==t.width&&(t.width=null!=(r=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?r:360),null!=t.left||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),null!=t.height&&(null!=t.top||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(e){return Object.entries(e).filter((e=>{let[,t]=e;return null!=t})).map((e=>{let[t,r]=e;return`${t}=${"boolean"!==typeof r?r:r?"yes":"no"}`})).join(",")}},S=class extends _{static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const r=S.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=r;const n=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*n)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}constructor(){super(...arguments),this._logger=new m(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-S.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=S.getEpochTime()&&(this.cancel(),super.raise())}}},x=class{static readParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");const r=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}},T=class extends Error{constructor(e,t){var r,n,s;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw m.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(r=e.error_description)?r:null,this.error_uri=null!=(n=e.error_uri)?n:null,this.state=e.userState,this.session_state=null!=(s=e.session_state)?s:null,this.url_state=e.url_state}},k=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},E=class{load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){let e=r-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;t.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}constructor(e){this._logger=new m("AccessTokenEvents"),this._expiringTimer=new S("Access token expiring"),this._expiredTimer=new S("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}},O=class{load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}constructor(e,t,r,n,s){this._callback=e,this._client_id=t,this._intervalInSeconds=n,this._stopOnError=s,this._logger=new m("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const o=new URL(r);this._frame_origin=o.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=o.href}},C=class{clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}constructor(){this._logger=new m("InMemoryWebStorage"),this._data={}}},P=class{async fetchWithTimeout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeoutInSeconds:r,...n}=t;if(!r)return await fetch(e,n);const s=new AbortController,o=setTimeout((()=>s.abort()),1e3*r);try{return await fetch(e,{...t,signal:s.signal})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw new k("Network timed out");throw e}finally{clearTimeout(o)}}async getJson(e){let{token:t,credentials:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this._logger.create("getJson"),s={Accept:this._contentTypes.join(", ")};let o;t&&(n.debug("token passed, setting Authorization header"),s.Authorization="Bearer "+t),this.appendExtraHeaders(s);try{n.debug("url:",e),o=await this.fetchWithTimeout(e,{method:"GET",headers:s,credentials:r})}catch(e){throw n.error("Network Error"),e}n.debug("HTTP response received, status",o.status);const i=o.headers.get("Content-Type");if(i&&!this._contentTypes.find((e=>i.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=i?i:"undefined"}, from URL: ${e}`)),o.ok&&this._jwtHandler&&(null==i?void 0:i.startsWith("application/jwt")))return await this._jwtHandler(await o.text());let a;try{a=await o.json()}catch(e){if(n.error("Error parsing JSON response",e),o.ok)throw e;throw new Error(`${o.statusText} (${o.status})`)}if(!o.ok){if(n.error("Error from server:",a),a.error)throw new T(a);throw new Error(`${o.statusText} (${o.status}): ${JSON.stringify(a)}`)}return a}async postForm(e,t){let{body:r,basicAuth:n,timeoutInSeconds:s,initCredentials:o}=t;const i=this._logger.create("postForm"),a={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let c;void 0!==n&&(a.Authorization="Basic "+n),this.appendExtraHeaders(a);try{i.debug("url:",e),c=await this.fetchWithTimeout(e,{method:"POST",headers:a,body:r,timeoutInSeconds:s,credentials:o})}catch(e){throw i.error("Network error"),e}i.debug("HTTP response received, status",c.status);const l=c.headers.get("Content-Type");if(l&&!this._contentTypes.find((e=>l.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=l?l:"undefined"}, from URL: ${e}`);const u=await c.text();let d={};if(u)try{d=JSON.parse(u)}catch(e){if(i.error("Error parsing JSON response",e),c.ok)throw e;throw new Error(`${c.statusText} (${c.status})`)}if(!c.ok){if(i.error("Error from server:",d),d.error)throw new T(d,r);throw new Error(`${c.statusText} (${c.status}): ${JSON.stringify(d)}`)}return d}appendExtraHeaders(e){const t=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["authorization","accept","content-type"];0!==r.length&&r.forEach((r=>{if(n.includes(r.toLocaleLowerCase()))return void t.warn("Protected header could not be overridden",r,n);const s="function"===typeof this._extraHeaders[r]?this._extraHeaders[r]():this._extraHeaders[r];s&&""!==s&&(e[r]=s)}))}constructor(e=[],t=null,r={}){this._jwtHandler=t,this._extraHeaders=r,this._logger=new m("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}},j=class{resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._logger.create(`_getMetadataProperty('${e}')`),n=await this.getMetadata();if(r.debug("resolved"),void 0===n[e]){if(!0===t)return void r.warn("Metadata does not contain optional property");r.throw(new Error("Metadata does not contain property "+e))}return n[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const r=await this._jsonService.getJson(t);if(e.debug("got key set",r),!Array.isArray(r.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}constructor(e){this._settings=e,this._logger=new m("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new P(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}},A=class{async set(e,t){this._logger.create(`set('${e}')`),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let r=0;r<e;r++){const e=await this._store.key(r);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new m("WebStorageStateStore"),this._store=t,this._prefix=e}},I=class{constructor({authority:e,metadataUrl:t,metadata:r,signingKeys:n,metadataSeed:s,client_id:o,client_secret:i,response_type:a="code",scope:c="openid",redirect_uri:l,post_logout_redirect_uri:u,client_authentication:d="client_secret_post",prompt:h,display:p,max_age:g,ui_locales:f,acr_values:v,resource:m,response_mode:y="query",filterProtocolClaims:_=!0,loadUserInfo:w=!1,staleStateAgeInSeconds:b=900,clockSkewInSeconds:S=300,userInfoJwtIssuer:x="OP",mergeClaims:T=!1,disablePKCE:k=!1,stateStore:E,refreshTokenCredentials:O,revokeTokenAdditionalContentTypes:P,fetchRequestCredentials:j,refreshTokenAllowedScope:I,extraQueryParams:N={},extraTokenParams:R={},extraHeaders:M={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=s,this.signingKeys=n,this.client_id=o,this.client_secret=i,this.response_type=a,this.scope=c,this.redirect_uri=l,this.post_logout_redirect_uri=u,this.client_authentication=d,this.prompt=h,this.display=p,this.max_age=g,this.ui_locales=f,this.acr_values=v,this.resource=m,this.response_mode=y,this.filterProtocolClaims=null==_||_,this.loadUserInfo=!!w,this.staleStateAgeInSeconds=b,this.clockSkewInSeconds=S,this.userInfoJwtIssuer=x,this.mergeClaims=!!T,this.disablePKCE=!!k,this.revokeTokenAdditionalContentTypes=P,j&&O&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=j||(O||"same-origin"),E)this.stateStore=E;else{const e="undefined"!==typeof window?window.localStorage:new C;this.stateStore=new A({store:e})}this.refreshTokenAllowedScope=I,this.extraQueryParams=N,this.extraTokenParams=R,this.extraHeaders=M}},N=class{async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:e,credentials:this._settings.fetchRequestCredentials});return t.debug("got claims",n),n}constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new m("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const r=w.decode(e);return t.debug("JWT decoding successful"),r}catch(e){throw t.error("Error parsing JWT response"),e}},this._jsonService=new P(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}},R=class{async exchangeCode(e){let{grant_type:t="authorization_code",redirect_uri:r=this._settings.redirect_uri,client_id:n=this._settings.client_id,client_secret:s=this._settings.client_secret,...o}=e;const i=this._logger.create("exchangeCode");n||i.throw(new Error("A client_id is required")),r||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const a=new URLSearchParams({grant_type:t,redirect_uri:r});for(const[e,t]of Object.entries(o))null!=t&&a.set(e,t);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!s)throw i.throw(new Error("A client_secret is required")),null;c=y.generateBasicAuth(n,s);break;case"client_secret_post":a.append("client_id",n),s&&a.append("client_secret",s)}const l=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const u=await this._jsonService.postForm(l,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),u}async exchangeCredentials(e){let{grant_type:t="password",client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,scope:s=this._settings.scope,...o}=e;const i=this._logger.create("exchangeCredentials");r||i.throw(new Error("A client_id is required"));const a=new URLSearchParams({grant_type:t,scope:s});for(const[e,t]of Object.entries(o))null!=t&&a.set(e,t);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;c=y.generateBasicAuth(r,n);break;case"client_secret_post":a.append("client_id",r),n&&a.append("client_secret",n)}const l=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const u=await this._jsonService.postForm(l,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),u}async exchangeRefreshToken(e){let{grant_type:t="refresh_token",client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,timeoutInSeconds:s,...o}=e;const i=this._logger.create("exchangeRefreshToken");r||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const a=new URLSearchParams({grant_type:t});for(const[e,t]of Object.entries(o))Array.isArray(t)?t.forEach((t=>a.append(e,t))):null!=t&&a.set(e,t);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;c=y.generateBasicAuth(r,n);break;case"client_secret_post":a.append("client_id",r),n&&a.append("client_secret",n)}const l=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const u=await this._jsonService.postForm(l,{body:a,basicAuth:c,timeoutInSeconds:s,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),u}async revoke(e){var t;const r=this._logger.create("revoke");e.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const s=new URLSearchParams;for(const[t,r]of Object.entries(e))null!=r&&s.set(t,r);s.set("client_id",this._settings.client_id),this._settings.client_secret&&s.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:s}),r.debug("got response")}constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new m("TokenClient"),this._jsonService=new P(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}},M=class{async validateSigninResponse(e,t){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const r=this._logger.create("validateCredentialsResponse");e.isOpenId&&e.id_token&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,t,e.isOpenId),r.debug("claims processed")}async validateRefreshResponse(e,t){const r=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),r.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const n=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,n),r.debug("claims processed")}validateSignoutResponse(e,t){const r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new T(e)}_processSigninState(e,t){const r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,e.url_state=t.url_state,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new T(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}async _processClaims(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this._logger.create("_processClaims");if(e.profile=this._claimsService.filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void n.debug("not loading user info");n.debug("loading user info");const s=await this._userInfoService.getClaims(e.access_token);n.debug("user info claims received from user info endpoint"),r&&s.sub!==e.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._claimsService.mergeClaims(e.profile,this._claimsService.filterProtocolClaims(s)),n.debug("user info claims received, updated profile:",e.profile)}async _processCode(e,t){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,n)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const s=w.decode(null!=(r=e.id_token)?r:"");if(s.sub||n.throw(new Error("ID Token is missing a subject claim")),t){const e=w.decode(t);s.sub!==e.sub&&n.throw(new Error("sub in id_token does not match current sub")),s.auth_time&&s.auth_time!==e.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),s.azp&&s.azp!==e.azp&&n.throw(new Error("azp in id_token does not match original azp")),!s.azp&&e.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=s}constructor(e,t,r){this._settings=e,this._metadataService=t,this._claimsService=r,this._logger=new m("ResponseValidator"),this._userInfoService=new N(this._settings,this._metadataService),this._tokenClient=new R(this._settings,this._metadataService)}},B=class{toStorageString(){return new m("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(e){return m.createStatic("State","fromStorageString"),new B(JSON.parse(e))}static async clearStaleState(e,t){const r=m.createStatic("State","clearStaleState"),n=S.getEpochTime()-t,s=await e.getAllKeys();r.debug("got keys",s);for(let t=0;t<s.length;t++){const o=s[t],i=await e.get(o);let a=!1;if(i)try{const e=B.fromStorageString(i);r.debug("got item from key:",o,e.created),e.created<=n&&(a=!0)}catch(e){r.error("Error parsing state for key:",o,e),a=!0}else r.debug("no item in storage for key:",o),a=!0;a&&(r.debug("removed item for key:",o),e.remove(o))}}constructor(e){this.id=e.id||y.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=S.getEpochTime(),this.request_type=e.request_type,this.url_state=e.url_state}},L=class extends B{toStorageString(){return new m("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){m.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new L(t)}constructor(e){super(e),!0===e.code_verifier?this.code_verifier=y.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=y.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}},U=class{constructor({url:e,authority:t,client_id:r,redirect_uri:n,response_type:s,scope:o,state_data:i,response_mode:a,request_type:c,client_secret:l,nonce:u,url_state:d,resource:h,skipUserInfo:p,extraQueryParams:g,extraTokenParams:f,disablePKCE:v,...y}){if(this._logger=new m("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!s)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!o)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new L({data:i,request_type:c,url_state:d,code_verifier:!v,client_id:r,authority:t,redirect_uri:n,response_mode:a,client_secret:l,scope:o,extraTokenParams:f,skipUserInfo:p});const _=new URL(e);_.searchParams.append("client_id",r),_.searchParams.append("redirect_uri",n),_.searchParams.append("response_type",s),_.searchParams.append("scope",o),u&&_.searchParams.append("nonce",u);let w=this.state.id;if(d&&(w=`${w};${d}`),_.searchParams.append("state",w),this.state.code_challenge&&(_.searchParams.append("code_challenge",this.state.code_challenge),_.searchParams.append("code_challenge_method","S256")),h){(Array.isArray(h)?h:[h]).forEach((e=>_.searchParams.append("resource",e)))}for(const[e,t]of Object.entries({response_mode:a,...y,...g}))null!=t&&_.searchParams.append(e,t.toString());this.url=_.href}},q=class{get expires_in(){if(void 0!==this.expires_at)return this.expires_at-S.getEpochTime()}set expires_in(e){"string"===typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+S.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}constructor(e){if(this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(";");this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(";"))}this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}},D=class{constructor({url:e,state_data:t,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:s,request_type:o,client_id:i}){if(this._logger=new m("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const a=new URL(e);r&&a.searchParams.append("id_token_hint",r),i&&a.searchParams.append("client_id",i),n&&(a.searchParams.append("post_logout_redirect_uri",n),t&&(this.state=new B({data:t,request_type:o}),a.searchParams.append("state",this.state.id)));for(const[e,t]of Object.entries({...s}))null!=t&&a.searchParams.append(e,t.toString());this.url=a.href}},V=class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}},F=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],W=["sub","iss","aud","exp","iat"],G=class{filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:F;for(const r of e)W.includes(r)||delete t[r]}return t}mergeClaims(e,t){const r={...e};for(const[e,n]of Object.entries(t))for(const t of Array.isArray(n)?n:[n]){const n=r[e];void 0===n?r[e]=t:Array.isArray(n)?n.includes(t)||n.push(t):r[e]!==t&&("object"===typeof t&&this._settings.mergeClaims?r[e]=this.mergeClaims(n,t):r[e]=[n,t])}return r}constructor(e){this._settings=e,this._logger=new m("ClaimsService")}},H=class{async createSigninRequest(e){let{state:t,request:r,request_uri:n,request_type:s,id_token_hint:o,login_hint:i,skipUserInfo:a,nonce:c,url_state:l,response_type:u=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:p=this.settings.prompt,display:g=this.settings.display,max_age:f=this.settings.max_age,ui_locales:v=this.settings.ui_locales,acr_values:m=this.settings.acr_values,resource:y=this.settings.resource,response_mode:_=this.settings.response_mode,extraQueryParams:w=this.settings.extraQueryParams,extraTokenParams:b=this.settings.extraTokenParams}=e;const S=this._logger.create("createSigninRequest");if("code"!==u)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const x=await this.metadataService.getAuthorizationEndpoint();S.debug("Received authorization endpoint",x);const T=new U({url:x,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:u,scope:d,state_data:t,url_state:l,prompt:p,display:g,max_age:f,ui_locales:v,id_token_hint:o,login_hint:i,acr_values:m,resource:y,request:r,request_uri:n,extraQueryParams:w,extraTokenParams:b,request_type:s,response_mode:_,client_secret:this.settings.client_secret,skipUserInfo:a,nonce:c,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const k=T.state;return await this.settings.stateStore.set(k.id,k.toStorageString()),T}async readSigninResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._logger.create("readSigninResponseState"),n=new q(x.readParams(e,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const s=await this.settings.stateStore[t?"remove":"get"](n.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:L.fromStorageString(s),response:n}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials(e){let{username:t,password:r,skipUserInfo:n=!1,extraTokenParams:s={}}=e;const o=await this._tokenClient.exchangeCredentials({username:t,password:r,...s}),i=new q(new URLSearchParams);return Object.assign(i,o),await this._validator.validateCredentialsResponse(i,n),i}async useRefreshToken(e){let{state:t,timeoutInSeconds:r}=e;var n;const s=this._logger.create("useRefreshToken");let o;if(void 0===this.settings.refreshTokenAllowedScope)o=t.scope;else{const e=this.settings.refreshTokenAllowedScope.split(" ");o=((null==(n=t.scope)?void 0:n.split(" "))||[]).filter((t=>e.includes(t))).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,resource:t.resource,scope:o,timeoutInSeconds:r}),a=new q(new URLSearchParams);return Object.assign(a,i),s.debug("validating response",a),await this._validator.validateRefreshResponse(a,{...t,scope:o}),a}async createSignoutRequest(){let{state:e,id_token_hint:t,client_id:r,request_type:n,post_logout_redirect_uri:s=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this._logger.create("createSignoutRequest"),a=await this.metadataService.getEndSessionEndpoint();if(!a)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",a),r||!s||t||(r=this.settings.client_id);const c=new D({url:a,id_token_hint:t,client_id:r,post_logout_redirect_uri:s,state_data:e,extraQueryParams:o,request_type:n});await this.clearStaleState();const l=c.state;return l&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(l.id,l.toStorageString())),c}async readSignoutResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._logger.create("readSignoutResponseState"),n=new V(x.readParams(e,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new T(n);return{state:void 0,response:n}}const s=await this.settings.stateStore[t?"remove":"get"](n.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:B.fromStorageString(s),response:n}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(e,!0);return r?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):t.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),B.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}constructor(e,t){this._logger=new m("OidcClient"),this.settings=e instanceof I?e:new I(e),this.metadataService=null!=t?t:new j(this.settings),this._claimsService=new G(this.settings),this._validator=new M(this.settings,this.metadataService,this._claimsService),this._tokenClient=new R(this.settings,this.metadataService)}},z=class{async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}constructor(e){this._userManager=e,this._logger=new m("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const r=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,r.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,r.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){r.debug("initializing check session iframe");const n=this._userManager.settings.client_id,s=this._userManager.settings.checkSessionIntervalInSeconds,o=this._userManager.settings.stopCheckSessionOnError,i=new O(this._callback,n,e,s,o);await i.load(),this._checkSessionIFrame=i,i.start(t)}else r.warn("no check session iframe found in the metadata")}catch(e){r.error("Error from getCheckSessionIframe:",e instanceof Error?e.message:e)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(t){e.error("error from querySessionStatus",t instanceof Error?t.message:t)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let r=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(r=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),r?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}},$=class{get expires_in(){if(void 0!==this.expires_at)return this.expires_at-S.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+S.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new m("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return m.createStatic("User","fromStorageString"),new $(JSON.parse(e))}constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState,this.url_state=e.url_state}},Z="oidc-client",J=class{async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:r,keepOpen:n}=await new Promise(((r,n)=>{const s=s=>{var o;const i=s.data,a=null!=(o=e.scriptOrigin)?o:window.location.origin;if(s.origin===a&&(null==i?void 0:i.source)===Z){try{const r=x.readParams(i.url,e.response_mode).get("state");if(r||t.warn("no state found in response url"),s.source!==this._window&&r!==e.state)return}catch(e){this._dispose(),n(new Error("Invalid response from window"))}r(i)}};window.addEventListener("message",s,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",s,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),n(e)})))}));return t.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;e.postMessage({source:Z,url:t,keepOpen:r},n)}constructor(){this._abort=new _("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}},X={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},K="_blank",Q=60,Y=2,ee=10,te=class extends I{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:r=e.post_logout_redirect_uri,popupWindowFeatures:n=X,popupWindowTarget:s=K,redirectMethod:o="assign",redirectTarget:i="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:l=e.redirect_uri,silentRequestTimeoutInSeconds:u=ee,automaticSilentRenew:d=!0,validateSubOnSilentRenew:h=!0,includeIdTokenInSilentRenew:p=!1,monitorSession:g=!1,monitorAnonymousSession:f=!1,checkSessionIntervalInSeconds:v=Y,query_status_response_type:m="code",stopCheckSessionOnError:y=!0,revokeTokenTypes:_=["access_token","refresh_token"],revokeTokensOnSignout:w=!1,includeIdTokenInSilentSignout:b=!1,accessTokenExpiringNotificationTimeInSeconds:S=Q,userStore:x}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=s,this.redirectMethod=o,this.redirectTarget=i,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=l,this.silentRequestTimeoutInSeconds=u,this.automaticSilentRenew=d,this.validateSubOnSilentRenew=h,this.includeIdTokenInSilentRenew=p,this.monitorSession=g,this.monitorAnonymousSession=f,this.checkSessionIntervalInSeconds=v,this.stopCheckSessionOnError=y,this.query_status_response_type=m,this.revokeTokenTypes=_,this.revokeTokensOnSignout=w,this.includeIdTokenInSilentSignout=b,this.accessTokenExpiringNotificationTimeInSeconds=S,x)this.userStore=x;else{const e="undefined"!==typeof window?window.sessionStorage:new C;this.userStore=new A({store:e})}}},re=class extends J{static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new k("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const r=e.target;null==(t=r.parentNode)||t.removeChild(r),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}constructor({silentRequestTimeoutInSeconds:e=ee}){super(),this._logger=new m("IFrameWindow"),this._timeoutInSeconds=e,this._frame=re.createHiddenIframe(),this._window=this._frame.contentWindow}},ne=class{async prepare(e){let{silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}=e;return new re({silentRequestTimeoutInSeconds:t})}async callback(e){this._logger.create("callback"),re.notifyParent(e,this._settings.iframeNotifyParentOrigin)}constructor(e){this._settings=e,this._logger=new m("IFrameNavigator")}},se=class extends J{async navigate(e){var t;null==(t=this._window)||t.focus();const r=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(r))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}constructor({popupWindowTarget:e=K,popupWindowFeatures:t={}}){super(),this._logger=new m("PopupWindow");const r=b.center({...X,...t});this._window=window.open(void 0,e,b.serialize(r)),t.closePopupWindowAfterInSeconds&&t.closePopupWindowAfterInSeconds>0&&setTimeout((()=>{this._window&&"boolean"===typeof this._window.closed&&!this._window.closed?this.close():this._abort.raise(new Error("Popup blocked by user"))}),1e3*t.closePopupWindowAfterInSeconds)}},oe=class{async prepare(e){let{popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:r=this._settings.popupWindowTarget}=e;return new se({popupWindowFeatures:t,popupWindowTarget:r})}async callback(e,t){let{keepOpen:r=!1}=t;this._logger.create("callback"),se.notifyOpener(e,r)}constructor(e){this._settings=e,this._logger=new m("PopupNavigator")}},ie=class{async prepare(e){let{redirectMethod:t=this._settings.redirectMethod,redirectTarget:r=this._settings.redirectTarget}=e;var n;this._logger.create("prepare");let s=window.self;"top"===r&&(s=null!=(n=window.top)?n:window.self);const o=s.location[t].bind(s.location);let i;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{i=t}));return o(e.url),await t},close:()=>{this._logger.create("close"),null==i||i(new Error("Redirect aborted")),s.stop()}}}async callback(){}constructor(e){this._settings=e,this._logger=new m("RedirectNavigator")}},ae=class extends E{load(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new m("UserManagerEvents"),this._userLoaded=new _("User loaded"),this._userUnloaded=new _("User unloaded"),this._silentRenewError=new _("Silent renew error"),this._userSignedIn=new _("User signed in"),this._userSignedOut=new _("User signed out"),this._userSessionChanged=new _("User session changed")}},ce=class{async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}constructor(e){this._userManager=e,this._logger=new m("SilentRenewService"),this._isStarted=!1,this._retryTimer=new S("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof k)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}},le=class{constructor(e,t){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.resource=t,this.data=e.state}};function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class de{static async login(){return await this.userManager.signinPopup()}static async loginCallback(e){if(e){return await this.userManager.signinRedirectCallback()}return await this.userManager.signinPopupCallback()}static async getUserInfo(){return await this.userManager.getUser()}}ue(de,"settings",{authority:"https://accounts.fpt.vn",client_id:"sendo-web-client",redirect_uri:"https://www.sendo.vn/xac-thuc/fpt-id",scope:"openid offline email profile",userInfoEndpoint:"/userinfo",extra:{prompt:"consent",access_type:"offline"}}),ue(de,"userManager",new class{get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._logger.create("signinRedirect");const{redirectMethod:t,...r}=e,n=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(e);return r.profile&&r.profile.sub?t.info("success, signed in subject",r.profile.sub):t.info("no subject"),r}async signinResourceOwnerCredentials(e){let{username:t,password:r,skipUserInfo:n=!1}=e;const s=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:t,password:r,skipUserInfo:n,extraTokenParams:this.settings.extraTokenParams});s.debug("got signin response");const i=await this._buildUser(o);return i.profile&&i.profile.sub?s.info("success, signed in subject",i.profile.sub):s.info("no subject"),i}async signinPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...s}=e,o=this.settings.popup_redirect_uri;o||t.throw(new Error("No popup_redirect_uri configured"));const i=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),a=await this._signin({request_type:"si:p",redirect_uri:o,display:"popup",...s},i);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),r.info("success")}async signinSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,resource:s,...o}=e;let i=await this._loadUser();if(null==i?void 0:i.refresh_token){r.debug("using refresh token");const e=new le(i,s);return await this._useRefreshToken(e)}const a=this.settings.silent_redirect_uri;let c;a||r.throw(new Error("No silent_redirect_uri configured")),i&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",i.profile.sub),c=i.profile.sub);const l=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return i=await this._signin({request_type:"si:s",redirect_uri:a,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,...o},l,c),i&&((null==(t=i.profile)?void 0:t.sub)?r.info("success, signed in subject",i.profile.sub):r.info("no subject")),i}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new $({...e,...t});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:r}=await this._client.readSignoutResponseState(e);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=e,s=this.settings.silent_redirect_uri;s||t.throw(new Error("No silent_redirect_uri configured"));const o=await this._loadUser(),i=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=await this._signinStart({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==o?void 0:o.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},i);try{const e=await this._client.processSigninResponse(a.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(e){if(this.settings.monitorAnonymousSession&&e instanceof T)switch(e.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:e.session_state}}throw e}}async _signin(e,t,r){const n=await this._signinStart(e,t);return await this._signinEnd(n.url,r)}async _signinStart(e,t){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(e);return r.debug("got signin request"),await t.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(e){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),e}}async _signinEnd(e,t){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(e);r.debug("got signin response");return await this._buildUser(n,t)}async _buildUser(e,t){const r=this._logger.create("_buildUser"),n=new $(e);if(t){if(t!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new T({...e,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=e,s=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},s),t.info("success")}async signoutRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(e);return t.info("success"),r}async signoutPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...s}=e,o=this.settings.popup_post_logout_redirect_uri,i=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:o,state:null==o?void 0:{},...s},i),t.info("success")}async signoutPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),r.info("success")}async _signout(e,t){const r=await this._signoutStart(e,t);return await this._signoutEnd(r.url)}async _signoutStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var r;const n=this._logger.create("_signoutStart");try{const s=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(s);const o=e.id_token_hint||s&&s.id_token;o&&(n.debug("setting id_token_hint in signout request"),e.id_token_hint=o),await this.removeUser(),n.debug("user removed, creating signout request");const i=await this._client.createSignoutRequest(e);return n.debug("got signout request"),await t.navigate({url:i.url,state:null==(r=i.state)?void 0:r.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(e){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),e}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(e);return t.debug("got signout response"),r}async signoutSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...s}=e,o=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,i=this.settings.popup_post_logout_redirect_uri,a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:i,id_token_hint:o,...s},a),r.info("success")}async signoutSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.settings.revokeTokenTypes;const r=this._logger.create("_revokeInternal");if(!e)return;const n=t.filter((t=>"string"===typeof e[t]));if(n.length){for(const t of n)await this._client.revokeToken(e[t],t),r.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),r.debug("user stored"),this._events.load(e)}else r.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),$.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const r=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}constructor(e,t,r,n){this._logger=new m("UserManager"),this.settings=new te(e),this._client=new H(e),this._redirectNavigator=null!=t?t:new ie(this.settings),this._popupNavigator=null!=r?r:new oe(this.settings),this._iframeNavigator=null!=n?n:new ne(this.settings),this._events=new ae(this.settings),this._silentRenewService=new ce(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new z(this))}}(de.settings));const he=de},6106:(e,t,r)=>{"use strict";r.d(t,{T7:()=>o,gi:()=>n,p6:()=>s});const n=e=>{const t=e.replace("(+84)","0").replace("+84","0").replace(/ /g,"");return t.startsWith("84")?t.replace("84","0"):t},s=(e,t)=>{let r=e.getDate(),n=e.getMonth()+1;return r<10&&(r="0"+r),n<10&&(n="0"+n),t?`${r}/${n}/${e.getFullYear()}`:`${e.getFullYear()}-${n}-${r}`},o=e=>Object.getOwnPropertyNames(e||{}).reduce(((t,r)=>(t[r]=e[r],t)),{})},3230:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"24-/-arrows-/-icon24_arrow_back_default",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("path",{id:"icon-background",fill:"#6F787E",fillRule:"nonzero",d:"m6.414 13 6.293 6.293-1.414 1.414L2.586 12l8.707-8.707 1.414 1.414L6.414 11H21v2z"}))))}))})(),s})(),e.exports=n(r(8156))},1836:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"24-/-time-/-icon24_calendar_default",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("path",{d:"M8 2v1h8V2h2v1h2a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h2V2h2Zm12 8H4v10h16V10ZM6 5H4v3h16V5h-2v1h-2V5H8v1H6V5Z",id:"icon-background",fill:"#6F787E",fillRule:"nonzero"}))))}))})(),s})(),e.exports=n(r(8156))},7888:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"24-/-arrows-/-icon24_chevron_right_default",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("path",{id:"icon-background",fill:"#6F787E",fillRule:"nonzero",d:"M13.214 12 8 6.476 9.393 5 16 12l-6.607 7L8 17.524z"}))))}))})(),s})(),e.exports=n(r(8156))},3719:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("path",{fill:"#6F787E",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"})))}))})(),s})(),e.exports=n(r(8156))},8818:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"24-/-basic-/-icon24_eye_close_default",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("path",{d:"m20.098 15.891-1.414-1.414a21.594 21.594 0 0 0 2.1-2.477 21.328 21.328 0 0 0-2.408-2.781C16.283 7.194 14.106 6 12 6c-.522 0-1.05.074-1.578.215L8.84 4.633C9.873 4.221 10.927 4 12 4c2.728 0 5.336 1.43 7.766 3.781.83.802 1.58 1.658 2.24 2.515.399.516.682.923.836 1.165l.345.539-.345.539c-.154.242-.437.649-.836 1.165-.571.741-1.21 1.482-1.908 2.187ZM2.708 1.293l20 20-1.415 1.414-4.288-4.287C15.394 19.43 13.72 20 12 20c-2.728 0-5.336-1.43-7.766-3.781a23.305 23.305 0 0 1-2.24-2.515 17.484 17.484 0 0 1-.836-1.165L.813 12l.345-.539c.154-.242.437-.649.836-1.165.66-.857 1.41-1.713 2.24-2.515.37-.358.745-.695 1.123-1.008L1.293 2.707l1.414-1.414Zm2.916 7.926A21.328 21.328 0 0 0 3.216 12a21.328 21.328 0 0 0 2.408 2.781C7.717 16.806 9.894 18 12 18c1.168 0 2.358-.368 3.543-1.04l-1.512-1.513a4 4 0 0 1-5.478-5.478L6.78 8.194a17.19 17.19 0 0 0-1.156 1.025ZM10 12a2 2 0 0 0 2.517 1.932l-2.45-2.45A2.003 2.003 0 0 0 10 12Z",id:"icon-background",fill:"#6F787E",fillRule:"nonzero"}))))}))})(),s})(),e.exports=n(r(8156))},9735:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"24-/-basic-/-icon24_eye_open_default",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("path",{d:"M12 4c2.728 0 5.336 1.43 7.766 3.781.83.802 1.58 1.658 2.24 2.515.399.516.682.923.836 1.165l.345.539-.345.539c-.154.242-.437.649-.836 1.165-.66.857-1.41 1.713-2.24 2.515C17.336 18.569 14.728 20 12 20c-2.728 0-5.336-1.43-7.766-3.781a23.305 23.305 0 0 1-2.24-2.515 17.484 17.484 0 0 1-.836-1.165L.813 12l.345-.539c.154-.242.437-.649.836-1.165.66-.857 1.41-1.713 2.24-2.515C6.664 5.431 9.272 4 12 4Zm0 2C9.895 6 7.717 7.194 5.624 9.219A21.328 21.328 0 0 0 3.216 12a21.328 21.328 0 0 0 2.408 2.781C7.717 16.806 9.894 18 12 18c2.105 0 4.283-1.194 6.376-3.219A21.328 21.328 0 0 0 20.784 12a21.328 21.328 0 0 0-2.408-2.781C16.283 7.194 14.106 6 12 6Zm0 2a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z",id:"icon-background",fill:"#6F787E",fillRule:"nonzero"}))))}))})(),s})(),e.exports=n(r(8156))},4728:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({width:40,height:40,viewBox:"0 0 40 40",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("g",{id:"Sign-in-/-Sign-up-v3---June2021",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",{id:"Welcome-/-Placeholder",transform:"translate(-16 -579)",fillRule:"nonzero"},t.createElement("g",{id:"Body",transform:"translate(0 186)"},t.createElement("g",{id:"Fb",transform:"translate(16 393)"},t.createElement("circle",{id:"Oval",fill:"#1977F3",cx:20,cy:20,r:20}),t.createElement("path",{d:"M27.785 25.783 28.671 20h-5.546v-3.752c0-1.58.773-3.125 3.26-3.125h2.522V8.201s-2.29-.39-4.477-.39c-4.568 0-7.555 2.767-7.555 7.782V20h-5.08v5.783h5.08v13.975c1.018.16 2.062.242 3.125.242 1.063 0 2.107-.084 3.125-.242V25.783h4.66Z",id:"Path",fill:"#FFF"})))))))}))})(),s})(),e.exports=n(r(8156))},4139:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>o});var e=n(8156),t=["title","titleId"];function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}const o=(0,e.forwardRef)((function(n,s){var o=n.title,i=n.titleId,a=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,t);return e.createElement("svg",r({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:0,y:0,viewBox:"0 0 40 40",style:{enableBackground:"new 0 0 40 40"},xmlSpace:"preserve",ref:s,"aria-labelledby":i},a),o?e.createElement("title",{id:i},o):null,e.createElement("circle",{cx:20,cy:20,r:20,style:{fillRule:"evenodd",clipRule:"evenodd",fill:"#fff"}}),e.createElement("path",{id:"Path",d:"M31.5 20.3c0-.8-.1-1.5-.2-2.3H20v4.5h6.5c-.3 1.5-1.1 2.7-2.4 3.6v3H28c2.2-2.1 3.5-5.2 3.5-8.8z",style:{fill:"#4285f4"}}),e.createElement("path",{d:"M20 32c3.2 0 6-1.1 7.9-2.9l-3.9-3c-1.1.7-2.5 1.2-4.1 1.2-3.1 0-5.8-2.1-6.7-5h-4v3.1C11.3 29.3 15.3 32 20 32z",style:{fill:"#34a853"}}),e.createElement("path",{d:"M13.3 22.3c-.2-.7-.4-1.5-.4-2.3s.1-1.6.4-2.3v-3.1h-4C8.5 16.2 8 18.1 8 20s.5 3.8 1.3 5.4l4-3.1z",style:{fill:"#fbbc05"}}),e.createElement("path",{d:"M20 12.8c1.8 0 3.4.6 4.6 1.8l3.4-3.4c-2-2-4.8-3.2-8-3.2-4.7 0-8.7 2.7-10.7 6.6l4 3.1c.9-2.8 3.6-4.9 6.7-4.9z",style:{fill:"#ea4335"}}))}))})(),s})(),e.exports=n(r(8156))},1911:function(e,t,r){var n;"undefined"!=typeof self&&self,n=e=>(()=>{"use strict";var t={8156:t=>{t.exports=e}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.r(s),n.d(s,{default:()=>i});var e,t=n(8156),r=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}const i=(0,t.forwardRef)((function(n,s){var i=n.title,a=n.titleId,c=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(n,r);return t.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:s,"aria-labelledby":a},c),i?t.createElement("title",{id:a},i):null,e||(e=t.createElement("path",{d:"M13.455 12 20 18.545 18.545 20 12 13.455 5.455 20 4 18.545 10.545 12 4 5.455 5.455 4 12 10.545 18.545 4 20 5.455z",fill:"#6F787E",fillRule:"nonzero"})))}))})(),s})(),e.exports=n(r(8156))},3435:t=>{"use strict";t.exports=e},5416:e=>{"use strict";e.exports=t},3939:e=>{"use strict";e.exports=r},9763:e=>{"use strict";e.exports=n},1285:e=>{"use strict";e.exports=s},2171:e=>{"use strict";e.exports=o},8292:e=>{"use strict";e.exports=i},8156:e=>{"use strict";e.exports=a},633:()=>{}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={id:e,loaded:!1,exports:{}},n=!0;try{c[e].call(r.exports,r,r.exports,u),n=!1}finally{n&&delete l[e]}return r.loaded=!0,r.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var r in t)u.o(t,r)&&!u.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},u.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),u.p="https://web-static.scdn.vn/authentication-integration/65be41d9-web/";var d={};return(()=>{"use strict";u.r(d),u.d(d,{default:()=>zn});var e=u(3435),t=u(3939);class r extends t.Service{async parse(e,t){try{return await e.json()}catch(e){return{message:e}}}constructor(...e){var t,r,n;super(...e),n="https://www.sendo.vn",(r="domain")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}const n=r;const s=new t.Fetcher({id:"UpdatePasswordRequestOTP",service:new class extends n{async query(e){return{url:new URL("/bapi/customer/change-password-v2/request-otp",this.domain).href,options:{credentials:"include",method:"POST",body:JSON.stringify(e.payload)}}}}},{success:async function(e){return e},error:async function(e){return{error:e}}}),o=s.export();class i extends t.Service{async query(e){return{url:new URL("/bapi/customer/change-password-v2","https://www.sendo.vn").href,options:{credentials:"include",method:"POST",body:JSON.stringify(e.payload)}}}}const a=new t.Fetcher({id:"UpdatePassword",service:new i},{success:async function(e){return e},error:async function(e){return{error:e}}}),c=a.export();var l=u(8292),h=u(9763),p=u(1285),g=u(9330),f=u(6047),v=u(9070),m=u(5433),y=u(6106),_=u(3700);class w extends _.Z{async query(e){var t;return{url:new URL("/logout/sendoid",this.domain).href,options:{method:"POST",credentials:"include",headers:{Authorization:null!==(t=e.accessToken)&&void 0!==t?t:"","Content-Type":"application/json"}}}}}const b=new t.Fetcher({id:"Logout",service:new w},{success:async function(e){return e},error:async function(e){return{error:e}}}),S=(b.createFetcherHook(),b.export()),x={platform:f.X8.PWA,loginCallback:(e,t)=>null,steps:[f.N8.Welcome],retry:!1},T="Auth",k=(0,t.registerActions)({reducerName:T,initialState:(0,l.Record)(x)(),handlers:{set:(e,t)=>e.merge(t.value),setPlatform:(e,t)=>e.set("platform",t.value),setLoginCallback:(e,t)=>e.set("loginCallback",t.callback),setSteps:(e,t)=>e.set("steps",t.value),setRetry:(e,t)=>e.set("retry",t.value)},thunkers:function(e){return{login:t=>async(r,n,s)=>{const o=n()[T],i=n().PartnerAuth,a=null===i||void 0===i?void 0:i.get("fetched"),c=null===i||void 0===i?void 0:i.get("isReady"),l=null===o||void 0===o?void 0:o.platform,u=null===o||void 0===o?void 0:o.isRetry,d=[f.X8.MBBC2C,f.X8.VNE].includes(l);var v,m,_,w,b,S;if(r(e.setLoginCallback({callback:t.callback})),d&&c)return a||u?void r("Modals","open",{id:g.ee.EMBED_LOGIN}):(r(e.setRetry({value:!0})),r("EmbedAppStorage","set",{key:"EBA_AUTH_RETRY",value:!0}),window.parent.postMessage({type:"SendoExternalLogin"},"*"),null===window||void 0===window||null===(v=window.webkit)||void 0===v||null===(m=v.messageHandlers)||void 0===m||null===(_=m.JSBridge)||void 0===_||null===(w=_.postMessage)||void 0===w||w.call(_,JSON.stringify({type:"SendoExternalLogin"})),void(null===window||void 0===window||null===(b=window.JSBridge)||void 0===b||null===(S=b.postMessage)||void 0===S||S.call(b,JSON.stringify({type:"SendoExternalLogin"}))));if([f.X8.PWA,f.X8.PWAC2C].includes(l))r("Modals","open",{id:g.ee.LOGIN,updateQuery:!0});else if([f.X8.ZMA,f.X8.VTM].includes(l))try{const e=await s.hybrid.kit.getAccessToken();if(!e)return h.Sentry.withScope((function(t){t.setTag("auth","login"),t.setExtra("partnerAccessToken",e),h.Sentry.captureException("[Auth] partnerAccessToken empty")})),void r("Toast","open",{messageType:p.MessageTypes.warning,messageVariant:p.MessageVariants.dark_gray,content:"Kh\xf4ng l\u1ea5y \u0111\u01b0\u1ee3c th\xf4ng tin ng\u01b0\u1eddi d\xf9ng, vui l\xf2ng th\u1eed l\u1ea1i."});r("PartnerAuth","start",{partnerAccessToken:e,platform:l,startFrom:t.startFrom})}catch(e){const t=(0,y.T7)(e);(null===e||void 0===e?void 0:e.code)===f.Qw.UserRejected?h.Sentry.withScope((e=>{e.setTag("auth","login"),e.setExtra("error",t),h.Sentry.captureException("[Auth] user reject to grant permission")})):h.Sentry.withScope((e=>{e.setTag("auth","login"),e.setExtra("error",t),h.Sentry.captureException("[Auth Login Action] hybrid kit get access token catch error.")})),r("Toast","open",{messageType:p.MessageTypes.warning,messageVariant:p.MessageVariants.dark_gray,content:"Kh\xf4ng l\u1ea5y \u0111\u01b0\u1ee3c th\xf4ng tin ng\u01b0\u1eddi d\xf9ng, vui l\xf2ng th\u1eed l\u1ea1i."})}},executeLoginCallback:t=>(t,r,n)=>{var s;const o=null===(s=r()[T])||void 0===s?void 0:s.loginCallback;"function"===typeof o&&(o(t,r),setTimeout((()=>{t(e.setLoginCallback({callback:x.loginCallback}))})))},requireLogin:t=>(r,n)=>{const s=n().User;(null===s||void 0===s?void 0:s.get("logged"))?"function"===typeof t.callback&&t.callback(r,n):r(e.login({callback:t.callback}))},logout:e=>async(r,n)=>{var s,o,i,a;const c=null!==(a=null===(s=n().User)||void 0===s||null===(o=s.details)||void 0===o||null===(i=o.metadata)||void 0===i?void 0:i.token)&&void 0!==a?a:"",l=(0,t.bindActionCreators)(S.actions,r);try{var u,d;const t=await l.request({accessToken:c});var p,f,m;if((null===t||void 0===t||null===(u=t.value)||void 0===u||null===(d=u.status)||void 0===d?void 0:d.code)===g.qP)"function"===typeof(null===e||void 0===e?void 0:e.callback)?null===e||void 0===e||e.callback({isSuccess:!0}):window.location.replace("https://www.sendo.vn");else null===e||void 0===e||null===(p=e.callback)||void 0===p||p.call(e,{isSuccess:!1,message:null!==(m=null===(f=t.status)||void 0===f?void 0:f.message)&&void 0!==m?m:v.cl})}catch(t){var y;null===e||void 0===e||null===(y=e.callback)||void 0===y||y.call(e,{isSuccess:!1,message:v.cl}),h.Sentry.withScope((function(e){e.setTag("auth","logout"),e.setExtra("message",`Error: ${JSON.stringify(t)}`),h.Sentry.captureException("[Auth] Logout error.")}))}},loginFPTIdCallback:e=>async(t,r)=>{const n=await m.Z.loginCallback(e.isRedirect);console.log({user:n})},updatePassword:()=>async e=>{e("Modals","open",{id:g.ee.UPDATE_PASSWORD})},verifyPhone:()=>async e=>{e("Modals","open",{id:g.ee.VERIFY_PHONE})}}}});class E extends _.Z{async query(e){return{url:new URL("/account/exist",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e)}}}}const O=new t.Fetcher({id:"CheckAccountExist",service:new E},{success:async function(e){return e},error:async function(e){return{error:e}}}).export();var C=u(2131);class P extends _.Z{async query(e){return{url:new URL("/register/valid-unique",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e)}}}}const j=new t.Fetcher({id:"CheckUniqueId",service:new P},{success:async function(e){return e},error:async function(e){return{error:e}}}),A=j.createGetterHook(),I=j.export();class N extends t.Service{async query(e){const{payload:t}=e;return{url:new URL("/api/v1/zalo/user-info","https://grocery.sendo.vn").href,options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:t.partnerAccessToken,code:t.code}),timeout:1e4}}}}const R=new t.Fetcher({id:"ZaloUserInfo",service:new N},{success:async function(e,t){return e.data.number||h.Sentry.withScope((r=>{r.setTag("auth","zalo-user-info-empty"),r.setExtra("response",JSON.stringify(e)),r.setExtra("payload",JSON.stringify(t.payload)),h.Sentry.captureException("[Auth] Get phone response empty.")})),e.data},error:async function(e,t){return"RequestTimedout"===e.name&&h.Sentry.withScope((function(e){e.setTag("auth","zalo-user-info-fetch-timeout"),e.setExtra("message",`Payload: ${JSON.stringify(t)}`),h.Sentry.captureException("[Auth] Zalo user info fetch timeout.")})),{error:e}}}).export();class M extends _.Z{async query(e){return{url:new URL("/login/request-otp/v2",this.domain).href,options:{method:"POST",body:JSON.stringify(e.payload)}}}}const B=new t.Fetcher({id:"LoginRequestOTP",service:new M},{success:async function(e){return e},error:async function(e){return{error:e}}}),L=B.createGetterHook(),U=B.export();class q extends _.Z{async query(e){const t=new URL("/login/sendoid",this.domain),r={...e.payload,version:1};return{url:t.href,options:{method:"POST",credentials:"include",body:JSON.stringify(r)}}}}const D=new t.Fetcher({id:"LoginSendoId",service:new q},{success:async function(e){return e},error:async function(e){return{error:e}}}).export();var V=u(3212);class F extends _.Z{async query(e){return{url:new URL("/login/social/verify-otp",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload),timeout:5e3}}}}const W=new t.Fetcher({id:"LoginSocialVerifyOTP",service:new F},{success:async function(e){return e},error:async function(e,t){return{error:e}}}).export();class G extends _.Z{async query(e){return{url:new URL("/login/social/verify-phone",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify({send_to:"phone",...e.payload}),timeout:5e3}}}}const H=new t.Fetcher({id:"LoginSocialVerifyPhone",service:new G},{success:async function(e){return e},error:async function(e,t){return{error:e}}}),z=H.createGetterHook(),$=H.export();class Z extends _.Z{async query(e,t){var r,n;const s=null===(r=t.getState())||void 0===r?void 0:r.EmbedAppStorage,o=new URL("/login/token/verify",this.domain),i={};var a;((null===s||void 0===s?void 0:s.get("EBA_PARTNER_ACCESS_TOKEN"))||(null===(n=e.payload)||void 0===n?void 0:n.partnerToken))&&(i.Authorization=(null===s||void 0===s?void 0:s.get("EBA_PARTNER_ACCESS_TOKEN"))||(null===(a=e.payload)||void 0===a?void 0:a.partnerToken));return{url:o.href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload),timeout:5e3,headers:i}}}}const J=new t.Fetcher({id:"LoginVerify",service:new Z},{success:async function(e,t,r){var n,s,o,i,a;const{dispatch:c}=t,l=null===(n=r.getState())||void 0===n?void 0:n.User,u=(null===(s=r.getState())||void 0===s?void 0:s.EmbedAppStorage)||{},d=r.getState().PartnerAuth,h=r.getExtraArguments().cookies;var p;const g=null!==(p=null===(o=h.get("EBA_USER_SESSION"))||void 0===o?void 0:o.loginToken)&&void 0!==p?p:u.getIn(["EBA_USER_SESSION","loginToken"]);var f;const v=null!==(f=h.get("EBA_LOGIN_TOKEN"))&&void 0!==f?f:u.get("EBA_LOGIN_TOKEN"),m=(null===(i=h.get("EBA_USER_SESSION"))||void 0===i?void 0:i.extraData)||u.getIn(["EBA_USER_SESSION","extraData"]),y=d.get("extraData")||h.get("EBA_AUTH_EXTRA_DATA")||u.getIn(["EBA_AUTH_EXTRA_DATA"]);var _;(null===(a=e.result.data)||void 0===a?void 0:a.token)&&(v===g&&((null===m||void 0===m?void 0:m.user_id)||"")===((null===y||void 0===y?void 0:y.user_id)||"")||c("EmbedAppStorage","set",{key:"EBA_USER_SESSION",value:{loginToken:v,details:{metadata:l.getIn(["details","metadata"])},extraData:{...m,...y}}}),c("User","set",{value:{fetched:!0,loginVerified:!0,logged:!0,details:{...l.getIn(["details"]),metadata:{...l.getIn(["details","metadata"]),embedAppAccessToken:null===(_=e.result.data)||void 0===_?void 0:_.token}}}}));return e},error:async function(e,t){const{dispatch:r}=t;return r("User","set",{value:{fetched:!0,loginVerified:!0,logged:!1}}),{error:e}}}).export();class X extends _.Z{async query(e){return{url:new URL("/login/otp",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload)}}}}const K=new t.Fetcher({id:"LoginVerifyOTP",service:new X},{success:async function(e){return e},error:async function(e){return{error:e}}}),Q=K.export();var Y=u(4089);class ee extends _.Z{async query(e){return{url:new URL("/account/new-account-info",this.domain).href,options:{method:"PUT",credentials:"include",body:JSON.stringify(e.payload)}}}}const te=new t.Fetcher({id:"NewAccountInfo",service:new ee},{success:async function(e){return e},error:async function(e){return{error:e}}}).export();var re=u(360),ne=u.n(re),se=u(2171);const oe=(0,se.setConstants)({code:-1404,userDenyRequestPermission:-202,userDenied:-2002,accessTokenInvalid:-1401});class ie extends _.Z{async query(e){return{url:new URL("/register/social",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload)}}}}const ae=new t.Fetcher({id:"RegisterSocial",service:new ie},{success:async function(e){return e},error:async function(e){return{error:e}}}).export();class ce extends _.Z{async query(e){return{url:new URL("/register/social/request-otp",this.domain).href,options:{method:"POST",body:JSON.stringify(e.payload)}}}}const le=new t.Fetcher({id:"RegisterSocialRequestOTP",service:new ce},{success:async function(e){return e},error:async function(e){return{error:e}}}),ue=le.export();class de extends _.Z{async query(e,t){var r;const n=null===(r=t.getState())||void 0===r?void 0:r.EmbedAppStorage,s=new URL("/logout/social",this.domain),o={"Content-Type":"application/json"};return(null===n||void 0===n?void 0:n.get("EBA_PARTNER_ACCESS_TOKEN"))&&(o.Authorization=null===n||void 0===n?void 0:n.get("EBA_PARTNER_ACCESS_TOKEN")),{url:s.href,options:{method:"POST",credentials:"include",headers:o,body:JSON.stringify({...e,flag_cookie:!0})}}}}const he=new t.Fetcher({id:"SocialLogout",service:new de},{success:async function(e){return e},error:async function(e){return{error:e}}}),pe=he.export(),ge="PartnerAuth",fe={fetched:!1,data:{},uiState:{isShowOtpForm:!1,errorMessage:null,otpErrorMessage:"",isOtpError:!1,otpDisabled:!1,isShowUpdateApp:!1,isIgnoreVerifyOTPOnZMA:!1,isIgnoreSharePhoneNumber:!1},extraData:{},isReady:!1,callback:(e,t,r)=>{console.log("Login success")}},ve=(0,t.registerActions)({reducerName:ge,initialState:(0,l.Map)(fe),handlers:{set:(e,t)=>e.set(t.key,t.value),reset:(e,t)=>(0,l.Map)(fe),remove:(e,t)=>e.delete(t.key),setDisableOtp:(e,t)=>e.setIn(["uiState","otpDisabled"],t.payload),toggleOtpForm:(e,t)=>e.setIn(["uiState","isShowOtpForm"],!e.getIn(["uiState","isShowOtpForm"])).set("callback",t.callback).set("data",t.data),setErrorMessage:(e,t)=>e.setIn(["uiState","errorMessage"],t.message),setIsOtpError:(e,t)=>e.setIn(["uiState","isOtpError"],t.payload),setOtpErrorMessage:(e,t)=>e.setIn(["uiState","otpErrorMessage"],t.message),toggleUpdateApp:(e,t)=>e.setIn(["uiState","isShowUpdateApp"],!e.getIn(["uiState","isShowUpdateApp"])),setIsIgnoreVerifyOTPOnZMA:(e,t)=>e.setIn(["uiState","isIgnoreVerifyOTPOnZMA"],t.payload),setConfirmRequestPhoneNumberData:(e,t)=>e.setIn(["uiState","confirmRequestPhoneNumber"],t.payload),setExtraData:(e,t)=>e.set("extraData",t.value),setIsReady:(e,t)=>e.set("isReady",t.value),setIsIgnoreSharePhoneNumber:(e,t)=>e.setIn(["uiState","isIgnoreSharePhoneNumber"],t.payload)},thunkers:e=>({verifyOtp:function(r){return async function(n,s,o){var i,a,c;const{otp:l,platform:u}=r,d=s().Auth.loginCallback,p=s()[ge];var f;const{partnerAccessToken:m,phone:_}=null!==(f=null===p||void 0===p?void 0:p.get("data"))&&void 0!==f?f:{};e.registerSocial=(0,t.bindActionCreators)(ae.actions,n);const w=await se.Quick.run((async function(){try{var t;return null!==(t=(await e.registerSocial.request({payload:{auth_code:m,source:g.QD[u],provider:g.oq[u],otp:l,phone:_,is_link_senpay:!0}})).value)&&void 0!==t?t:{}}catch(e){return{status:{code:9999,message:v.cl}}}}));var b,S,x;if((null===(i=w.status)||void 0===i?void 0:i.code)!==g.qP)return n(e.setOtpErrorMessage({message:null!==(x=null===(b=w.status)||void 0===b?void 0:b.message)&&void 0!==x?x:v.cl})),n(e.setIsOtpError({payload:!0})),setTimeout((()=>{n(e.setIsOtpError({payload:!1}))}),2e3),void(1002006===(null===(S=w.status)||void 0===S?void 0:S.code)&&n(e.setDisableOtp({payload:!0})));n(e.toggleOtpForm()),n("User","set",{value:{details:{data:null===(a=w.result)||void 0===a?void 0:a.data,metadata:null===(c=w.result)||void 0===c?void 0:c.metaData},logged:!0,fetched:!0}});try{null===d||void 0===d||d(n,s)}catch(e){console.log(`[Login] Execute callback with error (VerifyOTP). Error ${null===e||void 0===e?void 0:e.toString()}`);const t=(0,y.T7)(e);h.Sentry.withScope((function(e){e.setTag("login","callback"),e.setExtra("error",t),h.Sentry.captureException("[Login] Execute callback with error (VerifyOTP).")}))}}},requestPhoneNumber:function(t){return async function(r,n,s){const{debug:o,isIgnoreConfirmRequestPhoneNumber:i=!1,partnerAccessToken:a,platform:c,startFrom:l}=t.payload,u=c===f.X8.VTM||i;u||r("Modals","open",{id:"RequestPhoneNumber"});const d=u||await new Promise(((t,n)=>{r(e.setConfirmRequestPhoneNumberData({payload:{onOk:()=>{t(!0)},onCancel:()=>{t(!1)}}}))}));if(i||r(e.setConfirmRequestPhoneNumberData({payload:{}})),!d)return l===f.pH.Page&&r(e.setIsIgnoreSharePhoneNumber({payload:!0})),void h.Sentry.withScope((e=>{e.setTag("auth","reject-share-phone-number"),h.Sentry.captureException("[Auth] Reject share phone number.")}));const g=await se.Quick.run((async function(){try{var t,r;const o=await(null===(t=s.hybrid.kit)||void 0===t||null===(r=t.getPhoneNumber)||void 0===r?void 0:r.call(t));if(!o.number&&c===f.X8.ZMA){var n;return null!==(n=(await e.getZaloUserInfo.request({payload:{partnerAccessToken:a,code:null===o||void 0===o?void 0:o.token}})).value)&&void 0!==n?n:{}}return o}catch(e){return h.Sentry.withScope((t=>{const r=(0,y.T7)(e);t.setTag("auth","hybrid-get-phone-number"),t.setExtra("error",r),t.setExtra("partnerAccessToken",a+"..."),h.Sentry.captureException("[Auth] get phone number catch error.")})),console.log({error:e}),e}}));if(g.code===oe.code)return r("User","set",{value:{fetched:!0,error:{message:`Fail to get phone number (${oe.code}). Result: ${JSON.stringify(g)}`}}}),r(e.toggleUpdateApp()),void h.Sentry.withScope((function(e){e.setTag("login","hybrid-sdk"),h.Sentry.captureException(`app platform ${c} is outdate`)}));if(!g.number){if(r("User","set",{value:{fetched:!0,error:{message:`Fail to get phone number. Result: ${JSON.stringify(g)}`}}}),o&&r(e.setErrorMessage({message:`${v.fI}. Result: ${JSON.stringify(g)}`})),[oe.userDenied,oe.userDenyRequestPermission].includes(g.code))return void r("Modals","open",{id:"RequestPermission"});{let e=a;var m,_;if(g.code===oe.accessTokenInvalid)e=await(null===(m=s.hybrid.kit)||void 0===m||null===(_=m.getAccessToken)||void 0===_?void 0:_.call(m));r("Toast","open",{title:v.Yt.TITLE,content:" ",messageVariant:p.MessageVariants.dark_gray,messageType:p.MessageTypes.info,timeout:5e3,action:{variant:p.ButtonVariants.invert,text:v.Yt.ACTION_BUTTON_LABEL,click:()=>{r("Toast","close"),r("PartnerAuth","start",{platform:c,partnerAccessToken:e,isIgnoreConfirmRequestPhoneNumber:!0})}}})}return r(e.setIsIgnoreVerifyOTPOnZMA({payload:!0})),void h.Sentry.withScope((function(e){e.setTag("login","hybrid-sdk"),e.setExtra("message",`Result: ${JSON.stringify(g)}`),h.Sentry.captureException("Fail to get phone number.")}))}return g.number}},start:function(r){return async function(n,s,o){var i,a,c,l,u;const{debug:d,isAutoAuthentication:m,isIgnoreConfirmRequestPhoneNumber:_,partnerAccessToken:w,platform:b,requireAuth:S=!0,startFrom:x}=r,T=ne()(null===(i=s()[ge])||void 0===i?void 0:i.get("extraData"),["auth_code"]),k=s().Auth,E=null===k||void 0===k?void 0:k.loginCallback,O=[f.X8.MBBC2C,f.X8.VNE].includes(b),C=b===f.X8.VTM;if(O&&!S)return void n("PartnerAuth","verify",{platform:b,shouldCheckStatus:!0});if(e.loginSocial=(0,t.bindActionCreators)(V.Z.actions,n),e.registerSocialRequestOTP=(0,t.bindActionCreators)(ue.actions,n),e.getZaloUserInfo=(0,t.bindActionCreators)(R.actions,n),!w)return n(e.setErrorMessage({message:v.h6})),n("User","set",{value:{fetched:!0,error:{message:`Fail to get platform ${b} access token. Result: ${JSON.stringify(w)}`}}}),d&&n(e.setErrorMessage({message:`Fail to get platform ${b} access token. Result: ${JSON.stringify(w)}`})),void h.Sentry.withScope((function(e){e.setTag("login","hybrid-sdk"),e.setExtra("message",`Result: ${JSON.stringify(w)}`),h.Sentry.captureException(`Fail to get platform ${b} access token`)}));const P={auth_code:w,source:g.QD[b],provider:g.oq[b],flag_cookie:O||C,extra_data:T},j=await se.Quick.run((async function(){try{var t;return null!==(t=(await e.loginSocial.request({payload:P})).value)&&void 0!==t?t:{}}catch(e){return{status:{code:9999,message:e}}}}));if(n(e.set({key:"fetched",value:!0})),(null===(a=j.status)||void 0===a?void 0:a.code)!==g.qP){var A,I,N,M,B,L;if(n("User","set",{value:{fetched:!0,error:{message:`Fail to /login/social. Body: ${JSON.stringify(P)} Result: ${JSON.stringify(j)}`}}}),d)n(e.setErrorMessage({message:`${null!==(M=null===(N=j.status)||void 0===N?void 0:N.message)&&void 0!==M?M:v.cl}. Token is: ${w}`}));if(g.YF.includes(null===(A=j.status)||void 0===A?void 0:A.code))n(e.setErrorMessage({message:null!==(L=null===(B=j.status)||void 0===B?void 0:B.message)&&void 0!==L?L:v.cl}));return O&&(null===k||void 0===k?void 0:k.retry)&&g.ve.includes(+(null===(I=j.status)||void 0===I?void 0:I.code))&&n("Modals","open",{id:g.ee.EMBED_LOGIN}),void h.Sentry.withScope((function(e){e.setTag("login","request-api-false"),e.setExtra("message",` Body: ${JSON.stringify(P).replace("auth_code","dummy_sentry")} Result: ${JSON.stringify(j)}`),h.Sentry.captureException("Fail to /login/social.")}))}if(!(null===(c=j.result)||void 0===c||null===(l=c.data)||void 0===l?void 0:l.is_new_account)){var U,q,D,F,W,G;if(n("User","set",{value:{fetched:!O,logged:!O,details:{data:null===(U=j.result)||void 0===U?void 0:U.data,metadata:null===(q=j.result)||void 0===q?void 0:q.metaData}}}),O)n("EmbedAppStorage","set",{key:"EBA_PARTNER_ACCESS_TOKEN",value:null===(D=j.result)||void 0===D||null===(F=D.metaData)||void 0===F?void 0:F.partner_token}),n("PartnerAuth","verify",{platform:b}),(null===k||void 0===k?void 0:k.retry)&&!(null===(W=j.result)||void 0===W||null===(G=W.data)||void 0===G?void 0:G.phone_verified)&&n("Modals","open",{id:g.ee.EMBED_LOGIN});else try{null===E||void 0===E||E(n,s)}catch(e){const t=(0,y.T7)(e);h.Sentry.withScope((function(e){e.setTag("login","callback"),e.setExtra("error",t),h.Sentry.captureException("[Login] Execute callback with error (Login).")}))}return}if(m)return void n("User","set",{value:{fetched:!0,error:{message:`This account is not link with ${b} account.`}}});const H=await n(e.requestPhoneNumber({payload:{partnerAccessToken:w,platform:b,debug:d,isIgnoreConfirmRequestPhoneNumber:_,startFrom:x}}));if(!H)return;const z={auth_code:w,phone:(0,y.gi)(H),source:g.QD[b]},$=await se.Quick.run((async function(){try{const r=await e.registerSocialRequestOTP.request({payload:z});var t;return null!==(t=await r.value)&&void 0!==t?t:{}}catch(e){return{status:{code:9999,message:e}}}}));var Z,J,X,K;(null===(u=$.status)||void 0===u?void 0:u.code)===g.qP?n(e.toggleOtpForm({data:{partnerAccessToken:w,phone:(0,y.gi)(H)}})):(n("User","set",{value:{fetched:!0,error:{message:`Fail to request /register/zalo/request-otp. Result: ${JSON.stringify({otpRequestBody:z,requestOtpResult:$})}`}}}),n("Toast","open",{content:null!==(J=null===(Z=$.status)||void 0===Z?void 0:Z.message)&&void 0!==J?J:v.cl,messageVariant:p.MessageVariants.dark_gray,messageType:p.MessageTypes.info,timeout:5e3}),n(e.setIsIgnoreVerifyOTPOnZMA({payload:!0})),d&&n(e.setErrorMessage({message:`Request Otp Error: ${null!==(K=null===(X=$.status)||void 0===X?void 0:X.message)&&void 0!==K?K:v.cl}. Body: ${JSON.stringify(z)}`})),h.Sentry.withScope((function(e){var t,r;e.setTag("login","request-api-false"),e.setExtra("message",`Body: ${JSON.stringify(z).replace("auth_code","dummy_sentry")}`),h.Sentry.captureException(`Request Otp Error: ${null!==(r=null===(t=$.status)||void 0===t?void 0:t.message)&&void 0!==r?r:v.cl}.`)})))}},verify:function(r){return async function(n,s,o){var i,a,c,l;const{platform:u,shouldCheckStatus:d}=r,h=[f.X8.MBBC2C,f.X8.VNE].includes(u),p=s().User,v=s().Auth.loginCallback;if(!h)return;if(n(e.set({key:"fetched",value:!0})),p.loginVerified)return;e.loginVerify=(0,t.bindActionCreators)(J.actions,n),e.loginStatus=(0,t.bindActionCreators)(C.Z.actions,n),e.mergeCarts=(0,t.bindActionCreators)(Y.Z.actions,n);const m={source:g.QD[u],provider:g.oq[u]},y=await se.Quick.run((async function(){try{var t;return null!==(t=(await e.loginVerify.request({payload:m})).value)&&void 0!==t?t:{}}catch(e){return{status:{code:9999,message:e}}}}));(null===y||void 0===y||null===(i=y.result)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.token)&&!d&&(await se.Quick.run((async()=>{await e.mergeCarts.request()})),null===v||void 0===v||v(n,s)),(null===y||void 0===y||null===(c=y.result)||void 0===c||null===(l=c.data)||void 0===l?void 0:l.token)&&d&&await se.Quick.run((async()=>{var t,r;const o=await e.loginStatus.request({platform:g.oq[u]});return await e.mergeCarts.request(),(null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.customer_id)&&(null===v||void 0===v||v(n,s)),!!(null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.customer_id)}))}},cancel:function(t){return function(r,n,s){const{key:o,value:i}=t;r(e.set({key:o,value:i})),setTimeout((()=>{r(e.remove({key:o}))}),1500)}},logout:e=>async(r,n)=>{var s,o;const i=null===(s=n().Auth)||void 0===s||null===(o=s.get)||void 0===o?void 0:o.call(s,"platform"),a=(0,t.bindActionCreators)(pe.actions,r);try{var c,l;const t=await a.request({source:g.QD[i],provider:g.oq[i]});var u,d,h;if((null===t||void 0===t||null===(c=t.value)||void 0===c||null===(l=c.status)||void 0===l?void 0:l.code)===g.qP)"function"===typeof(null===e||void 0===e?void 0:e.callback)&&(null===e||void 0===e||e.callback({isSuccess:!0}));else null===e||void 0===e||null===(u=e.callback)||void 0===u||u.call(e,{isSuccess:!1,message:null!==(h=null===(d=t.status)||void 0===d?void 0:d.message)&&void 0!==h?h:v.cl})}catch(t){var p;null===e||void 0===e||null===(p=e.callback)||void 0===p||p.call(e,{isSuccess:!1,message:v.cl})}}})});class me extends _.Z{async query(e){return{url:new URL("/register/v4",this.domain).href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload)}}}}const ye=new t.Fetcher({id:"RegisterAccount",service:new me},{success:async function(e){return e},error:async function(e){return{error:e}}}).export(),_e=(0,t.registerActions)({reducerName:"ScriptLoaded",initialState:(0,l.Map)({google:!1,facebook:!1}),handlers:{set:(e,t)=>{const{script:r}=t;return e.set(r,!0)}}}),we={logged:!1,fetched:!1,loginVerified:!1,termsAgree:!1,details:void 0,error:void 0},be=(0,t.registerActions)({reducerName:"User",initialState:(0,l.Record)(we)(),handlers:{set:(e,t)=>e.merge(t.value),delete:(e,t)=>e.delete(t.key),setLogged:(e,t)=>e.set("logged",t.value),setLoginVerified:(e,t)=>e.set("loginVerified",t.value),setTermsAgree:(e,t)=>e.set("termsAgree",t.value),setDetails:(e,t)=>e.set("details",t.value),mergeInDataDetails:(e,t)=>e.mergeIn(["details","data"],t.value),setFetched:(e,t)=>e.set("fetched",t.value),setError:(e,t)=>e.set("error",t.error),updateEmbedAppAccessToken:(e,t)=>{try{var r,n;if(e.hasIn(["details","metadata"]))return e.setIn(["details","metadata","embedAppAccessToken"],t.token);const s=(null===(r=e.get("details"))||void 0===r||null===(n=r.toJS)||void 0===n?void 0:n.call(r))||{};return e.set("details",{...s,metadata:{...(null===s||void 0===s?void 0:s.metadata)||{},embedAppAccessToken:t.token}})}catch(t){return e}},reset:()=>(0,l.fromJS)(we)}});const Se=new t.Fetcher({id:"VerifyPhone",service:new class extends n{async query(e){return{url:new URL("/bapi/customer/verify-phone-number","https://www.sendo.vn").href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload)}}}}},{success:async function(e){return e},error:async function(e){return{error:e}}}).export(),xe={checkStatusFetch:C.Z,loginSendoIdFetch:D,checkUniqueIdFetch:I,userActions:be,mergeCartsFetch:Y.Z,checkAccountExistFetch:O,registerAccountFetch:ye,newAccountInfoFetch:te,loginRequestOTPFetch:U,loginVerifyOTPFetch:Q,verifyPhoneOTPFetch:Se,scriptLoadedActions:_e,loginSocialFetch:V.Z,loginSocialVerifyPhoneFetch:$,loginSocialVerifyOtpFetch:W,loginVerifyFetch:J,registerSocialFetch:ae,registerSocialRequestOtpFetch:ue,partnerAuthActions:ve,authActions:k,zaloUserInfoFetch:R,updatePasswordRequestOTPFetch:o,updatePasswordFetch:c};var Te=u(8024),ke=u(8156),Ee=u(6505),Oe=u.n(Ee),Ce=u(3230),Pe=u.n(Ce);const je=u(229).Z,Ae=e=>{let{isNewSocialUser:t,onBack:r,onChangeForm:n,onChangeUserLoginType:s,onChangeUsername:o,onClose:i,phoneNumber:a}=e;const c=(0,ke.useCallback)((()=>{o(a),n(f.N8.ForgotPassword,f.WT.SignInWithSMS),s(f.N1.Phone)}),[a,o,n,s]),l=(0,ke.useCallback)((()=>{t?r():i()}),[t,r,i]);return(0,Te.jsx)(je,{isNewSocialUser:t,phoneNumber:a,onLoginByOTP:c,onVerifyLater:l})};var Ie=u(7888),Ne=u.n(Ie);const Re=async()=>await(0,se.importScriptOnce)("//www.google.com/recaptcha/api.js?hl=vi&onload=onloadCallback&render=explicit","recaptcha-jssdk",{defer:!0,async:!0}),Me=e=>{const[t,r]=(0,ke.useState)(!1),[n,s]=(0,ke.useState)(),o=(0,ke.useRef)(-1),i=(0,ke.useRef)(),a=(0,ke.useCallback)((e=>{s(e),"function"===typeof i.current&&i.current(e)}),[]),c=(0,ke.useCallback)((()=>{s(void 0)}),[]),l=(0,ke.useCallback)((()=>{window.grecaptcha&&(grecaptcha.reset(o.current),c())}),[c]),u=(0,ke.useCallback)((()=>{window.grecaptcha&&(o.current=grecaptcha.render(e,{sitekey:"6LeljSETAAAAABsRgJkNwIbTDn0-dv115DdwcNU7",callback:a,"expired-callback":l}))}),[e,a,l]),d=(0,ke.useCallback)((e=>{i.current=e}),[]),h=(0,ke.useCallback)((()=>{r(!1),s(void 0)}),[]);return(0,ke.useEffect)((()=>(t&&(window.grecaptcha?u():(window.onloadCallback=u,setTimeout((()=>{Re()}),300))),()=>{delete window.onloadCallback})),[t,u,l]),{isShowCaptcha:t,recaptchaResponse:n,setIsShowCaptcha:r,onResetRecaptcha:l,setRecaptchaVerifiedCallback:d,setRecaptchaResponse:s,onHideRecaptcha:h}};function Be(e){let{confirmPassword:r,isReceiverOTPByEmail:n,onChangeForm:s,onHideRecaptcha:i,onResetRecaptcha:a,otp:l,password:u,setErrorMessage:d,setInitTimeResendOTPCountDown:h,setIsShowCaptcha:m,setIsSubmitting:y}=e;const _=(0,t.useDispatch)(),w=(0,t.useActions)(o.actions),b=(0,t.useActions)(c.actions);return{requestOTP:(0,ke.useCallback)((async e=>{y(!0),null===i||void 0===i||i();try{var t,r;const i=await w.request({payload:{send_to:"phone","g-recaptcha-response":e}});var n,o;if((null===(t=i.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)d(null!==(o=null===(n=i.value.status)||void 0===n?void 0:n.message)&&void 0!==o?o:v.cl),a();else d(""),null===s||void 0===s||s(f.N8.VerifyOTP)}catch(e){d(v.cl)}finally{y(!1)}}),[s]),resendOTP:(0,ke.useCallback)((async e=>{y(!0);try{var t,r;const i=await w.request({payload:{"g-recaptcha-response":e,send_to:n?"email":"phone"}});var s,o;if((null===(t=i.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)d(null!==(o=null===(s=i.value.status)||void 0===s?void 0:s.message)&&void 0!==o?o:v.cl),a();else d(""),null===h||void 0===h||h(Date.now()),m(!1)}catch(e){d(v.cl),a()}finally{y(!1)}}),[n]),updatePassword:(0,ke.useCallback)((async()=>{y(!0);try{var e,t;const i=await b.request({payload:{otp:l,password:u,confirm_password:r,send_to:n?"email":"phone"}});var s,o;if((null===(e=i.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)d(null!==(o=null===(s=i.value.status)||void 0===s?void 0:s.message)&&void 0!==o?o:v.cl);else d(""),_("Modals","close",{id:g.ee.UPDATE_PASSWORD}),_("Toast","show",{messageType:p.MessageTypes.success,content:"\u0110\u1ed5i m\u1eadt kh\u1ea9u th\xe0nh c\xf4ng"})}catch(e){d(v.cl)}finally{y(!1)}}),[n,l,u,r])}}const Le=e=>10===e.length&&Number(e)===Number(e.substring(1));var Ue,qe=u(9399),De=u.n(qe),Ve=u(3650),Fe=u.n(Ve),We=u(9869),Ge=u.n(We),He=u(6427),ze=u.n(He);class $e extends t.Service{async query(e,t){const{strict:r,token:n}=e,s=new URL("bapi/customer/term-condition/active","https://www.sendo.vn"),o={};return n&&(o.authorization=n),{url:s.href,options:{credentials:r?"include":"omit",headers:o}}}}const{controlCreator:Ze,lookupInlineRequests:Je,useBaseQueryHook:Xe}=t.Explorer.createBaseQueryModel({service:new $e,getComputedPair:e=>({id:"TermsAndConditions",keyed:`${null!==(Ue=e.userId)&&void 0!==Ue?Ue:"_"}`,props:ze()(e,Ge())}),callbacks:{success:async(e,t,r)=>se.Converter.object.toCamelCase(Fe()(e,["result"])||{}),error:async(e,t,r)=>({error:e})}}),Ke=()=>{const e=(0,t.useSelector)({userFetched:["User","fetched"],accessToken:["User","details","metadata","token"],userId:["User","details","data","customer_id"]}),r=null===e||void 0===e?void 0:e.get("userFetched"),n=null===e||void 0===e?void 0:e.get("accessToken"),s=null===e||void 0===e?void 0:e.get("userId");return(0,ke.useMemo)((()=>({userFetched:r,accessToken:n,userId:s})),[r,n,s])};const Qe=function(e){let{strict:t}=e;const r=Ke(),{control:n,current:s,previous:o}=Xe({type:"inherit",refreshOnClient:"always",props:{token:r.accessToken,userId:r.userId,strict:!!t},skip:!!t&&!r.userFetched});return(0,ke.useMemo)((()=>({control:n,current:s,previous:o})),[n,s,o])},Ye=e=>{let{strict:t}=e;const{current:r}=Qe({strict:t});return(0,ke.useMemo)((()=>{const e=Fe()(r,["value","data"]);return{data:null!==e&&void 0!==e?e:{}}}),[r])};class et extends t.Service{async query(e,t){const{tcId:r,token:n}=e,{hybrid:s}=t.getExtraArguments(),o="zma"===s.agent.platform?"zma":"wap",i=new URL("bapi/customer/update-decree","https://www.sendo.vn"),a={"Content-Type":"application/json"};return n&&(a.authorization=n),{url:i.href,options:{method:"POST",credentials:"include",headers:a,body:JSON.stringify({tc_id:r,platform:o})}}}}const{useMutationActionsHook:tt,useMutationHook:rt}=t.Explorer.createMutationModel({service:new et,getComputedPair:e=>({id:"AgreeTAndC",props:ze()(e,Ge()),keyed:`${e.tcId}-${e.timeStamp}`}),callbacks:{success:async(e,t,r)=>(r.dispatch("User","setTermsAgree",{value:!0}),se.Converter.object.toCamelCase(e)),error:async e=>({error:e})}}),nt="_9fe3-F9IjOZ";function st(e){let{callback:r,checkBoxText:n,closePopup:s,strict:o,tcId:i}=e;const[a,c]=(0,ke.useState)(!1),[l,u]=(0,ke.useState)(""),{accessToken:d}=Ke(),{control:h,current:g}=rt({type:"isolated"}),f=(0,t.useDispatch)();return(0,ke.useEffect)((()=>{if(!o)return;if(200===Fe()(g.value,["status","code"]))s(),null===r||void 0===r||r(!0);else{const e=Fe()(g.value,["status","message"]);f("Toast","open",{title:"",content:e,messageType:"error",messageVariant:"dark-gray"})}}),[g,o]),(0,Te.jsxs)(Te.Fragment,{children:[(0,Te.jsxs)(p.Box,{pt:3,mb:4,component:p.Grid,container:!0,direction:"column",children:[(0,Te.jsx)(p.Checkbox,{value:"",checked:a,name:"agreeCheckbox",onChange:e=>{const{checked:t}=e.target;c(t),t&&u("")},children:(0,Te.jsx)(p.Box,{dangerouslySetInnerHTML:{__html:n}})}),(0,Te.jsx)(p.Box,{mt:2,component:p.Typography,type:"error",variant:"caption",className:nt,children:l})]}),(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.primary,onClick:()=>{a?o?"fetching"!==g.status&&h.setCurrentProps({tcId:i,token:d,timeStamp:(new Date).getTime()}):(null===r||void 0===r||r(),s()):u("Vui l\xf2ng ch\u1ecdn v\xe0o \xf4 \u0111\u1ec3 x\xe1c nh\u1eadn")},size:p.ButtonSizes.lg,children:"\u0110\u1ed3ng \xfd v\xe0 ti\u1ebfp t\u1ee5c"})]})}const ot=(0,ke.memo)(st),it="_9fe3-_bLXuS",at="_9fe3-TOTmTx",ct="_9fe3-OmyCrr",lt="_9fe3-AOur_v",ut="_9fe3-G3YHu0",dt="_9fe3-xSJpC9";const ht=function(e){const{callback:r,closePopupCallback:n,strict:s}=e,[o,i]=(0,ke.useState)(!1),a=(0,ke.useRef)(),c=(0,t.useSelector)("User"),{data:l}=Ye({strict:!!s}),u=null===c||void 0===c?void 0:c.get("termsAgree");(0,ke.useEffect)((()=>{De()(l)||a.current||u||i(!0)}),[l,u]);const d=(0,ke.useCallback)((()=>{i(!1),null===n||void 0===n||n()}),[n]);return(0,ke.useMemo)((()=>{const{checkBoxText:e,content:t,tcId:n,title:i}=null!==l&&void 0!==l?l:{};return(0,Te.jsx)("div",{className:it,children:(0,Te.jsxs)(p.Dialog,{isOpen:o,lg:5,onClose:s?void 0:d,className:at,usePortal:!1,children:[(0,Te.jsx)(p.DialogHeader,{className:ct,onClose:s?void 0:d,children:(0,Te.jsx)(p.Typography,{variant:"body1",weight:"bold",children:i})}),(0,Te.jsx)(p.DialogBody,{className:lt,children:(0,Te.jsx)(p.Box,{p:2,component:p.Paper,radius:"bold",className:ut,dangerouslySetInnerHTML:{__html:t}})}),(0,Te.jsx)(p.DialogFooter,{className:dt,children:(0,Te.jsx)(ot,{tcId:n,checkBoxText:e,strict:!!s,callback:e=>{a.current=e,null===r||void 0===r||r()},closePopup:d})})]})})}),[o,s,d,r])},pt="_9fe3-WOrAII",gt="_9fe3-AwA7H0",ft="_9fe3-DQIqEs",vt=e=>{let{authFollow:r,isNewSocialUser:n,onChangeForm:s,onChangePhoneNumber:o,phoneNumber:i}=e;const[a,c]=(0,ke.useState)(""),[l,u]=(0,ke.useState)(!1),[d,h]=(0,ke.useState)(!1),m=(0,t.useActions)(O.actions),y=(0,t.useActions)(Se.actions),_=(0,t.useActions)(I.actions),{isShowCaptcha:w,onHideRecaptcha:b,onResetRecaptcha:S,recaptchaResponse:x,setIsShowCaptcha:T}=Me(g.u$.REQUEST_OTP),k=r===f.WT.VerifyOTPUpdatePassword,E=r===f.WT.VerifyPhone,{requestOTP:C}=Be({setErrorMessage:c,setIsSubmitting:u,setIsShowCaptcha:T,onResetRecaptcha:S,onHideRecaptcha:b,onChangeForm:s}),P=(0,ke.useCallback)((e=>{o(e.currentTarget.value),c("")}),[o]),j=(0,ke.useCallback)((()=>{h(!1),T(!0)}),[T]),A=(0,ke.useCallback)((()=>{h(!1)}),[]),N=(0,ke.useCallback)((async e=>{if(e.preventDefault(),Le(i))if(E)T(!0);else{u(!0);try{var t,r;const e=await m.request({username:i});if((null===(t=e.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP){var n,o;c(null!==(o=null===(n=e.value.status)||void 0===n?void 0:n.message)&&void 0!==o?o:v.cl)}else{var a,l;const t=null!==(l=null===(a=e.value.result)||void 0===a?void 0:a.data)&&void 0!==l?l:{};c(""),t.is_exist?s(f.N8.PhoneRegisteredWaning):h(!0)}}catch(e){c(v.cl)}finally{u(!1)}}else c(v.Md.PHONE_INVALID_MESSAGE)}),[i,E,s,m]),R=(0,ke.useCallback)((async e=>{u(!0),c(""),b();try{var t,r;const u=await _.request({username:i,"g-recaptcha-response":e}),d=null===(t=u.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code;if(d!==g.qP){var n,o;c(null!==(o=null===(n=u.value.status)||void 0===n?void 0:n.message)&&void 0!==o?o:v.cl),d===g.Gi.WRONG_CAPTCHA&&S()}else{var a,l;const e=null!==(l=null===(a=u.value.result)||void 0===a?void 0:a.data)&&void 0!==l?l:{};c(""),1===e.receive_otp&&s(f.N8.VerifyOTP)}}catch(e){c(v.cl)}finally{u(!1)}}),[i,_,s,S,b]),M=(0,ke.useCallback)((async e=>{u(!0),b();try{var t,r;const l=await y.request({payload:{phone:i,"g-recaptcha-response":e}});var n,a;if((null===(t=l.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)c(null!==(a=null===(n=l.value.status)||void 0===n?void 0:n.message)&&void 0!==a?a:v.cl),S();else c(""),s(f.N8.VerifyOTP),o(i)}catch(e){c(v.cl)}finally{u(!1)}}),[i,y,s,S,b,o]),B=(0,ke.useCallback)((e=>{r!==f.WT.VerifyOTPUpdatePassword?n?R(e):M(e):C(e)}),[r,n,M,R,C]);return(0,ke.useEffect)((()=>{x&&B(x)}),[x,B]),(0,ke.useEffect)((()=>()=>{b()}),[b]),(0,ke.useEffect)((()=>{k&&T(!0)}),[T,k]),(0,Te.jsx)(p.Grid,{item:!0,container:!0,xs:!0,direction:"column",children:(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:v.Md.TITLE}),(0,Te.jsxs)("form",{onSubmit:N,children:[(0,Te.jsx)(p.Box,{mt:5,children:(0,Te.jsx)(p.TextField,{label:"",name:"phoneNumber",inputMode:"numeric",status:a?p.InputStatuses.error:p.InputStatuses.primary,value:i,readOnly:l,disabled:k,placeholder:v.Md.INPUT_PLACEHOLDER,note:a,autoFocus:!0,onChange:P})}),w&&(0,Te.jsx)(p.Box,{mt:4,mb:6,className:gt,children:(0,Te.jsx)("div",{id:g.u$.REQUEST_OTP})}),d&&(0,Te.jsx)(ht,{callback:j,strict:!1,closePopupCallback:A}),!k&&(0,Te.jsx)(p.Box,{mt:4,children:(0,Te.jsxs)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.primary,disabled:!i,loading:l,children:[v.Md.SUBMIT_BUTTON_LABEL,(0,Te.jsx)(p.Icon,{component:Ne(),className:(0,p.classnames)(pt,{[ft]:l})})]})})]})]})})},mt=e=>{const t=(0,ke.useRef)();return(0,ke.useEffect)((()=>{t.current=e}),[e]),t.current},yt="_9fe3-AqGgq6",_t="_9fe3-Huao91",wt="_9fe3-rWd3St",bt="_9fe3-R_WlOe",St=e=>{let{createdAt:t=0,message:r,onClose:n,shouldVisible:s,type:o=p.MessageTypes.error}=e;const[i,a]=(0,ke.useState)(!0),c=t>0||s,l=mt(t);return(0,ke.useEffect)((()=>{t!==l&&t>0&&a(!0),setTimeout((()=>{a(!1)}),300)}),[t,l]),(0,Te.jsx)(p.Box,{className:(0,p.classnames)(_t,{[wt]:c,[bt]:i}),children:(0,Te.jsx)(p.Message,{variant:p.MessageVariants.light,type:o,onClose:n,children:(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,className:yt,dangerouslySetInnerHTML:{__html:r}})})})},xt="_9fe3-JH6vkz",Tt=e=>{let{currentForm:r,onChangeForm:n,onChangePhoneNumber:s,onChangeUsername:o,onSetOTPInformMessage:i,onSetOTPSendType:a,onSetOTPToken:c,otpToken:l,userLoginType:u,username:d}=e;const[h,m]=(0,ke.useState)(""),y=(0,t.useActions)(U.actions),{isShowCaptcha:_,onHideRecaptcha:w,onResetRecaptcha:b,recaptchaResponse:S,setIsShowCaptcha:x}=Me(g.u$.FORGOT_PASSWORD),T=r===f.N8.LoginBySMS,k=r===f.N8.RequestTrustDeviceOTP,E=(0,ke.useCallback)((e=>{o(e.currentTarget.value),m("")}),[o]),O=(0,ke.useCallback)((async e=>{m("");try{var t,r;const w=await y.request({payload:{username:d,source:g.Yp,"g-recaptcha-response":e,login_hash:l}});if((null===(t=w.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP){var o,h;m(null!==(h=null===(o=w.value.status)||void 0===o?void 0:o.message)&&void 0!==h?h:v.cl),b()}else{var p;if(m(""),u!==f.N1.Phone||k){var _;const e=null===(_=w.value.result.data)||void 0===_?void 0:_.send_to;k?(i(`${v.oO.SUB_TITLE.PHONE} ${e}`),a(f.A6.Phone)):s(e)}else s(d);c(null===(p=w.value.result.data)||void 0===p?void 0:p.login_token),n(f.N8.VerifyOTP)}}catch(e){m(v.cl),b()}}),[y,d,l,b,u,k,n,s,a,i,c]);return(0,ke.useEffect)((()=>(x(!0),()=>{w()})),[x,w]),(0,ke.useEffect)((()=>{S&&O(S)}),[S,O]),(0,Te.jsx)(p.Grid,{item:!0,container:!0,xs:!0,direction:"column",children:(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:v.Lv.TITLE}),(0,Te.jsxs)(p.Box,{mt:5,children:[k&&!!h&&(0,Te.jsx)(St,{type:p.MessageTypes.error,message:h,createdAt:Date.now()}),!k&&(0,Te.jsx)(p.TextField,{label:"",name:"username",inputMode:"numeric",autoFocus:T,status:h?p.InputStatuses.error:p.InputStatuses.primary,note:h,value:d,disabled:!T,onChange:E})]}),_&&(0,Te.jsx)(p.Box,{mt:6,className:xt,children:(0,Te.jsx)("div",{id:g.u$.FORGOT_PASSWORD})})]})})};var kt=u(8818),Et=u.n(kt),Ot=u(9735),Ct=u.n(Ot);const Pt=function(e){let{content:t,type:r}=e;const[n,s]=(0,ke.useState)({createdAt:Date.now(),content:t,type:r}),o=(0,ke.useCallback)((e=>{s({...n,...e})}),[n]);return{sectionMessage:n,onSetSectionMessage:o}},jt="_9fe3-GiDjgo",At="_9fe3-CpvlfP",It="_9fe3-VPbED5",Nt="_9fe3-_T0aeR",Rt=e=>{let{onChangeForm:r,onChangePhoneNumber:n,onSetOTPInformMessage:s,onSetOTPSendType:o,onSetOTPToken:i,userLoginType:a,username:c}=e;const[l,u]=(0,ke.useState)(!0),{onSetSectionMessage:d,sectionMessage:h}=Pt({content:v.A5.INFO_MESSAGE,type:p.MessageTypes.info}),[m,y]=(0,ke.useState)({isError:!1,message:""}),[_,w]=(0,ke.useState)(""),[b,S]=(0,ke.useState)(!1),x=(0,t.useSelector)("Auth"),T=(0,t.useActions)(D.actions),k=(0,t.useActions)(C.Z.actions),E=(0,t.useActions)(Y.Z.actions),O=x.get("platform"),{isShowCaptcha:P,onResetRecaptcha:j,recaptchaResponse:A,setIsShowCaptcha:I}=Me(g.u$.SIGN_IN),N=(0,ke.useCallback)((()=>{r(f.N8.ForgotPassword,f.WT.ForgotPassword)}),[r]),R=(0,ke.useCallback)((()=>{u(!l)}),[l]),M=(0,ke.useCallback)((e=>{y({isError:!0,message:""}),d({createdAt:Date.now(),content:e,type:p.MessageTypes.error})}),[d]),B=(0,ke.useCallback)((()=>{d({createdAt:0})}),[d]),L=(0,ke.useCallback)((e=>{w(e.currentTarget.value),y({isError:!1,message:""})}),[]),U=(0,ke.useCallback)((()=>!((null===_||void 0===_?void 0:_.length)<g.D8)||(y({isError:!0,message:v.A5.PASSWORD_INVALID_MESSAGE}),!1)),[_]),q=(0,ke.useCallback)((async e=>{if(U()){S(!0);try{var t;const w=await T.request({payload:ze()({username:c,password:_,source:g.g5[O],"g-recaptcha-response":e},Ge())}),b=null===(t=w.value)||void 0===t?void 0:t.status,S=null===b||void 0===b?void 0:b.code;if(S!==g.qP){var l,u;if(S===g.rT.NOT_TRUST_DEVICE){var d,h,p;const e=null!==(p=null===(d=w.value)||void 0===d||null===(h=d.result)||void 0===h?void 0:h.metaData)&&void 0!==p?p:{};return i(e.login_hash),s(null===b||void 0===b?void 0:b.message),a===f.N1.Phone&&n(c),void((null===e||void 0===e?void 0:e.receive_otp)===g.sE.SUCCEED?(o(null===e||void 0===e?void 0:e.send_type),r(f.N8.VerifyOTP,f.WT.VerifyTrustDevice)):r(f.N8.RequestTrustDeviceOTP,f.WT.VerifyTrustDevice))}M(null!==(u=null===(l=w.value.status)||void 0===l?void 0:l.message)&&void 0!==u?u:v.cl),S===g.rT.SHOW_CAPTCHA&&(P?j():I(!0))}else{var m,y;const e=await k.request();(null===(m=e.value)||void 0===m||null===(y=m.data)||void 0===y?void 0:y.phone_verified)||(a===f.N1.Phone&&n(c),r(f.N8.RequestOTP,f.WT.VerifyPhone)),await E.request()}}catch(e){M(v.cl)}finally{S(!1)}}}),[O,U,T,c,_,M,i,s,a,n,o,r,P,j,I,k,E]),V=(0,ke.useCallback)((async e=>{e.preventDefault(),_&&!b&&q()}),[b,_,q]);return(0,ke.useEffect)((()=>{A&&q(A)}),[A,q]),(0,Te.jsxs)(p.Grid,{item:!0,container:!0,xs:!0,direction:"column",children:[(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:v.A5.TITLE}),h.content&&(0,Te.jsx)(p.Box,{mt:4,children:h.content&&(0,Te.jsx)(St,{type:h.type,message:h.content,createdAt:h.createdAt,onClose:B})}),(0,Te.jsxs)("form",{noValidate:!0,onSubmit:V,children:[(0,Te.jsxs)(p.Box,{mt:5,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body1,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:c}),(0,Te.jsx)("input",{value:c,type:"email",name:"username",autoComplete:"off",hidden:!0}),(0,Te.jsx)(p.TextField,{label:"",name:"password",status:m.isError?p.InputStatuses.error:p.InputStatuses.primary,value:_,className:jt,type:l?"password":"text",placeholder:v.A5.INPUT_PLACEHOLDER,afterInput:(0,Te.jsx)(p.InputAdornment,{onClick:R,children:(0,Te.jsx)(p.Icon,{component:l?Et():Ct()})}),readOnly:b,autoFocus:!0,note:m.message,onChange:L}),(0,Te.jsx)(p.Box,{mt:3,className:At,children:(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.caption,type:p.TypoTypes.link,weight:p.TypoWeights.bold,className:It,onClick:N,children:v.A5.FORGOT_PASSWORD_LABEL})}),P&&(0,Te.jsx)(p.Box,{mt:4,className:Nt,children:(0,Te.jsx)("div",{id:g.u$.SIGN_IN})})]}),(0,Te.jsx)("button",{type:"submit",hidden:!0})]})]}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.primary,disabled:!_,loading:b,onClick:V,children:v.A5.SUBMIT_BUTTON_LABEL})})]})},Mt=()=>(0,t.useSelector)("User");var Bt=u(1836),Lt=u.n(Bt);const Ut="_9fe3-VcF308",qt="_9fe3-ah7BkI",Dt="_9fe3-WilpbZ",Vt="_9fe3-TNwPqM",Ft=e=>{let{formData:t,formErrorMessage:r,isHidePassword:n,isSubmitting:s,onChangeBirthday:o,onChangeFormData:i,onSubmit:a}=e;const c=(0,ke.useRef)(null),l=(0,ke.useMemo)((()=>{const e=new Date;return(0,y.p6)(e)}),[]),u=(0,ke.useMemo)((()=>{if(!t.birthday)return"";const e=new Date(t.birthday);return(0,y.p6)(e,!0)}),[t.birthday]),d=(0,ke.useCallback)((()=>{var e,t;"function"===typeof(null===(e=c.current)||void 0===e?void 0:e.showPicker)?c.current.showPicker():null===(t=c.current)||void 0===t||t.focus()}),[]),h=(0,ke.useCallback)((()=>{o(g.uv)}),[o]);var f;return(0,Te.jsxs)(p.Grid,{item:!0,container:!0,xs:!0,direction:"column",children:[(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:v.LT.TITLE}),(0,Te.jsx)(p.Box,{mt:5,children:(0,Te.jsxs)("form",{onSubmit:a,autoComplete:"off",children:[(0,Te.jsxs)(p.Grid,{container:!0,spacing:4,children:[(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsx)(p.TextField,{name:"gender",component:p.RadioGroup,label:v.LT.GENDER_LABEL,note:r.gender,required:!0,selected:t.gender,status:r.gender?p.InputStatuses.error:p.InputStatuses.primary,className:Ut,onChange:i,children:(0,Te.jsx)(p.Grid,{container:!0,justifyContent:"space-between",children:v.lQ.map((e=>(0,Te.jsx)(p.Grid,{item:!0,xs:!0,children:(0,Te.jsx)(p.Radio,{value:`${e.value}`,children:e.label})},e.value)))})})}),(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsx)(p.TextField,{name:"fullname",label:v.LT.FULL_NAME_INPUT_LABEL,placeholder:v.LT.FULL_NAME_INPUT_PLACEHOLDER,value:t.fullname,status:r.fullname?p.InputStatuses.error:p.InputStatuses.primary,note:r.fullname,size:p.InputSizes.md,autoFocus:!0,autocomplete:"new-fullname",required:!0,onChange:i})}),!n&&(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsx)(p.TextField,{name:"password",type:"password",label:v.LT.PASSWORD_INPUT_LABEL,placeholder:v.LT.PASSWORD_INPUT_PLACEHOLDER,value:t.password,size:p.InputSizes.md,status:r.password?p.InputStatuses.error:p.InputStatuses.primary,note:r.password,autocomplete:"new-password",required:!0,onChange:i})}),(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsxs)("div",{className:qt,onClick:d,children:[(0,Te.jsx)(p.TextField,{name:"dob_display",label:v.LT.DOB_INPUT_LABEL,value:u,placeholder:v.LT.DOB_INPUT_PLACEHOLDER,size:p.InputSizes.md,readOnly:!0,afterInput:(0,Te.jsx)(p.InputAdornment,{children:(0,Te.jsx)(p.Icon,{component:Lt()})}),className:Dt}),(0,Te.jsx)("input",{ref:c,type:"date",name:"birthday",value:null!==(f=t.birthday)&&void 0!==f?f:g.uv,max:l,className:Vt,onClick:h,onChange:i})]})})]}),(0,Te.jsx)("button",{hidden:!0,type:"submit"})]})})]}),(0,Te.jsx)(p.Grid,{item:!0,container:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.primary,loading:s,onClick:a,children:v.LT.SUBMIT_BUTTON_LABEL})})]})},Wt=e=>{let{authFollow:r,onClose:n}=e;const s=(0,ke.useRef)(!1),[o,i]=(0,ke.useState)({fullname:"",password:"",is_link_senpay:!0,gender:"",birthday:void 0}),[a,c]=(0,ke.useState)(!1),[l,u]=(0,ke.useState)({fullname:"",password:"",gender:""}),d=(0,t.useDispatch)(),h=(0,t.useActions)(C.Z.actions),m=(0,t.useActions)(Y.Z.actions),_=(0,t.useActions)(te.actions),w=Mt(),b=w.get("logged"),S=r===f.WT.SingUpWithSocial,x=(0,ke.useCallback)((e=>{const t=e.currentTarget.name,r="checkbox"===e.currentTarget.type?e.currentTarget.checked:e.currentTarget.value;i({...o,[t]:r}),u((e=>({...e,[t]:""})))}),[o]),T=(0,ke.useCallback)((e=>i((t=>({...t,birthday:e})))),[]),k=(0,ke.useCallback)((()=>{var e,t;const r=null===(e=o.fullname)||void 0===e?void 0:e.trim(),n=null===(t=o.password)||void 0===t?void 0:t.trim(),s={fullname:"",password:"",gender:""};var i;return r?(null===r||void 0===r?void 0:r.length)>g.Lo&&(s.fullname=v.LT.FULL_NAME_MAX_LENGTH_MESSAGE):s.fullname=v.LT.FULL_NAME_INVALID_MESSAGE,!S&&(null!==(i=null===n||void 0===n?void 0:n.length)&&void 0!==i?i:0)<g.ct?s.password=v.LT.PASSWORD_INVALID_MESSAGE:n.length>g.e2&&(s.password=v.LT.PASSWORD_MAX_LENGTH_MESSAGE),o.gender||(s.gender=v.LT.GENDER_REQUIRED_MESSAGE),u(s),!(s.fullname||s.password||s.gender)}),[o,S]),E=(0,ke.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.cl;d("Toast","show",{messageType:p.MessageTypes.error,content:e})}),[d]),O=(0,ke.useCallback)((async e=>{if(e.preventDefault(),k()){c(!0);try{var t,r;const e=o.birthday?Math.floor(new Date(o.birthday).getTime()/1e3):void 0,a=await _.request({payload:{...o,gender:+o.gender,birthday:e}});var s,i;if((null===(t=a.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)E(null!==(i=null===(s=a.value.status)||void 0===s?void 0:s.message)&&void 0!==i?i:v.cl);else h.request(),m.request(),n()}catch(e){E(v.cl)}finally{c(!1)}}}),[o,_,n,k,E,h,m]);return(0,ke.useEffect)((()=>{if(b&&!s.current){s.current=!0;const r=w.getIn(["details","data"]),n=null===r||void 0===r?void 0:r.phone;var e,t;const a=`${null!==(e=null===r||void 0===r?void 0:r.first_name)&&void 0!==e?e:""} ${null!==(t=null===r||void 0===r?void 0:r.last_name)&&void 0!==t?t:""}`.trim(),c=null===r||void 0===r?void 0:r.gender,l=null===r||void 0===r?void 0:r.should_update_dob,u=null===r||void 0===r?void 0:r.birthday;i({...o,fullname:n!==a?a:"",gender:c!==g.D3?null===c||void 0===c?void 0:c.toString():"",birthday:l?void 0:(0,y.p6)(new Date(1e3*u))})}}),[o,b,w]),(0,Te.jsx)(Ft,{formData:o,formErrorMessage:l,isSubmitting:a,isHidePassword:S,onChangeFormData:x,onSubmit:O,onChangeBirthday:T})};const Gt=new t.Fetcher({id:"UpdatePhone",service:new class extends n{async query(e){return{url:new URL("/bapi/customer/update-phone","https://www.sendo.vn").href,options:{method:"POST",credentials:"include",body:JSON.stringify(e.payload)}}}}},{success:async function(e){return e},error:async function(e){return{error:e}}}).export(),Ht="_9fe3-O74597",zt=e=>{let{autoFocus:t,className:r,focus:n,readOnly:s,status:o,...i}=e;const a=(0,ke.useRef)(null),c=mt(!!n);return(0,ke.useLayoutEffect)((()=>{a.current&&(n&&t&&a.current.focus(),n&&t&&n!==c&&(a.current.focus(),a.current.select()))}),[t,n,c]),(0,Te.jsx)(p.Input,{ref:a,className:(0,p.classnames)(Ht,r),inputMode:"numeric",status:o,...i})},$t=(0,ke.memo)(zt),Zt="_9fe3-xrHtKD",Jt=e=>{let{autoFocus:t,disabled:r=!1,inputClassName:n,isNumberInput:s=!0,length:o=6,note:i,onChangeOTP:a,otp:c,readOnly:l,status:u,...d}=e;const[h,g]=(0,ke.useState)(0),[f,v]=(0,ke.useState)(Array(o).fill("")),m=(0,ke.useCallback)((e=>{const t=e.join("");a(t)}),[a]),y=(0,ke.useCallback)((e=>{const t=e;return s?/^[0-9]{1,6}$/.test(t)?t:"":t}),[s]),_=(0,ke.useCallback)((e=>{const t=[...f];t[h]=e[0]||"",v(t),m(t)}),[h,m,f]),w=(0,ke.useCallback)((e=>{const t=Math.max(Math.min(o-1,e),0);g(t)}),[o]),b=(0,ke.useCallback)((()=>{w(h-1)}),[h,w]),S=(0,ke.useCallback)((()=>{w(h+1)}),[h,w]),x=(0,ke.useCallback)((e=>()=>{w(e)}),[w]),T=e=>{const t=y(e.currentTarget.value);if(t)if(t.length>1){e.preventDefault();const r=t.split("");let n=0;const s=[...f];s.forEach(((e,t)=>{if(t>=h){var o;const i=y(null!==(o=r.shift())&&void 0!==o?o:e);i&&(s[t]=i,n=t)}})),v(s),m(s),g(Math.min(n+1,o-1))}else _(t),S();else e.preventDefault()},k=(0,ke.useCallback)((()=>{g(-1)}),[]),E=(0,ke.useCallback)((e=>{switch(e.key){case"Backspace":case"Delete":e.preventDefault(),f[h]?_(""):b();break;case"ArrowLeft":e.preventDefault(),b();break;case"ArrowRight":e.preventDefault(),S();break;case" ":e.preventDefault()}}),[h,_,S,b,f]);return(0,ke.useEffect)((()=>{if(c!==f.join("")&&0===c.length){var e;const t=null!==(e=null===c||void 0===c?void 0:c.split(""))&&void 0!==e?e:[];v(t),g(0)}}),[c,f]),(0,Te.jsxs)(p.Grid,{container:!0,spacing:2,children:[(0,Te.jsx)(p.Grid,{item:!0,container:!0,spacing:4,...d,children:Array(o).fill("").map(((e,s)=>{const o=""===f[s-1],i=""===f[s],a=h!==s&&o&&i&&0!==s;var c;const d=null!==(c=f[s])&&void 0!==c?c:"";return(0,Te.jsx)(p.Grid,{item:!0,xs:!0,children:(0,Te.jsx)($t,{focus:h===s,value:d,autoFocus:t,disabled:r||a,className:n,status:u,readOnly:l,onFocus:x(s),onChange:T,onKeyDown:E,onBlur:k,autoComplete:0===s?"one-time-code":"off"})},`input-${s}`)}))}),i&&(0,Te.jsx)(p.Grid,{item:!0,className:Zt,children:(0,Te.jsx)(p.Typography,{type:p.TypoTypes.error,children:i})})]})},Xt=e=>{let{disabled:t=!1,initTime:r,onClick:n}=e;const[s,o]=(0,ke.useState)(0),i=(0,ke.useRef)(),a=(0,ke.useMemo)((()=>s>0?v.oO.RESEND_OTP_LATER_LABEL.replace("{number}",s.toString()):v.oO.RESEND_OTP_BUTTON_LABEL),[s]);return(0,ke.useEffect)((()=>(s>0&&(i.current=setTimeout((()=>o(s-1)),1e3)),()=>{i.current&&clearTimeout(i.current)})),[s]),(0,ke.useEffect)((()=>{o(g.LW)}),[r]),(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.ghost,disabled:t||s>0,onClick:n,children:a})},Kt="_9fe3-Wg29oR",Qt="_9fe3-TkhrMH",Yt="_9fe3-biBWgR",er="_9fe3-tGW4Wp",tr=e=>{let{authFollow:r=f.WT.VerifyPhone,confirmPassword:n,isAcceptLinkSenPay:s,isNewSocialUser:o,isVerifiedEmail:i,isVerifiedPhone:a,onBack:c,onChangeForm:l,onChangePhoneNumber:u,onGoWelcomeScreen:d,onSetOTPToken:h,otpInformMessage:m,otpSendType:y,otpToken:_,password:w,phoneNumber:b,reference:S,socialAuthCode:x,socialProvider:T,userLoginType:k,username:E}=e;const[O,P]=(0,ke.useState)(""),[j,A]=(0,ke.useState)(Date.now()),[N,R]=(0,ke.useState)(!1),[M,B]=(0,ke.useState)(""),[L,q]=(0,ke.useState)(!1),D=(0,t.useSelector)("Auth"),V=(0,t.useActions)(ye.actions),F=(0,t.useActions)(ae.actions),W=(0,t.useActions)(I.actions),G=(0,t.useActions)(U.actions),H=(0,t.useActions)(Q.actions),z=(0,t.useActions)(C.Z.actions),$=(0,t.useActions)(Y.Z.actions),Z=(0,t.useActions)(Se.actions),J=(0,t.useActions)(Gt.actions),X=S===f.N8.ForgotPassword,K=S===f.N8.LoginBySMS,ee=S===f.N8.RequestOTP,te=k===f.N1.Email&&!b,re=r===f.WT.VerifyTrustDevice,ne=y===f.A6.Notification,se=r===f.WT.VerifyOTPUpdatePassword,oe=D.get("platform"),{isShowCaptcha:ie,onResetRecaptcha:ce,recaptchaResponse:le,setIsShowCaptcha:ue}=Me(g.u$.VERIFY_OTP),{resendOTP:de,updatePassword:he}=Be({otp:O,password:w,confirmPassword:n,isReceiverOTPByEmail:L,setErrorMessage:B,setInitTimeResendOTPCountDown:A,setIsSubmitting:R,setIsShowCaptcha:ue,onResetRecaptcha:ce}),{sectionMessage:pe}=Pt({content:m,type:p.MessageTypes.info}),ge=(0,ke.useMemo)((()=>L&&r===f.WT.VerifyOTPUpdatePassword?v.oO.SUB_TITLE.EMAIL:b?v.oO.SUB_TITLE.PHONE:v.oO.SUB_TITLE.EMAIL),[b,r,L]),fe=(0,ke.useMemo)((()=>L&&r===f.WT.VerifyOTPUpdatePassword?E:b||E),[r,b,E,L]),ve=(0,ke.useMemo)((()=>{return re?ne?v.oO.WRONG_RECEIVER_OTP.TRUST_DEVICE:void 0:(null!==(e=te&&i)&&void 0!==e?e:!b)?v.oO.WRONG_RECEIVER_OTP.EMAIL:a?void 0:v.oO.WRONG_RECEIVER_OTP.PHONE_NUMBER;var e}),[te,ne,re,b,i]),me=(0,ke.useMemo)((()=>re?ne?v.oO.ANOTHER_RECEIVE_OTP:void 0:k===f.N1.Email&&b&&i||se&&i?v.oO.RECEIVE_EMAIL_OTP:a?void 0:v.oO.EDIT_PHONE_NUMBER),[re,k,b,ne,se,i]),_e=(0,ke.useMemo)((()=>{if(r===f.WT.VerifyOTPUpdatePassword){return E&&!(null===E||void 0===E?void 0:E.includes(g.wk))&&!L}return!0}),[r,E,L]),we=(0,ke.useCallback)((e=>{P(e),B("")}),[]),be=(0,ke.useCallback)((()=>{we(""),ue(!0)}),[ue,we]),xe=(0,ke.useCallback)((async()=>{R(!0);try{var e,t;const s=await V.request({payload:{phone:b,otp:O,otp_token:_,source:g.Yp}});var r,n;if((null===(e=s.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)B(null!==(n=null===(r=s.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl);else B(""),l(f.N8.UpdateUserInfo)}catch(e){B(v.cl)}finally{R(!1)}}),[b,O,_,V,l]),Ee=(0,ke.useCallback)((async e=>{R(!0);try{var t,r;const a=await W.request({username:b,"g-recaptcha-response":e}),c=null===(t=a.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code;if(c!==g.qP){var n,s;B(null!==(s=null===(n=a.value.status)||void 0===n?void 0:n.message)&&void 0!==s?s:v.cl),c===g.Gi.WRONG_CAPTCHA&&ce()}else{var o,i;const e=null!==(i=null===(o=a.value.result)||void 0===o?void 0:o.data)&&void 0!==i?i:{};B(""),1===e.receive_otp&&(A(Date.now()),h(e.otp_token),ue(!1))}}catch(e){B(v.cl)}finally{R(!1)}}),[b,W,ue,ce,h]),Oe=(0,ke.useCallback)((async()=>{R(!0);try{var e,t;const i=await H.request({payload:{loginToken:_,otp:O,source:g.g5[oe]}});if((null===(e=i.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP){var r,n;B(null!==(n=null===(r=i.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl)}else{var s,o;B("");const e=await z.request();(null===(s=e.value)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.phone_verified)||l(f.N8.RequestOTP),await $.request()}}catch(e){B(v.cl)}finally{R(!1)}}),[oe,H,_,O,z,$,l]),Ce=(0,ke.useCallback)((async e=>{R(!0);try{var t,r;const a=k===f.N1.Phone?b:E,c=re?y:L?f.N1.Email:f.N1.Phone,l=await G.request({payload:{username:a,source:g.Yp,"g-recaptcha-response":e,send_to:c,login_hash:_}});var n,s,o,i;if((null===(t=l.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)B(null!==(s=null===(n=l.value.status)||void 0===n?void 0:n.message)&&void 0!==s?s:v.cl),ce();else h(null===(o=l.value.result)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.login_token),B(""),A(Date.now()),ue(!1),L&&u("")}catch(e){B(v.cl),ce()}finally{R(!1)}}),[k,b,E,re,y,L,G,_,ce,h,ue,u]),Pe=(0,ke.useCallback)((async()=>{R(!0);try{var e,t;const o=await J.request({payload:{phone:b,otp:O,is_link_senpay:s}});var r,n;if((null===(e=o.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)B(null!==(n=null===(r=o.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl);else B(""),await z.request()}catch(e){B(v.cl)}finally{R(!1)}}),[b,O,s,J,z]),je=(0,ke.useCallback)((async e=>{R(!0);try{var t,r;const o=await Z.request({payload:{phone:b,"g-recaptcha-response":e}});var n,s;if((null===(t=o.value)||void 0===t||null===(r=t.status)||void 0===r?void 0:r.code)!==g.qP)B(null!==(s=null===(n=o.value.status)||void 0===n?void 0:n.message)&&void 0!==s?s:v.cl),ce();else B(""),A(Date.now()),ue(!1)}catch(e){B(v.cl),ce()}finally{R(!1)}}),[b,Z,ce,ue]),Ae=(0,ke.useCallback)((async()=>{R(!0);try{var e,t;const o=await F.request({payload:{phone:b,auth_code:x,is_link_senpay:s,otp:O,source:g.Yp,provider:T}});var r,n;if((null===(e=o.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)B(null!==(n=null===(r=o.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl);else B(""),await z.request(),await $.request()}catch(e){B(v.cl)}finally{R(!1)}}),[b,O,s,x,T,F,z,$]),Ie=(0,ke.useCallback)((()=>{if(!re||!ne)return se&&i?(q(!0),void be()):void(k===f.N1.Phone&&r!==f.WT.SignInWithSMS||L&&!b?d():r!==f.WT.SignInWithSMS?o?c():(k===f.N1.Email&&b&&i&&(q(!0),be()),b&&r===f.WT.VerifyPhone&&me===v.oO.EDIT_PHONE_NUMBER&&c()):l(f.N8.LoginBySMS));l(f.N8.RequestTrustDeviceOTP)}),[me,se,re,ne,k,r,L,b,o,l,d,c,be]),Ne=(0,ke.useCallback)((()=>{re||X||K?Oe():ee?r===f.WT.VerifyOTPUpdatePassword?he():o?Ae():Pe():xe()}),[re,X,K,ee,Oe,o,Pe,Ae,xe]),Re=(0,ke.useCallback)((e=>{re||X||K?Ce(e):se?de(e):ee&&!o?je(e):Ee(e)}),[re,X,K,ee,o,Ce,je,Ee]);return(0,ke.useEffect)((()=>{O.length===g.cq&&Ne()}),[O,Ne]),(0,ke.useEffect)((()=>{le&&ie&&Re(le)}),[le,ie,Re]),(0,ke.useEffect)((()=>{te&&i&&q(!0)}),[te,i]),(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[re&&(0,Te.jsxs)(Te.Fragment,{children:[pe.content&&(0,Te.jsx)(St,{type:pe.type,message:pe.content,createdAt:pe.createdAt}),(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,className:er,children:v.oO.TITLE[r]})]}),!re&&(0,Te.jsxs)(p.Grid,{container:!0,spacing:3,children:[(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:v.oO.TITLE[r]})}),(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,children:ge})," ",(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,weight:p.TypoWeights.bold,children:fe})]})]}),(0,Te.jsxs)(p.Box,{mt:re?6:5,children:[(0,Te.jsx)(Jt,{length:g.cq,readOnly:N,autoFocus:!0,otp:O,onChangeOTP:we,status:M?p.InputStatuses.error:p.InputStatuses.primary,note:M}),(0,Te.jsx)(p.Box,{className:Yt,children:ie&&(0,Te.jsx)("div",{id:g.u$.VERIFY_OTP})}),(0,Te.jsx)(Xt,{disabled:N||ie,initTime:j,onClick:be}),_e&&(0,Te.jsxs)(p.Box,{className:Kt,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.sub,weight:p.TypoWeights.regular,children:ve})," ",(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.link,weight:p.TypoWeights.bold,className:Qt,onClick:Ie,children:me})]})]})]})},rr=u(8303).Z,nr=e=>{let{onChangeForm:r,onChangePhoneNumber:n,onChangeUserLoginType:s,onChangeUsername:o,onClose:i,onSetIsNewSocialUser:a,onSetOTPToken:c,onSetSocialAuthCode:l,onSetSocialProvider:u,username:d}=e;const[h,p]=(0,ke.useState)(""),[m,y]=(0,ke.useState)(!1),[_,w]=(0,ke.useState)(!1),b=(0,t.useActions)(O.actions),S=(0,t.useActions)(I.actions),{isShowCaptcha:x,onHideRecaptcha:T,onResetRecaptcha:k,recaptchaResponse:E,setIsShowCaptcha:C}=Me(g.u$.WELCOME),P=(0,ke.useCallback)((e=>{o(e.currentTarget.value),p("")}),[o]),j=(0,ke.useCallback)((()=>{o(""),p("")}),[o]),A=(0,ke.useCallback)((async e=>{y(!0),p(""),T();try{var t,o;const h=await S.request({username:d,"g-recaptcha-response":e}),m=null===(t=h.value)||void 0===t||null===(o=t.status)||void 0===o?void 0:o.code;if(m!==g.qP){var i,a;p(null!==(a=null===(i=h.value.status)||void 0===i?void 0:i.message)&&void 0!==a?a:v.cl),m===g.Gi.WRONG_CAPTCHA&&k()}else{var l,u;const e=null!==(u=null===(l=h.value.result)||void 0===l?void 0:l.data)&&void 0!==u?u:{};p(""),1===e.receive_otp&&(n(d),s(e.register_type),c(e.otp_token),r(f.N8.VerifyOTP,f.WT.SignUpWithPhoneNumber))}}catch(e){p(v.cl)}finally{y(!1)}}),[d,S,r,k,T,n,s,c]),N=(0,ke.useCallback)((e=>{const t=!e.includes("@");return!(t&&!Le(e)||!t&&(r=e,!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.toLowerCase())))||(p(v.ev.USERNAME_INVALID_MESSAGE),!1);var r}),[]),R=(0,ke.useCallback)((()=>{w(!1),C(!0)}),[C]),M=(0,ke.useCallback)((()=>{w(!1)}),[C]),B=(0,ke.useCallback)((async e=>{e.preventDefault();if(N(d)){y(!0);try{var t,n;const e=await b.request({username:d});if((null===(t=e.value)||void 0===t||null===(n=t.status)||void 0===n?void 0:n.code)!==g.qP){var o,i;p(null!==(i=null===(o=e.value.status)||void 0===o?void 0:o.message)&&void 0!==i?i:v.cl)}else{var a,c;const t=null!==(c=null===(a=e.value.result)||void 0===a?void 0:a.data)&&void 0!==c?c:{};p(""),t.is_exist?(s(t.username_type),r(f.N8.SignIn)):t.username_type===f.N1.Email?p(v.ev.EMAIL_NOT_EXIST_MESSAGE):w(!0)}}catch(e){p(v.cl)}finally{y(!1)}}}),[d,r,b,s,N]);return(0,ke.useEffect)((()=>{E&&A(E)}),[E,A]),(0,ke.useEffect)((()=>()=>{T()}),[T]),(0,Te.jsxs)(Te.Fragment,{children:[_&&(0,Te.jsx)(ht,{strict:!1,callback:R,closePopupCallback:M}),(0,Te.jsx)(rr,{username:d,inputErrorMessage:h,isSubmitting:m,isShowCaptcha:x,onChangeForm:r,onChangeUsername:P,onClearUsername:j,onSetSocialAuthCode:l,onSetSocialProvider:u,onSetIsNewSocialUser:a,onSubmit:B,onClose:i})]})},sr="_9fe3-oLBeUJ",or="_9fe3-na7Bps",ir="_9fe3-jCRYH2",ar="_9fe3-tDM_Oc",cr="_9fe3-H8nQWY";function lr(e){let{onClose:r}=e;const[n,s]=(0,ke.useState)(""),[o,i]=(0,ke.useState)(""),[a,c]=(0,ke.useState)(!0),[l,u]=(0,ke.useState)(),[d,h]=(0,ke.useState)(),[g,m]=(0,ke.useState)(),[y,_]=(0,ke.useState)(!1),[w,b]=(0,ke.useState)(),[S,x]=(0,ke.useState)(),[T,k]=(0,ke.useState)(),[E,O]=(0,ke.useState)(),C=(0,t.useDispatch)(),P=(0,t.useSelector)("Auth").get("steps"),j=P[P.length-1],A=P[P.length-2],I=j===f.N8.Welcome,N=I,R=j===f.N8.UpdateUserInfo,M=j===f.N8.VerifyOTPTrustDevice,B=j===f.N8.RequestOTP,L=(0,ke.useMemo)((()=>B?y?v.bh:v.wK:v.bh),[B,y]),U=(0,ke.useCallback)((()=>{k(void 0),c(!0),h(void 0),u(void 0),m(void 0),_(!1),b(void 0),x(void 0)}),[]),q=(0,ke.useCallback)((()=>{const e=Oe()(P);C("Auth","setSteps",{value:e}),1===e.length&&U()}),[C,P,U]),D=(0,ke.useCallback)(((e,t)=>{C("Auth","setSteps",{value:[...P,e]}),t&&k(t)}),[C,P]),V=(0,ke.useCallback)((()=>{C("Auth","setSteps",{value:[f.N8.Welcome]}),k(void 0)}),[C]);return(0,ke.useEffect)((()=>()=>{V()}),[V]),(0,Te.jsx)(p.Paper,{radius:p.PaperRadius.regular,children:(0,Te.jsx)(p.Box,{className:(0,p.classnames)(sr,{[or]:N}),children:(0,Te.jsxs)(p.Grid,{container:!0,direction:"column",nowrap:!0,className:ir,children:[!I&&(0,Te.jsxs)(p.Grid,{item:!0,xs:"auto",container:!0,justifyContent:"space-between",className:cr,children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:!R&&(null===P||void 0===P?void 0:P.length)>1&&(0,Te.jsx)(p.Icon,{component:Pe(),width:"2.4rem",height:"2.4rem",className:ar,onClick:q})}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:!R&&!M&&(0,Te.jsx)(p.Button,{fullWidth:!1,variant:p.ButtonVariants.ghost,size:p.ButtonSizes.sm,onClick:r,children:L})})]}),I&&(0,Te.jsx)(nr,{username:n,onChangeUsername:s,onChangeForm:D,onChangeUserLoginType:u,onSetSocialAuthCode:h,onSetSocialProvider:m,onSetIsNewSocialUser:_,onSetOTPToken:b,onChangePhoneNumber:i,onClose:r}),j===f.N8.VerifyOTP&&(0,Te.jsx)(tr,{username:n,phoneNumber:o,reference:A,isAcceptLinkSenPay:a,isNewSocialUser:y,socialAuthCode:d,socialProvider:g,userLoginType:l,authFollow:T,otpToken:w,otpInformMessage:S,otpSendType:E,onSetOTPToken:b,onSetOTPInformMessage:x,onSetOTPSendType:O,onChangeForm:D,onGoWelcomeScreen:V,onChangePhoneNumber:i,onBack:q}),j===f.N8.SignIn&&(0,Te.jsx)(Rt,{username:n,userLoginType:l,onChangeForm:D,onChangePhoneNumber:i,onSetOTPInformMessage:x,onSetOTPToken:b,onSetOTPSendType:O}),j===f.N8.UpdateUserInfo&&(0,Te.jsx)(Wt,{authFollow:T,onClose:r}),j===f.N8.RequestOTP&&(0,Te.jsx)(vt,{phoneNumber:o,isNewSocialUser:y,onChangePhoneNumber:i,onChangeForm:D}),j===f.N8.PhoneRegisteredWaning&&(0,Te.jsx)(Ae,{phoneNumber:o,isNewSocialUser:y,onChangeForm:D,onChangeUsername:s,onChangeUserLoginType:u,onBack:q,onClose:r}),[f.N8.ForgotPassword,f.N8.LoginBySMS,f.N8.RequestTrustDeviceOTP].includes(j)&&(0,Te.jsx)(Tt,{username:n,userLoginType:l,otpToken:w,currentForm:j,onSetOTPToken:b,onChangeUsername:s,onChangePhoneNumber:i,onChangeForm:D,onSetOTPInformMessage:x,onSetOTPSendType:O})]})})})}const ur=(0,ke.memo)(lr);const dr=function(t){const r=(0,ke.useMemo)((()=>function(e){return(0,Te.jsx)(ur,{onClose:e.onClose})}),[]);return(0,Te.jsx)(e.Modal,{id:g.ee.LOGIN,closeOutsideClick:!1,xs:12,md:5,lg:4,zIndex:101,children:e=>(0,Te.jsx)(r,{onClose:e.close})})},hr="_9fe3-bIYLKu",pr="_9fe3-ZDkMX3",gr="_9fe3-iQC_Yv",fr="_9fe3-hvNvx4";const vr=function(){const r=(0,e.useHistory)(),n=(0,e.usePage)(),s=(0,t.useDispatch)(),o=(0,t.useSelector)("User"),i=window.top!==window.self,a=!!window.opener,c=!o.get("fetched"),l=o.get("logged"),u=n.query.return_url?decodeURIComponent(n.query.return_url):"",d=(0,ke.useCallback)((e=>{const t={...e,type:g.$n.LOGIN_CALLBACK};i?window.parent.postMessage(t,"*"):a&&window.opener.postMessage(t,"*")}),[i,a]),h=(0,ke.useCallback)((()=>{d({isSuccess:!1}),a?window.close():r.push("/")}),[d,r,a]),f=(0,ke.useCallback)(((e,t)=>{if(u)try{g.Ck.test(new URL(u).hostname)?window.location.replace(u):window.location.replace("https://www.sendo.vn")}catch(e){window.location.replace("https://www.sendo.vn")}else i||a?(d({isSuccess:!0}),a&&window.close()):r.replace("/")}),[d,r,i,u,a]);return(0,ke.useEffect)((()=>{s("Auth","setLoginCallback",{callback:f})}),[s,f]),(0,Te.jsxs)(Te.Fragment,{children:[(0,Te.jsx)(p.Paper,{className:hr,radius:p.PaperRadius.none,children:(0,Te.jsx)(e.Link,{href:"/",children:(0,Te.jsx)(p.Image,{src:g.m2,className:pr,alt:"Sendo"})})}),c||l?(0,Te.jsx)(p.Loading,{type:p.LoadingTypes.page}):(0,Te.jsx)(p.Box,{mt:6,children:(0,Te.jsx)(p.Grid,{container:!0,justifyContent:"space-around",children:(0,Te.jsx)(p.Grid,{item:!0,xs:12,md:5,className:gr,children:(0,Te.jsx)(p.Paper,{elevation:1,radius:p.PaperRadius.bold,className:fr,children:(0,Te.jsx)(ur,{onClose:h})})})})})]})};const mr=function(e){const r=(0,t.useDispatch)(),n=(0,ke.useCallback)((()=>{r("PartnerAuth","toggleUpdateZaloApp")}),[r]),s=(0,ke.useCallback)((()=>{window.location.href="https://zalo.vn/"}),[]);return(0,Te.jsxs)(p.Dialog,{children:[(0,Te.jsx)(p.DialogHeader,{children:(0,Te.jsx)(p.Box,{component:p.Typography,variant:p.TypoVariants.body2,weight:p.TypoWeights.bold,children:"Th\xf4ng b\xe1o"})}),(0,Te.jsx)(p.DialogBody,{children:(0,Te.jsx)(p.Box,{component:p.Typography,variant:p.TypoVariants.body2,children:"B\u1ea1n c\u1ea7n c\u1eadp nh\u1eadt Zalo phi\xean b\u1ea3n m\u1edbi nh\u1ea5t \u0111\u1ec3 ti\u1ebfp t\u1ee5c"})}),(0,Te.jsx)(p.DialogFooter,{component:p.Box,p:4,children:(0,Te.jsxs)(p.Grid,{container:!0,justifyContent:"flex-end",children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",style:{marginRight:"1.2rem"},children:(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.secondary,onClick:n,fullWidth:!1,children:"Hu\u1ef7"})}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.primary,onClick:s,fullWidth:!1,children:"C\u1eadp nh\u1eadt"})})]})})]})};const yr=function(t){const{message:r,onClose:n,onRetry:s}=t,o=(0,e.useHybrid)(),i="mbb"===o.agent.runtime,a=(0,ke.useCallback)((()=>{i&&o.kit.closeApp(),n()}),[o,i,n]);return(0,Te.jsxs)(p.Dialog,{children:[(0,Te.jsx)(p.DialogBody,{children:(0,Te.jsxs)(p.Grid,{container:!0,component:p.Box,p:4,direction:"column",alignItem:"flex-start",children:[(0,Te.jsx)(p.Box,{component:p.Typography,variant:p.TypoVariants.body1,weight:p.TypoWeights.bold,mb:2,children:"C\xf3 l\u1ed7i x\u1ea3y ra!"}),(0,Te.jsx)(p.Box,{component:p.Typography,variant:p.TypoVariants.body2,mb:2,children:r})]})}),(0,Te.jsx)(p.DialogFooter,{component:p.Box,p:2,children:(0,Te.jsxs)(p.Grid,{container:!0,justifyContent:"flex-end",children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",style:{marginRight:"1.2rem"},children:(0,Te.jsx)(p.Button,{variant:i?p.ButtonVariants.primary:p.ButtonVariants.secondary,onClick:a,fullWidth:!1,children:"\u0110\xf3ng"})}),!i&&(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.primary,onClick:s,fullWidth:!1,children:"Th\u1eed l\u1ea1i"})})]})})]})};var _r=u(5416);const wr="_9fe3-p6c53i";const br=function(e){return(0,Te.jsxs)(p.Grid,{container:!0,component:p.Box,py:2,px:4,alignItem:"center",justifyContent:"center",style:{height:"4.8rem",position:"relative",backgroundColor:"#fff",borderBottom:"1px solid #cfd2d4"},children:[(0,Te.jsx)(p.ButtonBase,{className:wr,onClick:e.onClick,children:(0,Te.jsx)(p.Icon,{component:Pe(),style:{color:"#6f787e"}})}),(0,Te.jsx)(p.Typography,{weight:p.TypoWeights.bold,variant:p.TypoVariants.body1,children:"X\xe1c th\u1ef1c t\xe0i kho\u1ea3n"})]})},Sr={container:"_9fe3-DIOqB6","close-button":"_9fe3-W2Wwl8","otp-item-disabled":"_9fe3-nW8Hwp","otp-input-item":"_9fe3-TYCZMu",error:"_9fe3-TfFIvd","resend-button":"_9fe3-xwMCJk",slideUp:"_9fe3-lJjxeB",zoomIn:"_9fe3-Copdw1"},xr=60,Tr=/[0-9]{6}/g;function kr(e){const{onResendDone:r,partnerAccessToken:n,phoneNumber:s,platform:o}=e,[i,a]=(0,ke.useState)(0),[c,l]=(0,ke.useState)(xr),u=(0,ke.useRef)(Date.now()+1e3*xr),d=(0,ke.useRef)(-1),h=(0,t.useActions)(ue.actions),f=(0,ke.useCallback)((async()=>{var e;if(c>0)return;const t=await se.Quick.run((async function(){const e=await h.request({payload:{auth_code:n,phone:s,source:g.QD[o]}});try{var t;return null!==(t=e.value)&&void 0!==t?t:{}}catch(e){return{}}}));var d;(l(xr),u.current=Date.now()+1e3*xr,a(i+1),(null===(e=t.status)||void 0===e?void 0:e.code)!==g.qP)&&_r.SDK.showToast({message:null===(d=t.status)||void 0===d?void 0:d.message});"function"===typeof r&&r()}),[o,i,n,s,r,c,h]);return(0,ke.useEffect)((()=>(d.current=window.setInterval((()=>{const e=Math.round((u.current-Date.now())/1e3);l(e),0===e&&clearInterval(d.current)}),1e3),()=>{d.current>-1&&clearInterval(d.current)})),[i]),(0,Te.jsx)(p.Grid,{container:!0,direction:"column",alignItem:"center",children:(0,Te.jsx)(p.ButtonBase,{onClick:f,disabled:c>0,className:(0,p.classnames)(Sr["resend-button"],c>0&&Sr.disabled),children:(0,Te.jsx)(p.Typography,{type:c>0?p.TypoTypes.disable:p.TypoTypes.default,variant:p.TypoVariants.body2,weight:p.TypoWeights.bold,children:c>0?`G\u1eedi l\u1ea1i m\xe3 sau ${c} gi\xe2y `:"G\u1eedi l\u1ea1i m\xe3"})})})}const Er=function(e){const[r,n]=(0,ke.useState)(""),s=(0,t.useDispatch)(),{partnerAccessToken:o,phoneNumber:i,platform:a}=e,c=(0,t.useSelector)("PartnerAuth");var l;const u=null!==(l=null===c||void 0===c?void 0:c.getIn(["uiState","otpErrorMessage"]))&&void 0!==l?l:"";var d;const h=null!==(d=null===c||void 0===c?void 0:c.getIn(["uiState","otpDisabled"]))&&void 0!==d&&d,g=(0,ke.useCallback)((()=>{s("PartnerAuth","setOtpErrorMessage",{message:""})}),[s]),f=(0,ke.useCallback)((e=>{n(e),g(),e.match(Tr)&&s("PartnerAuth","verifyOtp",{otp:e,platform:a})}),[a,s,g]),v=(0,ke.useCallback)((()=>{s("PartnerAuth","reset"),s("PartnerAuth","setIsIgnoreVerifyOTPOnZMA",{payload:!0})}),[s]),m=(0,ke.useCallback)((()=>{s("PartnerAuth","setDisableOtp",{payload:!1}),s("PartnerAuth","setOtpErrorMessage",{message:""}),s("PartnerAuth","setIsOtpError",{payload:!1}),n("")}),[s]);return(0,Te.jsxs)(p.Backdrop,{children:[(0,Te.jsx)(br,{onClick:v}),(0,Te.jsxs)(p.Grid,{container:!0,direction:"column",alignItem:"center",className:Sr.container,children:[(0,Te.jsx)(p.Box,{component:p.Typography,variant:p.TypoVariants.subtitle1,weight:p.TypoWeights.bold,children:"Nh\u1eadp m\xe3 x\xe1c th\u1ef1c"}),(0,Te.jsxs)(p.Box,{component:p.Typography,variant:p.TypoVariants.caption,type:p.TypoTypes.sub,mt:3,children:["M\xe3 \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn S\u0110T"," ",(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.caption,type:p.TypoTypes.sub,weight:p.TypoWeights.bold,children:i})]}),(0,Te.jsx)(p.Box,{mt:5,px:3,children:(0,Te.jsx)(Jt,{length:6,autoFocus:!0,otp:r,disabled:h,onChangeOTP:f,status:u?p.InputStatuses.error:p.InputStatuses.primary,note:u})}),(0,Te.jsx)(p.Box,{mt:3,children:(0,Te.jsx)(kr,{platform:a,phoneNumber:i,partnerAccessToken:o,onResendDone:m})})]})]})},Or=r=>{let{extra:n={requireAuth:!0},platform:s}=r;const o=(0,t.useDispatch)(),i=(0,e.useHybrid)(),a=Mt(),c=a.getIn(["details","metadata","token"])||a.getIn(["details","metadata","embedAppAccessToken"]),l=(0,t.useSelector)("PartnerAuth"),u=null===l||void 0===l?void 0:l.get("uiState");var d;const g=null!==(d=null===l||void 0===l?void 0:l.get("data"))&&void 0!==d?d:{},v=[f.X8.MBBC2C,f.X8.VNE].includes(s),m=(0,ke.useCallback)((()=>{o("PartnerAuth","setErrorMessage",{message:null})}),[o]),_=(0,ke.useCallback)((async()=>{try{var e,t;const r=await(null===(t=(e=i.kit).getAccessToken)||void 0===t?void 0:t.call(e))||n.currentAccessToken;o("PartnerAuth","setErrorMessage",{message:null}),o("PartnerAuth","start",v?{platform:s,partnerAccessToken:r,requireAuth:n.requireAuth}:{platform:s,partnerAccessToken:r})}catch(e){const t=(0,y.T7)(e);h.Sentry.withScope((r=>{r.setTag("auth","handle-start-partner-login"),r.setExtra("error",t),r.setExtra("errorMessage",null===e||void 0===e?void 0:e.message),h.Sentry.captureException("[Auth] onRetryLogin")}))}}),[i.kit,n.currentAccessToken,n.requireAuth,o,v,s]),w=(0,ke.useCallback)((async()=>{var e,t;if(!s)return;let r="";try{var n,a;r=await(null===(a=(n=i.kit).getAccessToken)||void 0===a?void 0:a.call(n)),r||h.Sentry.withScope((e=>{e.setTag("auth","handle-start-partner-login"),e.setExtra("partnerAccessToken",r),h.Sentry.captureException("[Auth] partnerAccessToken empty when auto login")}))}catch(e){console.log("[DEBUG Auth] - handleStartPartnerLogin Error ",{error:e});const t=(0,y.T7)(e);(null===e||void 0===e?void 0:e.code)===f.Qw.UserRejected?h.Sentry.withScope((e=>{e.setTag("auth","handle-start-partner-login"),e.setExtra("error",t),h.Sentry.captureException("[Auth] user reject to grant permission")})):h.Sentry.withScope((e=>{e.setTag("auth","handle-start-partner-login"),e.setExtra("error",t),h.Sentry.captureException("[Auth Init] hybrid kit get access token catch error.")}))}if(!r)return;const c=await(null===(t=(e=i.kit).getExtraInfo)||void 0===t?void 0:t.call(e));o("PartnerAuth","setExtraData",{value:se.Converter.object.toSnakeCase(c||{})}),o("PartnerAuth","start",{platform:s,partnerAccessToken:r,isAutoAuthentication:!0})}),[s,o,i.kit]),b=(0,ke.useCallback)((async()=>{var e,t;if(!s)return;if(n.sessionChecking)return;const r=await(null===(t=(e=i.kit).getAccessToken)||void 0===t?void 0:t.call(e))||n.currentAccessToken;r?o("PartnerAuth","start",{platform:s,partnerAccessToken:r,isAutoAuthentication:!0,requireAuth:n.requireAuth}):o("User","setFetched",{value:!0})}),[s,i,n.sessionChecking,n.currentAccessToken]);return(0,ke.useEffect)((()=>{c||v||w()}),[c,w]),(0,ke.useEffect)((()=>{v&&b()}),[b]),(0,Te.jsxs)(p.Box,{children:[u.errorMessage&&(0,Te.jsx)(yr,{message:u.errorMessage,onClose:m,onRetry:_}),u.isShowOtpForm&&(0,Te.jsx)(Er,{platform:s,phoneNumber:g.phone,partnerAccessToken:g.partnerAccessToken}),u.isShowUpdateApp&&(0,Te.jsx)(mr,{onClose:m,onRetry:_})]})},Cr=(0,ke.memo)(Or),Pr=()=>{const e=(0,t.useDispatch)(),r=(0,C.y)(),n=(0,ke.useCallback)((()=>{if(r.get("is")(t.FetchStates.SUCCESSED)){r.getIn(["value","data","customer_id"])&&e("User","set",{value:{details:r.getIn(["value"]),logged:!0}}),r.getIn(["value","data","phone_verified"])&&(e("Modals","close",{id:g.ee.LOGIN}),e("Auth","executeLoginCallback"))}else r.get("is")(t.FetchStates.ERROR)&&(e("User","setError",{error:r.getIn(["value","error"])}),e("User","setFetched",{value:!0}))}),[r,e]);return(0,ke.useEffect)((()=>{n()}),[n]),null},jr=(0,ke.memo)(Pr),Ar=e=>{let{extra:t={requireAuth:!0},platform:r}=e;const n=[f.X8.PWA,f.X8.PWAC2C].includes(r);return(0,Te.jsxs)(Te.Fragment,{children:[n&&(0,Te.jsx)(jr,{}),!n&&(0,Te.jsx)(Cr,{platform:r,extra:t})]})},Ir=(0,ke.memo)(Ar),Nr=e=>{let{disabled:t=!1,initTime:r,onClick:n}=e;const[s,o]=(0,ke.useState)(0),i=(0,ke.useRef)(),a=(0,ke.useMemo)((()=>s>0?v.oO.RESEND_OTP_LATER_LABEL.replace("{number}",s.toString()):v.oO.RESEND_OTP_BUTTON_LABEL),[s]);return(0,ke.useEffect)((()=>(s>0&&(i.current=setTimeout((()=>o(s-1)),1e3)),()=>{i.current&&clearTimeout(i.current)})),[s]),(0,ke.useEffect)((()=>{o(g.LW)}),[r]),(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.ghost,disabled:t||s>0,onClick:n,children:a})},Rr="_9fe3-kiV8N1",Mr="_9fe3-Bpfwe9",Br="_9fe3-RiQp3K",Lr=e=>{let{authFollow:r,onChangePhoneNumber:n,onGoWelcomeScreen:s,phoneNumber:o,platform:i}=e;const[a,c]=(0,ke.useState)(""),[l,u]=(0,ke.useState)(Date.now()),[d,h]=(0,ke.useState)(!1),[m,y]=(0,ke.useState)(""),_=(0,t.useDispatch)(),w=(0,t.useSelector)("PartnerAuth"),b=(0,t.useActions)($.actions),S=(0,t.useActions)(W.actions),x=(0,t.useActions)(J.actions),T=z(),k=(0,t.useActions)(ye.actions),E=(0,t.useActions)(I.actions),O=A(),P=(0,t.useActions)(U.actions),j=(0,t.useActions)(Q.actions),N=L(),R=(0,t.useActions)(C.Z.actions),M=(0,t.useActions)(Y.Z.actions),B=null===T||void 0===T?void 0:T.getIn(["value","result","data","login_token"]),q=null===O||void 0===O?void 0:O.getIn(["value","result","data","otp_token"]),D=null===N||void 0===N?void 0:N.getIn(["value","result","data","login_token"]),V=null===w||void 0===w?void 0:w.get("extraData"),{isShowCaptcha:F,onResetRecaptcha:G,recaptchaResponse:H,setIsShowCaptcha:Z}=Me(g.u$.VERIFY_OTP),X=(0,ke.useCallback)((e=>{c(e),y("")}),[]),K=(0,ke.useCallback)((()=>{X(""),Z(!0)}),[Z,X]),ee=(0,ke.useCallback)((async()=>{h(!0);try{var e,t;const h=await S.request({payload:{token:B,otp:a,source:g.QD[i],flag_cookie:!0}});var r,n,s,o,c,l,u,d,p,f,m,w;if((null===(e=h.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)y(null!==(n=null===(r=h.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl);else y(""),_("EmbedAppStorage","set",{key:"EBA_PARTNER_ACCESS_TOKEN",value:null===(s=h.value.result)||void 0===s||null===(o=s.metaData)||void 0===o?void 0:o.partner_token}),_("User","updateEmbedAppAccessToken",{token:null===(c=h.value)||void 0===c||null===(l=c.result)||void 0===l||null===(u=l.metaData)||void 0===u?void 0:u.token}),_("Modals","close",{id:g.ee.EMBED_LOGIN}),await R.request({platform:g.oq[i],accessToken:null===(d=h.value)||void 0===d||null===(p=d.result)||void 0===p||null===(f=p.metaData)||void 0===f?void 0:f.token}),await M.request(),await x.request({payload:{source:g.QD[i],provider:g.oq[i],partnerToken:null===(m=h.value.result)||void 0===m||null===(w=m.metaData)||void 0===w?void 0:w.partner_token}}),_("Auth","executeLoginCallback")}catch(e){y(v.cl)}finally{h(!1)}}),[B,a,i,R,M,T]),te=(0,ke.useCallback)((async()=>{h(!0);try{var e,t;const s=await b.request({payload:{phone:o,source:g.QD[i],"g-recaptcha-response":H,social_login_info:{auth_code:null===V||void 0===V?void 0:V.auth_code,provider:g.oq[i],extra_data:{user_id:null===V||void 0===V?void 0:V.user_id}}}});var r,n;if((null===(e=s.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)y(null!==(n=null===(r=s.value.status)||void 0===r?void 0:r.message)&&void 0!==n?n:v.cl),G();else y(""),u(Date.now()),Z(!1)}catch(e){y(v.cl),G()}finally{h(!1)}}),[o,H,V,G,Z,n]),re=(0,ke.useCallback)((async()=>{h(!0);try{var e,t;let h={};var n,s,c,l,u,d,p,m,w,b,S,T;if(h=r===f.WT.SignUpWithPhoneNumber?await k.request({payload:{phone:o,otp:a,otp_token:q,source:g.QD[i],flag_cookie:!0}}):await j.request({payload:{loginToken:D,otp:a,source:g.QD[i],flag_cookie:!0}}),(null===(e=h.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)y(null!==(s=null===(n=h.value.status)||void 0===n?void 0:n.message)&&void 0!==s?s:v.cl);else y(""),_("EmbedAppStorage","set",{key:"EBA_PARTNER_ACCESS_TOKEN",value:null===(c=h.value.result)||void 0===c||null===(l=c.metaData)||void 0===l?void 0:l.partner_token}),_("User","updateEmbedAppAccessToken",{token:null===(u=h.value)||void 0===u||null===(d=u.result)||void 0===d||null===(p=d.metaData)||void 0===p?void 0:p.token}),_("Modals","close",{id:g.ee.EMBED_LOGIN}),await R.request({platform:g.oq[i],accessToken:null===(m=h.value)||void 0===m||null===(w=m.result)||void 0===w||null===(b=w.metaData)||void 0===b?void 0:b.token}),await M.request(),await x.request({payload:{source:g.QD[i],provider:g.oq[i],partnerToken:null===(S=h.value.result)||void 0===S||null===(T=S.metaData)||void 0===T?void 0:T.partner_token}}),_("Auth","executeLoginCallback")}catch(e){y(v.cl)}finally{h(!1)}}),[o,a,i,r,H,D,q]),ne=(0,ke.useCallback)((async()=>{h(!0);try{var e,t;let l={};l=r===f.WT.SignUpWithPhoneNumber?await E.request({username:o,"g-recaptcha-response":H}):await P.request({payload:{username:o,"g-recaptcha-response":H,source:g.QD[i]}});const d=null===(e=l.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code;if(d!==g.qP){var n,s;y(null!==(s=null===(n=l.value.status)||void 0===n?void 0:n.message)&&void 0!==s?s:v.cl),d===g.Gi.WRONG_CAPTCHA&&G()}else{var a,c;const e=null!==(c=null===(a=l.value.result)||void 0===a?void 0:a.data)&&void 0!==c?c:{};y(""),1===e.receive_otp&&(u(Date.now()),Z(!1))}}catch(e){y(v.cl)}finally{h(!1)}}),[o,r,H,Z,G]),se=(0,ke.useCallback)((()=>{s()}),[s]);return(0,ke.useEffect)((()=>{a.length===g.cq&&(r===f.WT.VerifyPhone?ee():re())}),[a,r,re,ee]),(0,ke.useEffect)((()=>{H&&F&&(r===f.WT.VerifyPhone?te():ne())}),[H,F,r,ne,te]),(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsxs)(p.Grid,{container:!0,spacing:3,children:[(0,Te.jsx)(p.Grid,{item:!0,children:(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:"X\xe1c th\u1ef1c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"})}),(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,children:v.oO.SUB_TITLE.PHONE})," ",(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,weight:p.TypoWeights.bold,children:o})]})]}),(0,Te.jsxs)(p.Box,{mt:5,children:[(0,Te.jsx)(Jt,{length:g.cq,readOnly:d,autoFocus:!0,otp:a,onChangeOTP:X,status:m?p.InputStatuses.error:p.InputStatuses.primary,note:m}),(0,Te.jsx)(p.Box,{className:Br,children:F&&(0,Te.jsx)("div",{id:g.u$.VERIFY_OTP})}),(0,Te.jsx)(Nr,{disabled:d||F,initTime:l,onClick:K}),(0,Te.jsxs)(p.Box,{className:Rr,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.sub,weight:p.TypoWeights.regular,children:v.oO.WRONG_RECEIVER_OTP.PHONE_NUMBER})," ",(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.link,weight:p.TypoWeights.bold,className:Mr,onClick:se,children:v.oO.EDIT_PHONE_NUMBER})]})]})]})};var Ur=u(3719),qr=u.n(Ur),Dr=u(1911),Vr=u.n(Dr);const Fr="_9fe3-GL9TfT",Wr="_9fe3-ZJqLNe",Gr="_9fe3-Un1kue",Hr="_9fe3-Zzp_SR",zr="_9fe3-RcLTqx",$r="_9fe3-UfcB7A",Zr="_9fe3-tVVSLQ",Jr="_9fe3-IzJqNj",Xr="_9fe3-Grr6hv",Kr="_9fe3-hyXl05",Qr=e=>{let{allowChangeAccount:t=!0,inputErrorMessage:r,isShowCaptcha:n,isSubmitting:s,onChange:o,onChangeAccount:i,onClear:a,onClose:c,onSubmit:l,phoneNumber:u}=e;return(0,Te.jsxs)(p.Grid,{item:!0,container:!0,direction:"column",nowrap:!0,className:Fr,children:[(0,Te.jsxs)(p.Grid,{item:!0,className:Wr,xs:"auto",children:[(0,Te.jsx)(p.Image,{src:"https://media3.scdn.vn/img4/2023/05_31/Xr2jyDcH5PCXwdcHMgfr.png",alt:"welcome hero image",className:Gr}),(0,Te.jsx)(p.Icon,{component:Vr(),className:zr,onClick:c})]}),(0,Te.jsx)(p.Grid,{item:!0,xs:!0,children:(0,Te.jsx)(p.Box,{p:6,className:$r,children:(0,Te.jsx)(p.Grid,{container:!0,justifyContent:"space-between",direction:"column",className:Zr,children:(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle1,weight:p.TypoWeights.bold,type:p.TypoTypes.default,component:"h2",className:Jr,children:"Xin ch\xe0o,"}),(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.body2,type:p.TypoTypes.default,className:Xr,component:"h3",children:"Vui l\xf2ng x\xe1c th\u1ef1c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\u1ec3 ti\u1ebfp t\u1ee5c tr\u1ea3i nghi\u1ec7m mua s\u1eafm b\u1ea1n nh\xe9"}),(0,Te.jsx)(p.Box,{mt:6,children:(0,Te.jsx)("form",{onSubmit:l,noValidate:!0,children:(0,Te.jsxs)(p.Grid,{container:!0,spacing:6,children:[(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsx)(p.TextField,{name:"phone",type:"tel",label:"",status:r?p.InputStatuses.error:p.InputStatuses.primary,placeholder:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",readOnly:s,value:u,afterInput:!!u&&(0,Te.jsx)(p.InputAdornment,{children:(0,Te.jsx)(p.Icon,{component:qr(),className:Hr,onClick:a})}),note:r,autoFocus:!0,onChange:o}),n&&(0,Te.jsx)(p.Box,{mt:4,className:Kr,children:(0,Te.jsx)("div",{id:g.u$.WELCOME})})]}),(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.redPurple,size:p.ButtonSizes.lg,disabled:!u,loading:s,children:"Ti\u1ebfp t\u1ee5c"}),t&&(0,Te.jsx)(p.Typography,{component:p.Box,pt:3,type:p.TypoTypes.link,style:{textAlign:"center",cursor:"pointer"},onClick:i,children:"Thay \u0111\u1ed5i t\xe0i kho\u1ea3n kh\xe1c?"})]})]})})})]})})})})]})},Yr=e=>{let{authFollow:r,onChange:n,onChangeForm:s,onClose:o,phoneNumber:i,platform:a,...c}=e;const[l,u]=(0,ke.useState)(!1),[d,h]=(0,ke.useState)(""),p=(0,t.useDispatch)(),m=(0,t.useSelector)("PartnerAuth"),y=(0,t.useActions)($.actions),_=(0,t.useActions)(O.actions),w=(0,t.useActions)(I.actions),b=(0,t.useActions)(U.actions),{isShowCaptcha:S,onHideRecaptcha:x,onResetRecaptcha:T,recaptchaResponse:k,setIsShowCaptcha:E}=Me(g.u$.WELCOME),C=null===m||void 0===m?void 0:m.get("extraData"),P=(0,ke.useCallback)((e=>{n(e.currentTarget.value),h("")}),[n]),j=(0,ke.useCallback)((()=>{n(""),h("")}),[n]),A=(0,ke.useCallback)((async()=>{u(!0),x();try{var e,t;const c=await y.request({payload:{source:g.QD[a],phone:i,"g-recaptcha-response":k,social_login_info:{auth_code:null===C||void 0===C?void 0:C.auth_code,provider:g.oq[a],extra_data:{user_id:null===C||void 0===C?void 0:C.user_id}}}});var r,o;if((null===(e=c.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP)h(null!==(o=null===(r=c.value.status)||void 0===r?void 0:r.message)&&void 0!==o?o:v.cl),T();else h(""),s(f.N8.VerifyOTP),n(i)}catch(e){h(v.cl)}finally{u(!1)}}),[k,i,a,C,n,s]),N=(0,ke.useCallback)((async()=>{u(!0),x();try{var e,t;const n=await _.request({username:i});if((null===(e=n.value)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.code)!==g.qP){var r,o;h(null!==(o=null===(r=n.value.status)||void 0===r?void 0:r.message)&&void 0!==o?o:v.cl),T()}else{var c,l,d,p;h("");const e=null!==(p=null===(c=n.value.result)||void 0===c?void 0:c.data)&&void 0!==p?p:{};let t={};if(t=e.is_exist?await b.request({payload:{username:i,"g-recaptcha-response":k,source:g.QD[a]}}):await w.request({username:i,"g-recaptcha-response":k}),(null===(l=t.value)||void 0===l||null===(d=l.status)||void 0===d?void 0:d.code)!==g.qP){var m,y;h(null!==(y=null===(m=t.value.status)||void 0===m?void 0:m.message)&&void 0!==y?y:v.cl),T()}else{var S,E;h("");1===(null!==(E=null===(S=t.value.result)||void 0===S?void 0:S.data)&&void 0!==E?E:{}).receive_otp&&(e.is_exist?s(f.N8.LoginBySMS):s(f.N8.SignUp))}}}catch(e){h(v.cl)}finally{u(!1)}n(i)}),[i,a,k,n,s]),R=(0,ke.useCallback)((()=>{var e,t,r,n,s,i,a,c;const l=window.location!==window.parent.location;o(),p("AuthenticationEmbed","resetSession"),null===window||void 0===window||null===(e=window.parent)||void 0===e||null===(t=e.postMessage)||void 0===t||t.call(e,{type:"SendoExternalLogout"},"*"),null===window||void 0===window||null===(r=window.webkit)||void 0===r||null===(n=r.messageHandlers)||void 0===n||null===(s=n.JSBridge)||void 0===s||null===(i=s.postMessage)||void 0===i||i.call(s,JSON.stringify({type:"SendoExternalLogout"})),null===window||void 0===window||null===(a=window.JSBridge)||void 0===a||null===(c=a.postMessage)||void 0===c||c.call(a,JSON.stringify({type:"SendoExternalLogout"})),l||window.location.reload()}),[o]),M=(0,ke.useCallback)((async e=>{e.preventDefault(),Le(i)?E(!0):h(v.Md.PHONE_INVALID_MESSAGE)}),[i]);return(0,ke.useEffect)((()=>{k&&(r===f.WT.SignInWithSMS?N():A())}),[k,r,A,N]),(0,ke.useEffect)((()=>()=>{x()}),[x]),(0,Te.jsx)(Qr,{phoneNumber:i,isShowCaptcha:S,isSubmitting:l,inputErrorMessage:d,onChange:P,onSubmit:M,onClear:j,onChangeAccount:R,onClose:o,...c})},en="_9fe3-FiwTXS",tn="_9fe3-v8W41q",rn="_9fe3-Mgk3lo",nn="_9fe3-BE5P7r",sn="_9fe3-k_RXnF",on={[f.N8.SignUp]:f.WT.SignUpWithPhoneNumber,[f.N8.LoginBySMS]:f.WT.SignInWithSMS,[f.N8.VerifyOTP]:f.WT.VerifyPhone},an=e=>{let{onCloseAuthModal:r}=e;const[n,s]=(0,ke.useState)(""),o=(0,t.useDispatch)(),i=(0,t.useSelector)("Auth"),a=(0,V.H)(),c=i.get("steps"),l=i.get("platform"),u=null===a||void 0===a?void 0:a.getIn(["value","result","metaData","phone"]),d=null===a||void 0===a?void 0:a.getIn(["value","status","code"]),h=c[c.length-1],g=h===f.N8.Welcome,m=g,y=(0,ke.useMemo)((()=>h===f.N8.Welcome?v.bh:v.wK),[h]),_=(0,ke.useCallback)((()=>{const e=Oe()(c);o("Auth","setSteps",{value:e})}),[c]),w=(0,ke.useCallback)((e=>{o("Auth","setSteps",{value:[...c,e]})}),[c]),b=(0,ke.useCallback)((()=>{o("Auth","setSteps",{value:[f.N8.Welcome]})}),[]);return(0,ke.useEffect)((()=>{u&&!n&&s(u)}),[]),(0,Te.jsx)(p.Paper,{radius:p.PaperRadius.regular,children:(0,Te.jsx)(p.Box,{className:(0,p.classnames)(en,{[tn]:m}),children:(0,Te.jsxs)(p.Grid,{container:!0,direction:"column",nowrap:!0,className:rn,children:[!g&&(0,Te.jsxs)(p.Grid,{item:!0,xs:"auto",container:!0,justifyContent:"space-between",className:sn,children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(null===c||void 0===c?void 0:c.length)>1&&(0,Te.jsx)(p.Icon,{component:Pe(),width:"2.4rem",height:"2.4rem",className:nn,onClick:_})}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{fullWidth:!1,variant:p.ButtonVariants.ghost,size:p.ButtonSizes.sm,style:{paddingRight:0},onClick:r,children:y})})]}),g&&(0,Te.jsx)(Yr,{authFollow:d===f.vm.VNEEmailNotVerified?f.WT.SignInWithSMS:f.WT.VerifyPhone,platform:l,phoneNumber:n,onChange:s,onChangeForm:w,onClose:r}),[f.N8.VerifyOTP,f.N8.LoginBySMS,f.N8.SignUp].includes(h)&&(0,Te.jsx)(Lr,{authFollow:on[h],platform:l,phoneNumber:n,onGoWelcomeScreen:b,onChangePhoneNumber:s})]})})})};const cn=function(){return(0,Te.jsx)(e.Modal,{id:g.ee.EMBED_LOGIN,closeOutsideClick:!1,xs:12,md:5,lg:4,children:e=>{let{close:t}=e;return(0,Te.jsx)(an,{onCloseAuthModal:t})}})},ln="_9fe3-cgsVTl",un="_9fe3-SVkuWQ";const dn=function(r){let{isOpen:n,onClose:s}=r;const o=(0,t.useDispatch)(),i=(0,ke.useRef)("visible"),a=(0,e.useHybrid)(),c=(0,ke.useCallback)((()=>{ZJSBridge.callCustomAction("action.ma.menu.permission",{},(e=>{console.log(e)}))}),[]),l=(0,ke.useCallback)((async()=>{if("hidden"===i.current&&"visible"===document.visibilityState){var e,t;const r=await(null===a||void 0===a||null===(e=a.kit)||void 0===e||null===(t=e.getAccessToken)||void 0===t?void 0:t.call(e));o("PartnerAuth","start",{partnerAccessToken:r,platform:f.X8.ZMA,isIgnoreConfirmRequestPhoneNumber:!0}),s()}i.current=document.visibilityState}),[o,a,s]);return(0,ke.useEffect)((()=>(window.addEventListener("visibilitychange",l),()=>{window.removeEventListener("visibilitychange",l)})),[l]),(0,Te.jsxs)(p.BottomSheet,{isOpen:n,usePortal:!1,title:v.aC.TITLE,variant:p.BottomSheetVariants.scale,backdropVariant:p.BackdropVariant.transparent,isDestroyOnClose:!0,bodyClassName:un,footer:(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,onClick:c,children:v.aC.ACTION_BUTTON_LABEL}),onClose:s,children:[(0,Te.jsx)(p.Typography,{variant:"body1",weight:"bold",children:v.aC.DESCRIPTION}),(0,Te.jsx)(p.Image,{src:v.aC.IMAGE,alt:"guild access permission setting",className:ln,onClick:c})]})},hn="_9fe3-RE2CzP",pn="_9fe3-LlAEPZ",gn="_9fe3-vK1DWY",fn="_9fe3-tw6nQa";const vn=function(e){let{isOpen:r,onClose:n}=e;const s=(0,t.useSelector)("PartnerAuth").getIn(["uiState","confirmRequestPhoneNumber"]),o=(0,ke.useCallback)((()=>{null===s||void 0===s||s.onCancel(),n()}),[s,n]),i=(0,ke.useCallback)((()=>{null===s||void 0===s||s.onOk(),n()}),[s,n]);return(0,Te.jsxs)(p.Dialog,{isOpen:r,className:hn,usePortal:!1,backdropVariant:p.BackdropVariant.transparent,onClose:o,children:[(0,Te.jsx)(p.DialogCover,{image:v.J$.IMAGE}),(0,Te.jsx)(p.Button,{icon:Vr(),variant:p.ButtonVariants.ghost,fullWidth:!1,className:pn,onClick:o}),(0,Te.jsx)(p.DialogBody,{className:fn,children:(0,Te.jsx)(p.Typography,{variant:"body1",weight:"bold",children:v.J$.DESCRIPTION})}),(0,Te.jsx)(p.DialogFooter,{children:(0,Te.jsxs)(p.Grid,{container:!0,spacing:2,className:gn,children:[(0,Te.jsx)(p.Grid,{item:!0,xs:!0,children:(0,Te.jsx)(p.Button,{variant:p.ButtonVariants.secondary,size:p.ButtonSizes.lg,onClick:o,children:v.J$.CANCEL_BUTTON_LABEL})}),(0,Te.jsx)(p.Grid,{item:!0,xs:!0,children:(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,onClick:i,children:v.J$.OK_BUTTON_LABEL})})]})})]})};function mn(e){let{formData:t,formErrorMessage:r,onChangeFormData:n,onChangePasswordVisible:s,onSubmit:o,passwordVisible:i}=e;return(0,Te.jsxs)(p.Grid,{item:!0,container:!0,xs:!0,direction:"column",children:[(0,Te.jsxs)(p.Grid,{item:!0,xs:!0,children:[(0,Te.jsx)(p.Typography,{variant:p.TypoVariants.subtitle2,weight:p.TypoWeights.bold,type:p.TypoTypes.default,children:"T\u1ea1o m\u1eadt kh\u1ea9u m\u1edbi"}),(0,Te.jsx)(p.Box,{mt:5,children:(0,Te.jsxs)("form",{onSubmit:o,autoComplete:"off",children:[(0,Te.jsxs)(p.Grid,{container:!0,spacing:4,children:[(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsxs)(p.Typography,{component:p.Box,pb:2,type:"title-sub",variant:"body2",children:["M\u1eadt kh\u1ea9u m\u1edbi ",(0,Te.jsx)(p.Typography,{type:"error",children:"*"})]}),(0,Te.jsx)(p.TextField,{name:"password",type:i.password?"text":"password",label:"",placeholder:v.LT.PASSWORD_INVALID_MESSAGE,value:t.password,size:p.InputSizes.lg,status:r.password?p.InputStatuses.error:p.InputStatuses.primary,note:r.password,autocomplete:"off",required:!0,afterInput:(0,Te.jsx)(p.InputAdornment,{onClick:()=>s("password"),children:(0,Te.jsx)(p.Icon,{component:i.password?Ct():Et()})}),onChange:n})]}),(0,Te.jsxs)(p.Grid,{item:!0,children:[(0,Te.jsxs)(p.Typography,{component:p.Box,pb:2,type:"title-sub",variant:"body2",children:["X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u ",(0,Te.jsx)(p.Typography,{type:"error",children:"*"})]}),(0,Te.jsx)(p.TextField,{name:"confirmPassword",type:i.confirmPassword?"text":"password",label:"",placeholder:"Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u m\u1edbi",value:t.confirmPassword,size:p.InputSizes.lg,status:r.confirmPassword?p.InputStatuses.error:p.InputStatuses.primary,note:r.confirmPassword,autocomplete:"off",required:!0,maxLength:25,afterInput:(0,Te.jsx)(p.InputAdornment,{onClick:()=>s("confirmPassword"),children:(0,Te.jsx)(p.Icon,{component:i.confirmPassword?Ct():Et()})}),onChange:n})]})]}),(0,Te.jsx)("button",{hidden:!0,type:"submit"})]})})]}),(0,Te.jsx)(p.Grid,{item:!0,container:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{size:p.ButtonSizes.lg,variant:p.ButtonVariants.primary,onClick:o,children:"Ho\xe0n t\u1ea5t"})})]})}const yn=(0,ke.memo)(mn);const _n=function(e){let{onChangeFormStep:t,onUpdateForm:r}=e;const[n,s]=(0,ke.useState)({password:!1,confirmPassword:!1}),[o,i]=(0,ke.useState)({password:"",confirmPassword:""}),[a,c]=(0,ke.useState)({password:"",confirmPassword:""}),l=(0,ke.useCallback)((e=>{const t=e.currentTarget.name,r=e.currentTarget.value;i((e=>({...e,[t]:r.trim()}))),c((e=>({...e,[t]:""})))}),[]),u=(0,ke.useCallback)((()=>{const{confirmPassword:e,password:t}=o,r={password:"",confirmPassword:""};return(null===t||void 0===t?void 0:t.length)<8?r.password=v.LT.PASSWORD_INVALID_MESSAGE:t!==e&&(r.confirmPassword="X\xe1c nh\u1eadn ch\u01b0a \u0111\xfang. Th\u1eed nh\u1eadp l\u1ea1i b\u1ea1n nh\xe9."),c(r),!r.password&&!r.confirmPassword}),[o]),d=(0,ke.useCallback)((e=>{s((t=>({...t,[e]:!t[e]})))}),[]),h=(0,ke.useCallback)((async e=>{e.preventDefault(),u()&&(t(f.N8.RequestOTP),r(o))}),[o,r,u,t]);return(0,Te.jsx)(yn,{passwordVisible:n,formData:o,formErrorMessage:a,onChangeFormData:l,onChangePasswordVisible:d,onSubmit:h})},wn="_9fe3-HIznUO",bn="_9fe3-uxEclt",Sn="_9fe3-kKXqy0",xn="_9fe3-IFXcba",Tn=e=>{let{onClose:r}=e;const[n,s]=(0,ke.useState)({password:"",confirmPassword:""}),[o,i]=(0,ke.useState)(),[a,c]=(0,ke.useState)([f.N8.UpdatePassword]),l=(0,t.useSelector)("User"),u=null===l||void 0===l?void 0:l.getIn(["details","data","phone"]),d=null===l||void 0===l?void 0:l.getIn(["details","data","phone_verified"]),h=null===l||void 0===l?void 0:l.getIn(["details","data","email"]),g=a[a.length-1],m=a[a.length-2],y=g===f.N8.UpdatePassword,_=(0,ke.useMemo)((()=>y?v.bh:v.wK),[y]),w=(0,ke.useCallback)((()=>{const e=Oe()(a);c(e),1===e.length&&(i(void 0),s({password:"",confirmPassword:""}))}),[a]),b=(0,ke.useCallback)((e=>{c((t=>[...t,e]))}),[]),S=(0,ke.useCallback)((()=>{c([f.N8.UpdatePassword])}),[]);return(0,Te.jsx)(p.Paper,{radius:p.PaperRadius.regular,children:(0,Te.jsx)(p.Box,{className:wn,children:(0,Te.jsxs)(p.Grid,{container:!0,direction:"column",nowrap:!0,className:bn,children:[(0,Te.jsxs)(p.Grid,{item:!0,xs:"auto",container:!0,justifyContent:"space-between",className:xn,children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(null===a||void 0===a?void 0:a.length)>1&&(0,Te.jsx)(p.Icon,{component:Pe(),width:"2.4rem",height:"2.4rem",className:Sn,onClick:w})}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{fullWidth:!1,variant:p.ButtonVariants.ghost,size:p.ButtonSizes.sm,style:{marginRight:"-1.6rem"},onClick:r,children:_})})]}),y&&(0,Te.jsx)(_n,{onChangeFormStep:b,onUpdateForm:s}),g===f.N8.RequestOTP&&(0,Te.jsx)(vt,{authFollow:f.WT.VerifyOTPUpdatePassword,phoneNumber:u,isNewSocialUser:!1,onChangePhoneNumber:()=>{},onChangeForm:b}),g===f.N8.VerifyOTP&&(0,Te.jsx)(tr,{isNewSocialUser:!1,username:h,phoneNumber:u,reference:m,authFollow:f.WT.VerifyOTPUpdatePassword,...n,otpToken:o,onSetOTPToken:i,onChangeForm:b,onGoWelcomeScreen:S,onChangePhoneNumber:()=>{},onBack:w,isAcceptLinkSenPay:!1,isVerifiedPhone:d})]})})})};const kn=function(t){const r=(0,ke.useMemo)((()=>e.Environment.is.web?p.Box:e=>{let{children:t}=e;return(0,Te.jsx)(p.BottomSheet,{isOpen:!0,hasHeader:!1,usePortal:!1,variant:p.BottomSheetVariants.full,children:t})}),[]);return(0,Te.jsx)(r,{children:(0,Te.jsx)(Tn,{...t})})};function En(t){return(0,Te.jsx)(e.Modal,{id:g.ee.UPDATE_PASSWORD,closeOutsideClick:!0,xs:12,md:5,lg:4,zIndex:101,isolated:!e.Environment.is.web,children:e=>(0,Te.jsx)(kn,{onClose:e.close})})}const On=(0,ke.memo)(En),Cn="_9fe3-hg6_4e",Pn="_9fe3-_dLWkw",jn="_9fe3-YD3v_p",An="_9fe3-f_AN1x",In=e=>{let{onClose:r}=e;const[n,s]=(0,ke.useState)(),[o,i]=(0,ke.useState)([f.N8.RequestOTP]),a=(0,t.useSelector)("User"),c=null===a||void 0===a?void 0:a.getIn(["details","data","phone"]),l=null===a||void 0===a?void 0:a.getIn(["details","data","phone_need_verify"]),u=(0,ke.useMemo)((()=>l||c),[l,c]),[d,h]=(0,ke.useState)(u);var g;const m=null!==(g=null===a||void 0===a?void 0:a.getIn(["details","data","email_verified"]))&&void 0!==g&&g,y=o[o.length-1],_=o[o.length-2],w=y===f.N8.RequestOTP,b=(0,ke.useMemo)((()=>w?v.bh:v.wK),[w]),S=(0,ke.useCallback)((()=>{const e=Oe()(o);i(e),1===e.length&&s(void 0)}),[o]),x=(0,ke.useCallback)((e=>{i((t=>[...t,e]))}),[]),T=(0,ke.useCallback)((()=>{i([f.N8.RequestOTP])}),[]);return(0,Te.jsx)(p.Paper,{radius:p.PaperRadius.regular,children:(0,Te.jsx)(p.Box,{className:Cn,children:(0,Te.jsxs)(p.Grid,{container:!0,direction:"column",nowrap:!0,className:Pn,children:[(0,Te.jsxs)(p.Grid,{item:!0,xs:"auto",container:!0,justifyContent:"space-between",className:An,children:[(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(null===o||void 0===o?void 0:o.length)>1&&(0,Te.jsx)(p.Icon,{component:Pe(),width:"2.4rem",height:"2.4rem",className:jn,onClick:S})}),(0,Te.jsx)(p.Grid,{item:!0,xs:"auto",children:(0,Te.jsx)(p.Button,{fullWidth:!1,variant:p.ButtonVariants.ghost,size:p.ButtonSizes.sm,style:{marginRight:"-1.6rem"},onClick:r,children:b})})]}),y===f.N8.RequestOTP&&(0,Te.jsx)(vt,{authFollow:f.WT.VerifyPhone,phoneNumber:d,isNewSocialUser:!1,onChangePhoneNumber:h,onChangeForm:x}),y===f.N8.VerifyOTP&&(0,Te.jsx)(tr,{isNewSocialUser:!1,username:"",phoneNumber:d,reference:_,authFollow:f.WT.VerifyPhone,otpToken:n,onSetOTPToken:s,onChangeForm:x,onGoWelcomeScreen:T,onChangePhoneNumber:h,onBack:S,isAcceptLinkSenPay:!0,isVerifiedEmail:m})]})})})};const Nn=function(t){const r=(0,ke.useMemo)((()=>e.Environment.is.web?p.Box:e=>{let{children:t}=e;return(0,Te.jsx)(p.BottomSheet,{isOpen:!0,hasHeader:!1,usePortal:!1,variant:p.BottomSheetVariants.full,children:t})}),[]);return(0,Te.jsx)(r,{children:(0,Te.jsx)(In,{...t})})};function Rn(){return(0,Te.jsx)(e.Modal,{id:g.ee.VERIFY_PHONE,closeOutsideClick:!0,xs:12,md:5,lg:4,zIndex:100,isolated:!e.Environment.is.web,children:e=>(0,Te.jsx)(Nn,{onClose:e.close})})}const Mn=(0,ke.memo)(Rn);var Bn,Ln;const Un=null===(Bn="387062634759025")?void 0:Bn.toString(),qn=null===(Ln="v2.4")?void 0:Ln.toString();let Dn=null;const Vn=async e=>{try{if(null===Dn)return Dn=new Promise((t=>{let r=null;window.fbAsyncInit=()=>{window.FB.init({appId:Un,xfbml:!1,version:qn,cookie:!0}),clearTimeout(r),r=null,e("facebook"),t(!0)};const n=`//connect.facebook.net/en_US/sdk.js#xfbml=1&version=${qn}`;(0,se.importScriptOnce)(n,"facebook-jssdk",{defer:!0,timeout:1e4,appendTo:document.getElementsByTagName("body")[0]}).then((()=>{r=setTimeout((()=>{t(!1),Dn=null}),1e3)})).catch((e=>{t(!1),Dn=null}))})),Dn;{const e=await Dn;return e&&window.FB&&window.FB.XFBML&&window.FB.XFBML.parse(),e}}catch(e){return!1}},Fn=async e=>{await(0,se.importScriptOnce)("//accounts.google.com/gsi/client","google-gis-jssdk",{defer:!0,timeout:1e4,appendTo:document.getElementsByTagName("body")[0]}).then((()=>{var t;e("google"),window.gAuthInstance=null===(t=window.google)||void 0===t?void 0:t.accounts.oauth2.initTokenClient({client_id:"1032164993672.apps.googleusercontent.com",scope:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"].join(" "),ux_mode:"popup",callback:""})}))},Wn={slideUp:"_9fe3-DWeVMW",zoomIn:"_9fe3-JTjoHf"};function Gn(r){let{extra:n={requireAuth:!0},platform:s,variant:o=f.gJ.Modal}=r;const i=(0,t.useDispatch)(),a=(0,e.useHistory)(),c=(0,e.usePage)(),l=[f.X8.PWA,f.X8.PWAC2C].includes(s),u=[f.X8.MBB,f.X8.VNE].includes(s),d=o===f.gJ.Page,h=Mt(),g=null===h||void 0===h?void 0:h.get("logged"),v=null===h||void 0===h?void 0:h.getIn(["details","data","phone"]),m=(0,ke.useMemo)((()=>["home","integration-app-home"].includes(c.route)&&!e.Environment.is.server&&!a.isInternalApplication&&g&&v),[c.route,a.isInternalApplication,g,v]),y=(0,ke.useCallback)((async e=>{setTimeout((async function(){await Promise.all([Vn(e),Fn(e)])}),5e3)}),[]),_=(0,ke.useCallback)((e=>{i("ScriptLoaded","set",{script:e})}),[i]),w=(0,ke.useCallback)((()=>{i("Session","removeHomePopup")}),[i]);return(0,ke.useEffect)((()=>{l&&y(_)}),[l,y,_]),(0,ke.useEffect)((()=>{i("Auth","setPlatform",{value:s})}),[i,s]),(0,Te.jsxs)(p.Box,{className:Wn.root,children:[!e.Environment.is.server&&(0,Te.jsx)(Ir,{platform:s,extra:n}),m&&(0,Te.jsx)(ht,{strict:!0,callback:w}),d?(0,Te.jsx)(vr,{}):(0,Te.jsxs)(Te.Fragment,{children:[l&&(0,Te.jsxs)(Te.Fragment,{children:[(0,Te.jsx)(dr,{}),(0,Te.jsx)(Mn,{})]}),u&&(0,Te.jsx)(cn,{}),(0,Te.jsx)(On,{})]}),(0,Te.jsx)(e.Modal,{id:"RequestPermission",xs:12,children:e=>(0,Te.jsx)(dn,{isOpen:e.isOpen,onClose:e.close})}),(0,Te.jsx)(e.Modal,{id:"RequestPhoneNumber",xs:12,children:e=>(0,Te.jsx)(vn,{isOpen:e.isOpen,onClose:e.close})})]})}const Hn=(0,ke.memo)(Gn),zn=(0,e.declareModule)({details:{id:"@authentication/integration",version:"0.99.0",platform:"hybrid"},data:xe,component:Hn})})(),d})()));
//# sourceMappingURL=https://web-static.scdn.vn/authentication-integration/65be41d9-web/index.js.map